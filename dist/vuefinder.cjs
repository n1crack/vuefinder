"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),D=require("@nanostores/vue"),_t=require("mitt"),pt=require("@nanostores/persistent"),G=require("nanostores"),ht=require("vue-advanced-cropper"),Ye=require("vanilla-lazyload"),ye=require("overlayscrollbars"),gt=require("@uppy/core"),kt=require("@uppy/xhr-upload"),wt=require("@viselect/vanilla"),xe=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");class yt{config;constructor(t){this.config=Object.assign({baseUrl:"",headers:{},params:{},body:{},xsrfHeaderName:"X-CSRF-Token",fetchParams:{}},t)}customFetch=async(...t)=>{let[o,r]=t;this.config.fetchRequestInterceptor&&(r=this.config.fetchRequestInterceptor(r));let l=await fetch(o,r);return this.config.fetchResponseInterceptor&&(l=await this.config.fetchResponseInterceptor(l)),l};transformRequestParams(t){const o=this.config,r={};xe!=null&&xe!==""&&o.xsrfHeaderName&&(r[o.xsrfHeaderName]=xe);const l=Object.assign({},o.headers,r,t.headers),d=Object.assign({},o.params,t.params),a=o.baseUrl+t.url,f=t.method;let s;if(f!=="get")if(t.body instanceof FormData){const i=t.body;o.body!=null&&Object.entries(this.config.body).forEach(([u,_])=>{i.append(u,String(_))}),s=i}else{const i=Object.assign({},t.body??{});o.body!=null&&Object.assign(i,this.config.body),s=i}const m={url:a,method:f,headers:l,params:d,body:s};if(o.transformRequest!=null){const i=o.transformRequest({url:a,method:f,headers:l,params:d,body:s??null});i.url!=null&&(m.url=i.url),i.method!=null&&(m.method=i.method),i.params!=null&&(m.params=i.params),i.headers!=null&&(m.headers=i.headers),i.body!=null&&(m.body=i.body)}return m}getDownloadUrl(t,o){if(o.url!=null)return o.url;const r=this.transformRequestParams({url:"",method:"get",params:{q:"download",storage:t,path:o.path}});return r.url+"?"+new URLSearchParams(r.params).toString()}getPreviewUrl(t,o){if(o.url!=null)return o.url;const r=this.transformRequestParams({url:"",method:"get",params:{q:"preview",storage:t,path:o.path}});return r.url+"?"+new URLSearchParams(r.params).toString()}async send(t){const o=this.transformRequestParams(t),r=t.responseType||"json",l={method:t.method,headers:o.headers,signal:t.abortSignal},d=o.url+"?"+new URLSearchParams(o.params);if(o.method!=="get"&&o.body!=null){let f;o.body instanceof FormData?f=t.body:(f=JSON.stringify(o.body),l.headers["Content-Type"]="application/json"),l.body=f}this.config.fetchParams&&Object.assign(l,this.config.fetchParams);const a=await this.customFetch(d,l);if(a.ok)return await a[r]();throw await a.json()}}function bt(n){const t={baseUrl:"",headers:{},params:{},body:{},xsrfHeaderName:"X-CSRF-Token",fetchParams:{}};return typeof n=="string"?Object.assign(t,{baseUrl:n}):Object.assign(t,n),new yt(t)}function Et(n){let t=localStorage.getItem(n+"_storage");const o=e.reactive(JSON.parse(t??"{}"));e.watch(o,r);function r(){Object.keys(o).length?localStorage.setItem(n+"_storage",JSON.stringify(o)):localStorage.removeItem(n+"_storage")}function l(s,m){o[s]=m}function d(s){delete o[s]}function a(){Object.keys(o).forEach(s=>d(s))}return{getStore:(s,m=null)=>s in o?o[s]:m,setStore:l,removeStore:d,clearStore:a}}async function Vt(n,t){const o=t[n];return typeof o=="function"?(await o()).default:o}function Nt(n,t,o,r){const{getStore:l,setStore:d}=n,a=e.ref({}),f=e.ref(l("locale",t)),s=(u,_=t)=>{Vt(u,r).then(p=>{a.value=p,d("locale",u),f.value=u,d("translations",p),Object.values(r).length>1&&(o.emit("vf-toast-push",{label:"The language is set to "+u}),o.emit("vf-language-saved"))}).catch(p=>{_?(o.emit("vf-toast-push",{label:"The selected locale is not yet supported!",type:"error"}),s(_,null)):(console.error(p),o.emit("vf-toast-push",{label:"Locale cannot be loaded!",type:"error"}))})};e.watch(f,u=>{s(u)}),!l("locale")&&!Object.keys(r).length?s(t):a.value=l("translations");const m=(u,..._)=>_.length?m(u=u.replace("%s",String(_.shift())),..._):u;function i(u,..._){return a.value&&Object.prototype.hasOwnProperty.call(a.value,u)?m(a.value[u]||u,..._):m(u,..._)}return e.reactive({t:i,locale:f})}const z={EDIT:"edit",NEW_FILE:"newfile",NEW_FOLDER:"newfolder",PREVIEW:"preview",ARCHIVE:"archive",UNARCHIVE:"unarchive",SEARCH:"search",RENAME:"rename",UPLOAD:"upload",DELETE:"delete",FULL_SCREEN:"fullscreen",DOWNLOAD:"download",LANGUAGE:"language",MOVE:"move",COPY:"copy"},St=Object.values(z),Bt="4.0.0-dev";function We(n,t,o,r,l){return t=Math,o=t.log,r=1024,l=o(n)/o(r)|0,(n/t.pow(r,l)).toFixed(0)+" "+(l?"KMGTPEZY"[--l]+"iB":"B")}function Xe(n,t,o,r,l){return t=Math,o=t.log,r=1e3,l=o(n)/o(r)|0,(n/t.pow(r,l)).toFixed(0)+" "+(l?"KMGTPEZY"[--l]+"B":"B")}function Ct(n){if(typeof n=="number")return n;const t={k:1,m:2,g:3,t:4},r=/(\d+(?:\.\d+)?)\s?(k|m|g|t)?b?/i.exec(n);if(!r)return 0;const l=parseFloat(r[1]||"0"),d=(r[2]||"").toLowerCase(),a=t[d]??0;return Math.round(l*Math.pow(1024,a))}const le={SYSTEM:"system",LIGHT:"light",DARK:"dark"};function xt(n,t){const o=e.ref(le.SYSTEM),r=e.ref(le.LIGHT);o.value=n.getStore("theme",t??le.SYSTEM);const l=window.matchMedia("(prefers-color-scheme: dark)"),d=a=>{o.value===le.DARK||o.value===le.SYSTEM&&a.matches?r.value=le.DARK:r.value=le.LIGHT};return d(l),l.addEventListener("change",d),{value:o,actualValue:r,set(a){o.value=a,a!==le.SYSTEM?n.setStore("theme",a):n.removeStore("theme"),d(l)}}}function $t(){const n=e.shallowRef(null),t=e.ref(!1),o=e.ref(),r=e.ref(!1);return{visible:t,type:n,data:o,open:(f,s=null)=>{document.querySelector("body").style.overflow="hidden",t.value=!0,n.value=f,o.value=s},close:()=>{document.querySelector("body").style.overflow="",t.value=!1,n.value=null},setEditMode:f=>{r.value=f},editMode:r}}const $e={view:"grid",fullScreen:!1,showTreeView:!1,showHiddenFiles:!0,compactListView:!0,metricUnits:!1,showThumbnails:!0,persist:!1,path:"",initialPath:null,loadingIndicator:"circular",maxFileSize:null,pinnedFolders:[]},Dt=(n,t={})=>{const o=`vuefinder_config_${n}`,r=pt.persistentAtom(o,{...$e,...t},{encode:JSON.stringify,decode:JSON.parse}),l=(i={})=>{const u=r.get(),_={...$e,...i,...u};r.set(_)},d=i=>r.get()[i],a=()=>r.get(),f=(i,u)=>{const _=r.get();typeof i=="object"&&i!==null?r.set({..._,...i}):r.set({..._,[i]:u})};return{state:r,init:l,get:d,set:f,toggle:i=>{const u=r.get();f(i,!u[i])},all:a,reset:()=>{r.set({...$e})}}};function Mt(n,t){if(typeof n=="string"&&typeof t=="string")return n.toLowerCase().localeCompare(t.toLowerCase());const o=Number(n)||0,r=Number(t)||0;return o===r?0:o<r?-1:1}const Tt=()=>{const n=G.atom(""),t=G.atom([]),o=G.atom(!1),r=G.atom([]),l=G.atom({active:!1,column:"",order:""}),d=G.atom({kind:"all",showHidden:!1}),a=G.atom(new Set),f=G.atom({type:"copy",path:"",items:new Set}),s=G.atom(null),m=G.atom(0),i=G.atom(!1),u=G.atom([]),_=G.atom(-1),p=G.computed([n],w=>{const B=(w||"local://").trim(),T=B.indexOf("://"),O=T>=0?B.slice(0,T):"",ve=(T>=0?B.slice(T+3):B).split("/").filter(Boolean);let ae="";const Ce=ve.map(ee=>(ae=ae?`${ae}/${ee}`:ee,{basename:ee,name:ee,path:O?`${O}://${ae}`:ae,type:"dir"}));return{storage:O,breadcrumb:Ce,path:B}}),E=G.computed([r,l,d],(w,B,T)=>{let O=w;T.kind==="files"?O=O.filter(ee=>ee.type==="file"):T.kind==="folders"&&(O=O.filter(ee=>ee.type==="dir")),T.showHidden||(O=O.filter(ee=>!ee.basename.startsWith(".")));const{active:fe,column:ve,order:ae}=B;if(!fe||!ve)return O;const Ce=ae==="asc"?1:-1;return O.slice().sort((ee,vt)=>Mt(ee[ve],vt[ve])*Ce)}),k=G.computed([r,a],(w,B)=>B.size===0?[]:w.filter(T=>B.has(T.path))),g=(w,B)=>{const T=n.get();if((B??!0)&&T!==w){const O=u.get(),fe=_.get();fe<O.length-1&&O.splice(fe+1),O.length===0&&T&&O.push(T),O.push(w),u.set([...O]),_.set(O.length-1)}n.set(w)},v=w=>{r.set(w??[])},h=w=>{t.set(w??[])},c=(w,B)=>{l.set({active:!0,column:w,order:B})},y=w=>{const B=l.get();B.active&&B.column===w?l.set({active:B.order==="asc",column:w,order:"desc"}):l.set({active:!0,column:w,order:"asc"})},N=()=>{l.set({active:!1,column:"",order:""})},$=(w,B)=>{d.set({kind:w,showHidden:B})},q=()=>{d.set({kind:"all",showHidden:!1})},H=(w,B="multiple")=>{const T=new Set(a.get());B==="single"&&T.clear(),T.add(w),a.set(T),m.set(T.size)},R=w=>{const B=new Set(a.get());B.delete(w),a.set(B),m.set(B.size)},U=w=>a.get().has(w),K=(w,B="multiple")=>{const T=new Set(a.get());T.has(w)?T.delete(w):(B==="single"&&T.clear(),T.add(w)),a.set(T),m.set(T.size)},Q=(w="multiple")=>{if(w==="single"){const B=r.get()[0];if(B){const T=B.path;a.set(new Set([T])),m.set(1)}}else{const B=new Set(r.get().map(T=>T.path));a.set(B),m.set(B.size)}},C=()=>{a.set(new Set),m.set(0)},A=w=>{const B=new Set(w??[]);a.set(B),m.set(B.size)},S=w=>{m.set(w)},V=w=>{i.set(!!w)},b=()=>i.get(),I=(w,B)=>{const T=r.get().filter(O=>B.has(O.path));f.set({type:w,path:p.get().path,items:new Set(T)})},M=w=>G.computed([f],B=>B.type==="cut"&&Array.from(B.items).some(T=>T.path===w)),F=w=>G.computed([f],B=>B.type==="copy"&&Array.from(B.items).some(T=>T.path===w)),P=w=>{const B=M(w);return D.useStore(B).value??!1},j=w=>{const B=F(w);return D.useStore(B).value??!1},Z=()=>{f.set({type:"copy",path:"",items:new Set})},te=()=>f.get(),re=w=>{s.set(w)},Se=()=>s.get(),de=()=>{s.set(null)},ge=()=>{const w=u.get(),B=_.get();if(B>0){const T=B-1,O=w[T];O&&(_.set(T),g(O,!1))}},ue=()=>{const w=u.get(),B=_.get();if(B<w.length-1){const T=B+1,O=w[T];O&&(_.set(T),g(O,!1))}},Be=G.computed([_],w=>w>0),me=G.computed([u,_],(w,B)=>B<w.length-1);return{files:r,storages:t,currentPath:n,sort:l,filter:d,selectedKeys:a,selectedCount:m,loading:i,draggedItem:s,clipboardItems:f,path:p,sortedFiles:E,selectedItems:k,setPath:g,setFiles:v,setStorages:h,setSort:c,toggleSort:y,clearSort:N,setFilter:$,clearFilter:q,select:H,deselect:R,toggleSelect:K,selectAll:Q,isSelected:U,clearSelection:C,setSelection:A,setSelectedCount:S,setLoading:V,isLoading:b,setClipboard:I,createIsCut:M,createIsCopied:F,isCut:P,isCopied:j,clearClipboard:Z,getClipboard:te,setDraggedItem:re,getDraggedItem:Se,clearDraggedItem:de,setReadOnly:w=>{o.set(w)},getReadOnly:()=>o.get(),isReadOnly:w=>o.get()?!0:w.read_only??!1,goBack:ge,goForward:ue,canGoBack:Be,canGoForward:me,navigationHistory:u,historyIndex:_}},Ue={query:"",searchMode:!1},Ft=()=>{const n=G.atom(Ue);return{state:n,setQuery:(s,m)=>{const i=s??"",u=m?i.length>0:n.get().searchMode;n.set({query:i,searchMode:u})},enterSearchMode:()=>{const s=n.get();n.set({...s,searchMode:!0})},exitSearchMode:()=>{n.set({query:"",searchMode:!1})},get:s=>n.get()[s],set:(s,m)=>{const i=n.get();typeof s=="object"&&s!==null?n.set({...i,...s}):n.set({...i,[s]:m})},all:()=>n.get(),reset:()=>{n.set({...Ue})}}},At=(n,t)=>{const o=Et(n.id),r=_t(),l=xt(o,n.theme),d=t.i18n,a=n.locale??t.locale,f=Dt(n.id,n.config??{}),s=Tt(),m=Ft(),i=u=>Array.isArray(u)?u:St;return e.reactive({version:Bt,config:f,fs:s,search:m,root:e.useTemplateRef("root"),debug:n.debug,emitter:r,storage:o,i18n:Nt(o,a,r,d),modal:$t(),requester:bt(n.request),features:i(n.features),selectionMode:n.selectionMode||"multiple",treeViewData:[],theme:l,filesize:f.get("metricUnits")?Xe:We,contextMenuItems:n.contextMenuItems})},Lt={class:"vuefinder__modal-layout__container"},It={class:"vuefinder__modal-layout__content"},Rt={class:"vuefinder__modal-layout__footer"},oe=e.defineComponent({__name:"ModalLayout",setup(n){const t=e.ref(null),o=e.inject("ServiceContainer");return e.onMounted(()=>{const r=document.querySelector(".v-f-modal input");r&&r.focus(),e.nextTick(()=>{if(document.querySelector(".v-f-modal input")&&window.innerWidth<768&&t.value){const l=t.value.getBoundingClientRect().bottom+16;window.scrollTo({top:l,left:0,behavior:"smooth"})}})}),(r,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([e.unref(o).theme.actualValue,"vuefinder vuefinder__modal-layout"]),"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",onKeyup:l[1]||(l[1]=e.withKeys(d=>e.unref(o).modal.close(),["esc"])),tabindex:"0"},[l[2]||(l[2]=e.createElementVNode("div",{class:"vuefinder__modal-layout__overlay"},null,-1)),e.createElementVNode("div",Lt,[e.createElementVNode("div",{class:"vuefinder__modal-layout__wrapper",onMousedown:l[0]||(l[0]=e.withModifiers(d=>e.unref(o).modal.close(),["self"]))},[e.createElementVNode("div",{ref_key:"modalBody",ref:t,class:"vuefinder__modal-layout__body"},[e.createElementVNode("div",It,[e.renderSlot(r.$slots,"default")]),e.createElementVNode("div",Rt,[e.renderSlot(r.$slots,"buttons")])],512)],32)])],34))}}),Pt={class:"vuefinder__modal-header"},zt={class:"vuefinder__modal-header__icon-container"},Ht={class:"vuefinder__modal-header__title",id:"modal-title"},ne=e.defineComponent({__name:"ModalHeader",props:{title:{},icon:{}},setup(n){return(t,o)=>(e.openBlock(),e.createElementBlock("div",Pt,[e.createElementVNode("div",zt,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.icon),{class:"vuefinder__modal-header__icon"}))]),e.createElementVNode("h3",Ht,e.toDisplayString(n.title),1)]))}}),Ot={props:{on:{type:String,required:!0}},setup(n,{emit:t,slots:o}){const r=e.inject("ServiceContainer"),l=e.ref(!1),{t:d}=r.i18n;let a=null;const f=()=>{clearTimeout(a),l.value=!0,a=setTimeout(()=>{l.value=!1},2e3)};return e.onMounted(()=>{r.emitter.on(n.on,f)}),e.onUnmounted(()=>{clearTimeout(a)}),{shown:l,t:d}}},qt=(n,t)=>{const o=n.__vccOpts||n;for(const[r,l]of t)o[r]=l;return o},Ut={key:1};function jt(n,t,o,r,l,d){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__action-message",{"vuefinder__action-message--hidden":!r.shown}])},[n.$slots.default?e.renderSlot(n.$slots,"default",{key:0}):(e.openBlock(),e.createElementBlock("span",Ut,e.toDisplayString(r.t("Saved.")),1))],2)}const se=qt(Ot,[["render",jt]]),Kt={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"h-6 w-6 stroke-blue-600 dark:stroke-blue-100",viewBox:"0 0 24 24"};function Gt(n,t){return e.openBlock(),e.createElementBlock("svg",Kt,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87q.11.06.22.127c.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a8 8 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a7 7 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a7 7 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a7 7 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124q.108-.066.22-.128c.332-.183.582-.495.644-.869z"},null,-1),e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0"},null,-1)])])}const Yt={render:Gt},Wt={class:"vuefinder__about-modal__content"},Xt={class:"vuefinder__about-modal__main"},Qt={class:"vuefinder__about-modal__tabs","aria-label":"Tabs"},Jt=["onClick","aria-current"],Zt={key:0,class:"vuefinder__about-modal__tab-content"},eo={class:"vuefinder__about-modal__description"},to={href:"https://vuefinder.ozdemir.be",class:"vuefinder__about-modal__link",target:"_blank"},oo={href:"https://github.com/n1crack/vuefinder",class:"vuefinder__about-modal__link",target:"_blank"},no={key:1,class:"vuefinder__about-modal__tab-content"},ro={class:"vuefinder__about-modal__description"},lo={class:"vuefinder__about-modal__settings"},ao={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},so={class:"vuefinder__about-modal__setting-input"},io=["checked"],co={class:"vuefinder__about-modal__setting-label"},uo={for:"metric_unit",class:"vuefinder__about-modal__label"},mo={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},fo={class:"vuefinder__about-modal__setting-input"},vo=["checked"],_o={class:"vuefinder__about-modal__setting-label"},po={for:"large_icons",class:"vuefinder__about-modal__label"},ho={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},go={class:"vuefinder__about-modal__setting-input"},ko=["checked"],wo={class:"vuefinder__about-modal__setting-label"},yo={for:"persist_path",class:"vuefinder__about-modal__label"},bo={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},Eo={class:"vuefinder__about-modal__setting-input"},Vo=["checked"],No={class:"vuefinder__about-modal__setting-label"},So={for:"show_thumbnails",class:"vuefinder__about-modal__label"},Bo={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},Co={class:"vuefinder__about-modal__setting-input"},xo={for:"theme",class:"vuefinder__about-modal__label"},$o={class:"vuefinder__about-modal__setting-label"},Do=["label"],Mo=["value"],To={key:0,class:"vuefinder__about-modal__setting"},Fo={class:"vuefinder__about-modal__setting-input"},Ao={for:"language",class:"vuefinder__about-modal__label"},Lo={class:"vuefinder__about-modal__setting-label"},Io=["label"],Ro=["value"],Po={key:2,class:"vuefinder__about-modal__tab-content"},zo={class:"vuefinder__about-modal__shortcuts"},Ho={class:"vuefinder__about-modal__shortcut"},Oo={class:"vuefinder__about-modal__shortcut"},qo={class:"vuefinder__about-modal__shortcut"},Uo={class:"vuefinder__about-modal__shortcut"},jo={class:"vuefinder__about-modal__shortcut"},Ko={class:"vuefinder__about-modal__shortcut"},Go={class:"vuefinder__about-modal__shortcut"},Yo={class:"vuefinder__about-modal__shortcut"},Wo={class:"vuefinder__about-modal__shortcut"},Xo={class:"vuefinder__about-modal__shortcut"},Qo={key:3,class:"vuefinder__about-modal__tab-content"},Jo={class:"vuefinder__about-modal__description"},Te=e.defineComponent({__name:"ModalAbout",setup(n){const t=e.inject("ServiceContainer"),o=t.config,{clearStore:r}=t.storage,{t:l}=t.i18n,d={ABOUT:"about",SETTINGS:"settings",SHORTCUTS:"shortcuts",RESET:"reset"},a=e.computed(()=>[{name:l("About"),key:d.ABOUT,current:!1},{name:l("Settings"),key:d.SETTINGS,current:!1},{name:l("Shortcuts"),key:d.SHORTCUTS,current:!1},{name:l("Reset"),key:d.RESET,current:!1}]),f=e.ref("about"),s=async()=>{o.reset(),r(),location.reload()},m=h=>{t.theme.set(h),t.emitter.emit("vf-theme-saved")},i=()=>{o.toggle("metricUnits"),t.filesize=o.get("metricUnits")?Xe:We,t.emitter.emit("vf-metric-units-saved")},u=()=>{o.toggle("compactListView"),t.emitter.emit("vf-compact-view-saved")},_=()=>{o.toggle("showThumbnails"),t.emitter.emit("vf-show-thumbnails-saved")},p=()=>{o.toggle("persist"),t.emitter.emit("vf-persist-path-saved")},{i18n:E}=e.inject("VueFinderOptions"),g=Object.fromEntries(Object.entries({ar:"Arabic (العربيّة)",en:"English",fr:"French (Français)",de:"German (Deutsch)",fa:"Persian (فارسی)",he:"Hebrew (עִברִית)",hi:"Hindi (हिंदी)",pl:"Polish (Polski)",ru:"Russian (Pусский)",sv:"Swedish (Svenska)",tr:"Turkish (Türkçe)",nl:"Dutch (Nederlands)",zhCN:"Simplified Chinese (简体中文)",zhTW:"Traditional Chinese (繁體中文)"}).filter(([h])=>Object.keys(E).includes(h))),v=e.computed(()=>({system:l("System"),light:l("Light"),dark:l("Dark")}));return(h,c)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:c[3]||(c[3]=y=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(l)("Close")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",Wt,[e.createVNode(ne,{icon:e.unref(Yt),title:"Vuefinder "+e.unref(t).version},null,8,["icon","title"]),e.createElementVNode("div",Xt,[e.createElementVNode("div",null,[e.createElementVNode("div",null,[e.createElementVNode("nav",Qt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,y=>(e.openBlock(),e.createElementBlock("button",{key:y.name,onClick:N=>f.value=y.key,class:e.normalizeClass([y.key===f.value?"vuefinder__about-modal__tab--active":"vuefinder__about-modal__tab--inactive","vuefinder__about-modal__tab"]),"aria-current":y.current?"page":void 0},e.toDisplayString(y.name),11,Jt))),128))])])]),f.value===d.ABOUT?(e.openBlock(),e.createElementBlock("div",Zt,[e.createElementVNode("div",eo,e.toDisplayString(e.unref(l)("Vuefinder is a simple, lightweight, and fast file manager library for Vue.js applications")),1),e.createElementVNode("a",to,e.toDisplayString(e.unref(l)("Project home")),1),e.createElementVNode("a",oo,e.toDisplayString(e.unref(l)("Follow on GitHub")),1)])):e.createCommentVNode("",!0),f.value===d.SETTINGS?(e.openBlock(),e.createElementBlock("div",no,[e.createElementVNode("div",ro,e.toDisplayString(e.unref(l)("Customize your experience with the following settings")),1),e.createElementVNode("div",lo,[e.createElementVNode("fieldset",null,[e.createElementVNode("div",ao,[e.createElementVNode("div",so,[e.createElementVNode("input",{id:"metric_unit",name:"metric_unit",type:"checkbox",checked:e.unref(o).get("metricUnits"),onChange:i,class:"vuefinder__about-modal__checkbox"},null,40,io)]),e.createElementVNode("div",co,[e.createElementVNode("label",uo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Use Metric Units"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-metric-units-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(l)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",mo,[e.createElementVNode("div",fo,[e.createElementVNode("input",{id:"large_icons",name:"large_icons",type:"checkbox",checked:e.unref(o).get("compactListView"),onChange:u,class:"vuefinder__about-modal__checkbox"},null,40,vo)]),e.createElementVNode("div",_o,[e.createElementVNode("label",po,[e.createTextVNode(e.toDisplayString(e.unref(l)("Compact list view"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-compact-view-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(l)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",ho,[e.createElementVNode("div",go,[e.createElementVNode("input",{id:"persist_path",name:"persist_path",type:"checkbox",checked:e.unref(o).get("persist"),onChange:p,class:"vuefinder__about-modal__checkbox"},null,40,ko)]),e.createElementVNode("div",wo,[e.createElementVNode("label",yo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Persist path on reload"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-persist-path-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(l)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",bo,[e.createElementVNode("div",Eo,[e.createElementVNode("input",{id:"show_thumbnails",name:"show_thumbnails",type:"checkbox",checked:e.unref(o).get("showThumbnails"),onChange:_,class:"vuefinder__about-modal__checkbox"},null,40,Vo)]),e.createElementVNode("div",No,[e.createElementVNode("label",So,[e.createTextVNode(e.toDisplayString(e.unref(l)("Show thumbnails"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-show-thumbnails-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(l)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",Bo,[e.createElementVNode("div",Co,[e.createElementVNode("label",xo,e.toDisplayString(e.unref(l)("Theme")),1)]),e.createElementVNode("div",$o,[e.withDirectives(e.createElementVNode("select",{id:"theme","onUpdate:modelValue":c[0]||(c[0]=y=>e.unref(t).theme.value=y),onChange:c[1]||(c[1]=y=>m(y.target?.value||"")),class:"vuefinder__about-modal__select"},[e.createElementVNode("optgroup",{label:e.unref(l)("Theme")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,(y,N)=>(e.openBlock(),e.createElementBlock("option",{value:N},e.toDisplayString(y),9,Mo))),256))],8,Do)],544),[[e.vModelSelect,e.unref(t).theme.value]]),e.createVNode(se,{class:"ms-3",on:"vf-theme-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(l)("Saved.")),1)]),_:1})])]),e.unref(t).features.includes(e.unref(z).LANGUAGE)&&Object.keys(e.unref(g)).length>1?(e.openBlock(),e.createElementBlock("div",To,[e.createElementVNode("div",Fo,[e.createElementVNode("label",Ao,e.toDisplayString(e.unref(l)("Language")),1)]),e.createElementVNode("div",Lo,[e.withDirectives(e.createElementVNode("select",{id:"language","onUpdate:modelValue":c[2]||(c[2]=y=>e.unref(t).i18n.locale=y),class:"vuefinder__about-modal__select"},[e.createElementVNode("optgroup",{label:e.unref(l)("Language")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(g),(y,N)=>(e.openBlock(),e.createElementBlock("option",{value:N},e.toDisplayString(y),9,Ro))),256))],8,Io)],512),[[e.vModelSelect,e.unref(t).i18n.locale]]),e.createVNode(se,{class:"ms-3",on:"vf-language-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(l)("Saved.")),1)]),_:1})])])):e.createCommentVNode("",!0)])])])):e.createCommentVNode("",!0),f.value===d.SHORTCUTS?(e.openBlock(),e.createElementBlock("div",Po,[e.createElementVNode("div",zo,[e.createElementVNode("div",Ho,[e.createElementVNode("div",null,e.toDisplayString(e.unref(l)("Rename")),1),c[4]||(c[4]=e.createElementVNode("kbd",null,"F2",-1))]),e.createElementVNode("div",Oo,[e.createElementVNode("div",null,e.toDisplayString(e.unref(l)("Refresh")),1),c[5]||(c[5]=e.createElementVNode("kbd",null,"F5",-1))]),e.createElementVNode("div",qo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Delete"))+" ",1),c[6]||(c[6]=e.createElementVNode("kbd",null,"Del",-1))]),e.createElementVNode("div",Uo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Escape"))+" ",1),c[7]||(c[7]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Esc")],-1))]),e.createElementVNode("div",jo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Select All"))+" ",1),c[8]||(c[8]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"A")],-1))]),e.createElementVNode("div",Ko,[e.createTextVNode(e.toDisplayString(e.unref(l)("Search"))+" ",1),c[9]||(c[9]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"F")],-1))]),e.createElementVNode("div",Go,[e.createTextVNode(e.toDisplayString(e.unref(l)("Toggle Sidebar"))+" ",1),c[10]||(c[10]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"E")],-1))]),e.createElementVNode("div",Yo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Open Settings"))+" ",1),c[11]||(c[11]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,",")],-1))]),e.createElementVNode("div",Wo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Toggle Full Screen"))+" ",1),c[12]||(c[12]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"Enter")],-1))]),e.createElementVNode("div",Xo,[e.createTextVNode(e.toDisplayString(e.unref(l)("Preview"))+" ",1),c[13]||(c[13]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Space")],-1))])])])):e.createCommentVNode("",!0),f.value===d.RESET?(e.openBlock(),e.createElementBlock("div",Qo,[e.createElementVNode("div",Jo,e.toDisplayString(e.unref(l)("Reset all settings to default")),1),e.createElementVNode("button",{onClick:s,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(l)("Reset Settings")),1)])):e.createCommentVNode("",!0)])])]),_:1}))}}),Zo={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function en(n,t){return e.openBlock(),e.createElementBlock("svg",Zo,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21q.512.078 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48 48 0 0 0-3.478-.397m-12 .562q.51-.089 1.022-.165m0 0a48 48 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a52 52 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a49 49 0 0 0-7.5 0"},null,-1)])])}const Qe={render:en},tn={class:"vuefinder__delete-modal__content"},on={class:"vuefinder__delete-modal__form"},nn={class:"vuefinder__delete-modal__description"},rn={class:"vuefinder__delete-modal__files vf-scrollbar"},ln={class:"vuefinder__delete-modal__file"},an={key:0,class:"vuefinder__delete-modal__icon vuefinder__delete-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},sn={key:1,class:"vuefinder__delete-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},cn={class:"vuefinder__delete-modal__file-name"},dn={class:"vuefinder__delete-modal__warning"},be=e.defineComponent({__name:"ModalDelete",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=e.ref(t.modal.data.items),a=e.ref(""),f=()=>{d.value.length&&t.emitter.emit("vf-fetch",{params:{q:"delete",m:"post",storage:l.value.storage,path:l.value.path},body:{items:d.value.map(({path:s,type:m})=>({path:s,type:m}))},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("Files deleted.")}),t.emitter.emit("vf-delete-complete",d.value)},onError:s=>{a.value=o(s.message)}})};return(s,m)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:f,class:"vf-btn vf-btn-danger"},e.toDisplayString(e.unref(o)("Yes, Delete!")),1),e.createElementVNode("button",{type:"button",onClick:m[1]||(m[1]=i=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1),e.createElementVNode("div",dn,e.toDisplayString(e.unref(o)("This action cannot be undone.")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(Qe),title:e.unref(o)("Delete files")},null,8,["icon","title"]),e.createElementVNode("div",tn,[e.createElementVNode("div",on,[e.createElementVNode("p",nn,e.toDisplayString(e.unref(o)("Are you sure you want to delete these files?")),1),e.createElementVNode("div",rn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,i=>(e.openBlock(),e.createElementBlock("p",ln,[i.type==="dir"?(e.openBlock(),e.createElementBlock("svg",an,[...m[2]||(m[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",sn,[...m[3]||(m[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",cn,e.toDisplayString(i.basename),1)]))),256))]),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:m[0]||(m[0]=i=>a.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),un={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function mn(n,t){return e.openBlock(),e.createElementBlock("svg",un,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"},null,-1)])])}const Je={render:mn},fn={class:"vuefinder__rename-modal__content"},vn={class:"vuefinder__rename-modal__item"},_n={class:"vuefinder__rename-modal__item-info"},pn={key:0,class:"vuefinder__rename-modal__icon vuefinder__rename-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},hn={key:1,class:"vuefinder__rename-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},gn={class:"vuefinder__rename-modal__item-name"},Ee=e.defineComponent({__name:"ModalRename",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=e.ref(t.modal.data.items[0]),a=e.ref(t.modal.data.items[0].basename),f=e.ref(""),s=()=>{a.value!=""&&t.emitter.emit("vf-fetch",{params:{q:"rename",m:"post",storage:l.value.storage,path:l.value.path},body:{item:d.value.path,name:a.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("%s is renamed.",a.value)})},onError:m=>{f.value=o(m.message)}})};return(m,i)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:s,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Rename")),1),e.createElementVNode("button",{type:"button",onClick:i[2]||(i[2]=u=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(Je),title:e.unref(o)("Rename")},null,8,["icon","title"]),e.createElementVNode("div",fn,[e.createElementVNode("div",vn,[e.createElementVNode("p",_n,[d.value.type==="dir"?(e.openBlock(),e.createElementBlock("svg",pn,[...i[3]||(i[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",hn,[...i[4]||(i[4]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",gn,e.toDisplayString(d.value.basename),1)]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[0]||(i[0]=u=>a.value=u),onKeyup:e.withKeys(s,["enter"]),class:"vuefinder__rename-modal__input",placeholder:"Name",type:"text"},null,544),[[e.vModelText,a.value]]),f.value.length?(e.openBlock(),e.createBlock(e.unref(f),{key:0,onHidden:i[1]||(i[1]=u=>f.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(f.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),kn=["title"],Ze=e.defineComponent({__name:"Message",props:{error:{type:Boolean}},emits:["hidden"],setup(n,{emit:t}){const o=t,r=e.inject("ServiceContainer"),{t:l}=r.i18n,d=e.ref(!1),a=e.ref(null),f=e.ref(a.value?.innerHTML);e.watch(f,()=>d.value=!1);const s=()=>{o("hidden"),d.value=!0};return(m,i)=>(e.openBlock(),e.createElementBlock("div",null,[d.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"strMessage",ref:a,class:e.normalizeClass(["vuefinder__message",n.error?"vuefinder__message--error":"vuefinder__message--success"])},[e.renderSlot(m.$slots,"default"),e.createElementVNode("div",{class:"vuefinder__message__close",onClick:s,title:e.unref(l)("Close")},[...i[0]||(i[0]=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"vuefinder__message__icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,kn)],2))]))}}),wn={class:"vuefinder__text-preview"},yn={class:"vuefinder__text-preview__header"},bn=["title"],En={class:"vuefinder__text-preview__actions"},Vn={key:0,class:"vuefinder__text-preview__content"},Nn={key:1},Sn=e.defineComponent({__name:"Text",emits:["success"],setup(n,{emit:t}){const o=t,r=e.ref(""),l=e.ref(""),d=e.ref(null),a=e.ref(!1),f=e.ref(""),s=e.ref(!1),m=e.inject("ServiceContainer"),{t:i}=m.i18n;e.onMounted(()=>{m.requester.send({url:"",method:"get",params:{q:"preview",storage:m.modal.data.storage,path:m.modal.data.item.path},responseType:"text"}).then(p=>{r.value=p,o("success")})});const u=()=>{a.value=!a.value,l.value=r.value,m.modal.setEditMode(a.value)},_=()=>{f.value="",s.value=!1,m.requester.send({url:"",method:"post",params:{q:"save",storage:m.modal.data.storage,path:m.modal.data.item.path},body:{content:l.value},responseType:"text"}).then(p=>{f.value=i("Updated."),r.value=p,o("success"),a.value=!a.value}).catch(p=>{f.value=i(p.message),s.value=!0})};return(p,E)=>(e.openBlock(),e.createElementBlock("div",wn,[e.createElementVNode("div",yn,[e.createElementVNode("div",{class:"vuefinder__text-preview__title",id:"modal-title",title:e.unref(m).modal.data.item.path},e.toDisplayString(e.unref(m).modal.data.item.basename),9,bn),e.createElementVNode("div",En,[a.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:_,class:"vuefinder__text-preview__save-button"},e.toDisplayString(e.unref(i)("Save")),1)):e.createCommentVNode("",!0),e.unref(m).features.includes(e.unref(z).EDIT)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"vuefinder__text-preview__edit-button",onClick:E[0]||(E[0]=k=>u())},e.toDisplayString(a.value?e.unref(i)("Cancel"):e.unref(i)("Edit")),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",null,[a.value?(e.openBlock(),e.createElementBlock("div",Nn,[e.withDirectives(e.createElementVNode("textarea",{ref_key:"editInput",ref:d,"onUpdate:modelValue":E[1]||(E[1]=k=>l.value=k),class:"vuefinder__text-preview__textarea",name:"text",cols:"30",rows:"10"},null,512),[[e.vModelText,l.value]])])):(e.openBlock(),e.createElementBlock("pre",Vn,e.toDisplayString(r.value),1)),f.value.length?(e.openBlock(),e.createBlock(Ze,{key:2,onHidden:E[2]||(E[2]=k=>f.value=""),error:s.value},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(f.value),1)]),_:1},8,["error"])):e.createCommentVNode("",!0)])]))}}),Bn={class:"vuefinder__image-preview"},Cn={class:"vuefinder__image-preview__header"},xn=["title"],$n={class:"vuefinder__image-preview__actions"},Dn={class:"vuefinder__image-preview__image-container"},Mn=["src"],Tn=e.defineComponent({name:"ImagePreview",__name:"Image",emits:["success"],setup(n,{emit:t}){const o=t,r=e.inject("ServiceContainer"),{t:l}=r.i18n,d=e.ref(!1),a=e.ref(""),f=e.ref(!1),s=e.ref(r.requester.getPreviewUrl(r.modal.data.storage,r.modal.data.item)),m=e.ref(s.value),i=e.useTemplateRef("cropperRef"),u=async()=>{d.value=!d.value,r.modal.setEditMode(d.value)},_=async()=>{const E=i.value?.getResult({size:{width:795,height:341},fillColor:"#ffffff"})?.canvas;E&&E.toBlob(k=>{if(!k)return;a.value="",f.value=!1;const g=new FormData;g.set("file",k),r.requester.send({url:"",method:"post",params:{q:"upload",storage:r.modal.data.storage,path:r.modal.data.item.path},body:g}).then(()=>{a.value=l("Updated."),fetch(s.value,{cache:"reload",mode:"no-cors"});const v=r.root.querySelector('[data-src="'+s.value+'"]');v&&Ye.resetStatus(v),r.emitter.emit("vf-refresh-thumbnails"),u(),o("success")}).catch(v=>{const h=v?.message??"Error";a.value=l(h),f.value=!0})})};return e.onMounted(()=>{o("success")}),(p,E)=>(e.openBlock(),e.createElementBlock("div",Bn,[e.createElementVNode("div",Cn,[e.createElementVNode("h3",{class:"vuefinder__image-preview__title",id:"modal-title",title:e.unref(r).modal.data.item.path},e.toDisplayString(e.unref(r).modal.data.item.basename),9,xn),e.createElementVNode("div",$n,[d.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:_,class:"vuefinder__image-preview__crop-button"},e.toDisplayString(e.unref(l)("Crop")),1)):e.createCommentVNode("",!0),e.unref(r).features.includes(e.unref(z).EDIT)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"vuefinder__image-preview__edit-button",onClick:E[0]||(E[0]=k=>u())},e.toDisplayString(d.value?e.unref(l)("Cancel"):e.unref(l)("Edit")),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",Dn,[d.value?(e.openBlock(),e.createBlock(e.unref(ht.Cropper),{key:1,ref_key:"cropperRef",ref:i,class:"w-full h-full",crossorigin:"anonymous",src:m.value,"auto-zoom":!0,priority:"image",transitions:!0},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:0,style:{},src:e.unref(r).requester.getPreviewUrl(e.unref(r).modal.data.storage,e.unref(r).modal.data.item),class:"vuefinder__image-preview__image w-full h-full"},null,8,Mn))]),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:E[1]||(E[1]=k=>a.value=""),error:f.value},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1},8,["error"])):e.createCommentVNode("",!0)]))}}),Fn={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function An(n,t){return e.openBlock(),e.createElementBlock("svg",Fn,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 0 0 2-2V9.414a1 1 0 0 0-.293-.707l-5.414-5.414A1 1 0 0 0 12.586 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"},null,-1)])])}const et={render:An},Ln={class:"vuefinder__default-preview"},In={class:"vuefinder__default-preview__content"},Rn={class:"vuefinder__default-preview__header"},Pn=["title"],zn={class:"vuefinder__default-preview__icon-container"},Hn=["title"],On=e.defineComponent({__name:"Default",emits:["success"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),r=t;return e.onMounted(()=>{r("success")}),(l,d)=>(e.openBlock(),e.createElementBlock("div",Ln,[e.createElementVNode("div",In,[e.createElementVNode("div",Rn,[e.createElementVNode("h3",{class:"vuefinder__default-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,Pn)]),e.createElementVNode("div",zn,[e.createVNode(e.unref(et),{class:"vuefinder__default-preview__file-icon"}),e.createElementVNode("div",{class:"vuefinder__default-preview__file-name",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,Hn)])])]))}}),qn={class:"vuefinder__video-preview"},Un=["title"],jn={class:"vuefinder__video-preview__video",preload:"metadata",controls:""},Kn=["src"],Gn=e.defineComponent({__name:"Video",emits:["success"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),r=t,l=()=>o.requester.getPreviewUrl(o.modal.data.storage,o.modal.data.item);return e.onMounted(()=>{r("success")}),(d,a)=>(e.openBlock(),e.createElementBlock("div",qn,[e.createElementVNode("h3",{class:"vuefinder__video-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,Un),e.createElementVNode("div",null,[e.createElementVNode("video",jn,[e.createElementVNode("source",{src:l(),type:"video/mp4"},null,8,Kn),a[0]||(a[0]=e.createTextVNode(" Your browser does not support the video tag. ",-1))])])]))}}),Yn={class:"vuefinder__audio-preview"},Wn=["title"],Xn={class:"vuefinder__audio-preview__audio",controls:""},Qn=["src"],Jn=e.defineComponent({__name:"Audio",emits:["success"],setup(n,{emit:t}){const o=t,r=e.inject("ServiceContainer"),l=()=>r.requester.getPreviewUrl(r.modal.data.storage,r.modal.data.item);return e.onMounted(()=>{o("success")}),(d,a)=>(e.openBlock(),e.createElementBlock("div",Yn,[e.createElementVNode("h3",{class:"vuefinder__audio-preview__title",id:"modal-title",title:e.unref(r).modal.data.item.path},e.toDisplayString(e.unref(r).modal.data.item.basename),9,Wn),e.createElementVNode("div",null,[e.createElementVNode("audio",Xn,[e.createElementVNode("source",{src:l(),type:"audio/mpeg"},null,8,Qn),a[0]||(a[0]=e.createTextVNode(" Your browser does not support the audio element. ",-1))])])]))}}),Zn={class:"vuefinder__pdf-preview"},er=["title"],tr=["data"],or=["src"],nr=e.defineComponent({__name:"Pdf",emits:["success"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),r=t,l=()=>o.requester.getPreviewUrl(o.modal.data.storage,o.modal.data.item);return e.onMounted(()=>{r("success")}),(d,a)=>(e.openBlock(),e.createElementBlock("div",Zn,[e.createElementVNode("h3",{class:"vuefinder__pdf-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,er),e.createElementVNode("div",null,[e.createElementVNode("object",{class:"vuefinder__pdf-preview__object",data:l(),type:"application/pdf",width:"100%",height:"100%"},[e.createElementVNode("iframe",{class:"vuefinder__pdf-preview__iframe",src:l(),width:"100%",height:"100%"}," Your browser does not support PDFs ",8,or)],8,tr)])]))}});function rr(n,t=null){return new Date(n*1e3).toLocaleString(t??navigator.language??"en-US")}const lr={key:0,class:"vuefinder__preview-modal__nav-overlay"},ar=["disabled","title"],sr=["disabled","title"],ir={class:"vuefinder__preview-modal__content"},cr={key:0},dr={class:"vuefinder__preview-modal__loading"},ur={key:0,class:"vuefinder__preview-modal__loading-indicator"},mr={class:"vuefinder__preview-modal__details"},fr={class:"font-bold"},vr={class:"font-bold pl-2"},_r={key:0,class:"vuefinder__preview-modal__note"},pr=["download","href"],Fe=e.defineComponent({__name:"ModalPreview",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=e.ref(!1),l=k=>(t.modal.data.item.mime_type??"").startsWith(k),d=t.features.includes(z.PREVIEW);d||(r.value=!0);const a=e.computed(()=>t.modal.data.item),f=D.useStore(t.fs.sortedFiles),s=e.computed(()=>f.value.filter(k=>k.type==="file")),m=e.computed(()=>s.value.findIndex(k=>k.path===a.value.path)),i=e.computed(()=>m.value>0),u=e.computed(()=>m.value<s.value.length-1),_=()=>{if(t.modal.editMode.value||!i.value)return;const k=s.value[m.value-1];t.fs.clearSelection(),t.fs.select(k.path),t.modal.data.item=k,t.modal.data.storage=t.modal.data.storage},p=()=>{if(t.modal.editMode.value||!u.value)return;const k=s.value[m.value+1];t.fs.clearSelection(),t.fs.select(k.path),t.modal.data.item=k,t.modal.data.storage=t.modal.data.storage},E=k=>{if(k.key==="Escape"){k.preventDefault(),k.stopPropagation(),t.modal.close();return}(k.key==="ArrowLeft"||k.key==="ArrowRight")&&(k.preventDefault(),k.stopPropagation(),k.key==="ArrowLeft"?_():p())};return e.onMounted(()=>{const k=document.querySelector(".vuefinder__preview-modal");k&&k.focus()}),(k,g)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:g[6]||(g[6]=v=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Close")),1),e.unref(t).features.includes(e.unref(z).DOWNLOAD)?(e.openBlock(),e.createElementBlock("a",{key:0,target:"_blank",class:"vf-btn vf-btn-primary",download:e.unref(t).requester.getDownloadUrl(e.unref(t).modal.data.storage,e.unref(t).modal.data.item),href:e.unref(t).requester.getDownloadUrl(e.unref(t).modal.data.storage,e.unref(t).modal.data.item)},e.toDisplayString(e.unref(o)("Download")),9,pr)):e.createCommentVNode("",!0)]),default:e.withCtx(()=>[e.createElementVNode("div",{class:"vuefinder__preview-modal",onKeydown:E,tabindex:"0"},[e.unref(t).modal.editMode?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",lr,[e.createElementVNode("button",{onClick:_,disabled:!i.value,class:"vuefinder__preview-modal__nav-side vuefinder__preview-modal__nav-side--left",title:e.unref(o)("Previous file")},[...g[7]||(g[7]=[e.createElementVNode("svg",{class:"vuefinder__preview-modal__nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e.createElementVNode("polyline",{points:"15,18 9,12 15,6"})],-1)])],8,ar),e.createElementVNode("button",{onClick:p,disabled:!u.value,class:"vuefinder__preview-modal__nav-side vuefinder__preview-modal__nav-side--right",title:e.unref(o)("Next file")},[...g[8]||(g[8]=[e.createElementVNode("svg",{class:"vuefinder__preview-modal__nav-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e.createElementVNode("polyline",{points:"9,18 15,12 9,6"})],-1)])],8,sr)])),e.createElementVNode("div",ir,[e.unref(d)?(e.openBlock(),e.createElementBlock("div",cr,[l("text")?(e.openBlock(),e.createBlock(Sn,{key:0,onSuccess:g[0]||(g[0]=v=>r.value=!0)})):l("image")?(e.openBlock(),e.createBlock(Tn,{key:1,onSuccess:g[1]||(g[1]=v=>r.value=!0)})):l("video")?(e.openBlock(),e.createBlock(Gn,{key:2,onSuccess:g[2]||(g[2]=v=>r.value=!0)})):l("audio")?(e.openBlock(),e.createBlock(Jn,{key:3,onSuccess:g[3]||(g[3]=v=>r.value=!0)})):l("application/pdf")?(e.openBlock(),e.createBlock(nr,{key:4,onSuccess:g[4]||(g[4]=v=>r.value=!0)})):(e.openBlock(),e.createBlock(On,{key:5,onSuccess:g[5]||(g[5]=v=>r.value=!0)}))])):e.createCommentVNode("",!0),e.createElementVNode("div",dr,[r.value===!1?(e.openBlock(),e.createElementBlock("div",ur,[g[9]||(g[9]=e.createElementVNode("svg",{class:"vuefinder__preview-modal__spinner",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e.createElementVNode("circle",{class:"vuefinder__preview-modal__spinner-circle",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e.createElementVNode("path",{class:"vuefinder__preview-modal__spinner-path",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(e.unref(o)("Loading")),1)])):e.createCommentVNode("",!0)])])],32),e.createElementVNode("div",mr,[e.createElementVNode("div",null,[e.createElementVNode("span",fr,e.toDisplayString(e.unref(o)("File Size"))+": ",1),e.createTextVNode(e.toDisplayString(e.unref(t).filesize(e.unref(t).modal.data.item.file_size)),1)]),e.createElementVNode("div",null,[e.createElementVNode("span",vr,e.toDisplayString(e.unref(o)("Last Modified"))+": ",1),e.createTextVNode(" "+e.toDisplayString(e.unref(rr)(e.unref(t).modal.data.item.last_modified)),1)])]),e.unref(t).features.includes(e.unref(z).DOWNLOAD)?(e.openBlock(),e.createElementBlock("div",_r,[e.createElementVNode("span",null,e.toDisplayString(e.unref(o)(`Download doesn't work? You can try right-click "Download" button, select "Save link as...".`)),1)])):e.createCommentVNode("",!0)]),_:1}))}}),hr={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true",class:"h-6 w-6 stroke-blue-600 dark:stroke-blue-100",viewBox:"0 0 24 24"};function gr(n,t){return e.openBlock(),e.createElementBlock("svg",hr,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3"},null,-1)])])}const kr={render:gr},wr={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function yr(n,t){return e.openBlock(),e.createElementBlock("svg",wr,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-6l-2-2H5a2 2 0 0 0-2 2"},null,-1)])])}const ce={render:yr},br={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"};function Er(n,t){return e.openBlock(),e.createElementBlock("svg",br,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M12 5v14M5 12h14"},null,-1)])])}const Ve={render:Er},Vr={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"};function Nr(n,t){return e.openBlock(),e.createElementBlock("svg",Vr,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M5 12h14"},null,-1)])])}const Ne={render:Nr},Sr={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-5 w-5",viewBox:"0 0 24 24"};function Br(n,t){return e.openBlock(),e.createElementBlock("svg",Sr,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"m15 4.5-4 4L7 10l-1.5 1.5 7 7L14 17l1.5-4 4-4M9 15l-4.5 4.5M14.5 4 20 9.5"},null,-1)])])}const Ae={render:Br},Cr={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function xr(n,t){return e.openBlock(),e.createElementBlock("svg",Cr,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"},null,-1)])])}const Le={render:xr},$r={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"text-neutral-500 fill-sky-500 stroke-gray-100/50 dark:stroke-slate-700/50 dark:fill-slate-500",viewBox:"0 0 24 24"};function Dr(n,t){return e.openBlock(),e.createElementBlock("svg",$r,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776q.168-.026.344-.026h15.812q.176 0 .344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"},null,-1)])])}const Ie={render:Dr},Mr={class:"vuefinder__modal-tree__folder-item"},Tr={class:"vuefinder__modal-tree__folder-content"},Fr={key:1,class:"vuefinder__modal-tree__folder-spacer"},Ar={class:"vuefinder__modal-tree__folder-text"},Lr={key:0,class:"vuefinder__modal-tree__subfolders"},Ir=e.defineComponent({__name:"ModalTreeFolderItem",props:{folder:{},storage:{},modelValue:{},expandedFolders:{},modalTreeData:{}},emits:["update:modelValue","selectAndClose","toggleFolder"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),{t:r}=o.i18n,l=o.fs,d=n,a=t;D.useStore(l.path);const f=e.computed(()=>{const E=`${d.storage}:${d.folder.path}`;return d.expandedFolders[E]||!1}),s=e.computed(()=>d.modelValue?.path===d.folder.path),m=e.computed(()=>d.modalTreeData[d.folder.path]||[]),i=e.computed(()=>m.value.length>0||d.folder.type==="dir"),u=()=>{a("toggleFolder",d.storage,d.folder.path)},_=()=>{a("update:modelValue",d.folder)},p=()=>{a("update:modelValue",d.folder),a("selectAndClose",d.folder)};return(E,k)=>{const g=e.resolveComponent("ModalTreeFolderItem",!0);return e.openBlock(),e.createElementBlock("div",Mr,[e.createElementVNode("div",Tr,[i.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:"vuefinder__modal-tree__folder-toggle",onClick:u},[f.value?(e.openBlock(),e.createBlock(e.unref(Ne),{key:1,class:"vuefinder__modal-tree__folder-toggle-icon"})):(e.openBlock(),e.createBlock(e.unref(Ve),{key:0,class:"vuefinder__modal-tree__folder-toggle-icon"}))])):(e.openBlock(),e.createElementBlock("div",Fr)),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__modal-tree__folder-link",{"vuefinder__modal-tree__folder-link--selected":s.value}]),onClick:_,onDblclick:p},[f.value?(e.openBlock(),e.createBlock(e.unref(Ie),{key:1,class:"vuefinder__modal-tree__folder-icon"})):(e.openBlock(),e.createBlock(e.unref(ce),{key:0,class:"vuefinder__modal-tree__folder-icon vuefinder__item-icon__folder"})),e.createElementVNode("span",Ar,e.toDisplayString(n.folder.basename),1)],34)]),f.value&&i.value?(e.openBlock(),e.createElementBlock("div",Lr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value,v=>(e.openBlock(),e.createBlock(g,{key:v.path,folder:v,storage:n.storage,modelValue:n.modelValue,expandedFolders:n.expandedFolders,modalTreeData:n.modalTreeData,"onUpdate:modelValue":k[0]||(k[0]=h=>E.$emit("update:modelValue",h)),onSelectAndClose:k[1]||(k[1]=h=>E.$emit("selectAndClose",h)),onToggleFolder:k[2]||(k[2]=(h,c)=>E.$emit("toggleFolder",h,c))},null,8,["folder","storage","modelValue","expandedFolders","modalTreeData"]))),128))])):e.createCommentVNode("",!0)])}}}),Rr={class:"vuefinder__modal-tree"},Pr={class:"vuefinder__modal-tree__header"},zr={class:"vuefinder__modal-tree__title"},Hr={key:0,class:"vuefinder__modal-tree__section"},Or={class:"vuefinder__modal-tree__section-title"},qr={class:"vuefinder__modal-tree__list"},Ur=["onClick","onDblclick"],jr={class:"vuefinder__modal-tree__text"},Kr={class:"vuefinder__modal-tree__text-storage"},Gr={class:"vuefinder__modal-tree__section-title"},Yr={class:"vuefinder__modal-tree__list"},Wr={class:"vuefinder__modal-tree__storage-item"},Xr={class:"vuefinder__modal-tree__storage-content"},Qr=["onClick"],Jr=["onClick","onDblclick"],Zr={class:"vuefinder__modal-tree__storage-text"},el={key:0,class:"vuefinder__modal-tree__subfolders"},tt=e.defineComponent({__name:"ModalTreeSelector",props:{modelValue:{},showPinnedFolders:{type:Boolean}},emits:["update:modelValue","selectAndClose"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),{t:r}=o.i18n,l=o.fs,d=o.config,a=t,f=D.useStore(l.sortedFiles),s=D.useStore(l.storages),m=D.useStore(l.path),i=e.ref(null),u=e.ref({}),_=e.ref({});e.watch(f,c=>{const y=c.filter($=>$.type==="dir"),N=m.value?.path||"";N&&(_.value[N]=y.map($=>({...$,type:"dir"})))});const p=(c,y)=>{const N=`${c}:${y}`;u.value={...u.value,[N]:!u.value[N]},u.value[N]&&!_.value[y]&&o.emitter.emit("vf-fetch",{params:{q:"index",storage:c,path:y},dontChangePath:!0,onSuccess:$=>{if($.files){const q=$.files.filter(H=>H.type==="dir");_.value[y]=q.map(H=>({...H,type:"dir"}))}}})},E=c=>_.value[c]||[],k=c=>{a("update:modelValue",c)},g=c=>{a("update:modelValue",c),a("selectAndClose",c)},v=c=>{const y={storage:c,path:c+"://",basename:c,type:"dir",extension:"",file_size:null,last_modified:null,mime_type:null,visibility:"public",dir:c+"://"};a("update:modelValue",y)},h=c=>{const y={storage:c,path:c+"://",basename:c,type:"dir",extension:"",file_size:null,last_modified:null,mime_type:null,visibility:"public",dir:c+"://"};a("update:modelValue",y),a("selectAndClose",y)};return e.onMounted(()=>{i.value&&ye.OverlayScrollbars(i.value,{overflow:{x:"hidden"},scrollbars:{theme:"vf-scrollbars-theme"}})}),(c,y)=>(e.openBlock(),e.createElementBlock("div",Rr,[e.createElementVNode("div",Pr,[e.createElementVNode("div",zr,e.toDisplayString(e.unref(r)("Select Target Folder")),1)]),e.createElementVNode("div",{ref_key:"modalContentElement",ref:i,class:"vuefinder__modal-tree__content"},[n.showPinnedFolders&&e.unref(d).get("pinnedFolders").length?(e.openBlock(),e.createElementBlock("div",Hr,[e.createElementVNode("div",Or,e.toDisplayString(e.unref(r)("Pinned Folders")),1),e.createElementVNode("div",qr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d).get("pinnedFolders"),N=>(e.openBlock(),e.createElementBlock("div",{key:N.path,class:e.normalizeClass(["vuefinder__modal-tree__item",{"vuefinder__modal-tree__item--selected":n.modelValue?.path===N.path}]),onClick:$=>k(N),onDblclick:$=>g(N)},[e.createVNode(e.unref(ce),{class:"vuefinder__modal-tree__icon vuefinder__item-icon__folder"}),e.createElementVNode("div",jr,e.toDisplayString(N.basename),1),e.createElementVNode("div",Kr,e.toDisplayString(N.storage),1),e.createVNode(e.unref(Ae),{class:"vuefinder__modal-tree__icon vuefinder__modal-tree__icon--pin"})],42,Ur))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("div",Gr,e.toDisplayString(e.unref(r)("Storages")),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Array.isArray(e.unref(s))?e.unref(s):e.unref(s).value||[],N=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__modal-tree__section",key:N},[e.createElementVNode("div",Yr,[e.createElementVNode("div",Wr,[e.createElementVNode("div",Xr,[e.createElementVNode("div",{class:"vuefinder__modal-tree__storage-toggle",onClick:e.withModifiers($=>p(N,N+"://"),["stop"])},[u.value[`${N}:${N}://`]?(e.openBlock(),e.createBlock(e.unref(Ne),{key:1,class:"vuefinder__modal-tree__toggle-icon"})):(e.openBlock(),e.createBlock(e.unref(Ve),{key:0,class:"vuefinder__modal-tree__toggle-icon"}))],8,Qr),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__modal-tree__storage-link",{"vuefinder__modal-tree__storage-link--selected":n.modelValue?.path===N+"://"}]),onClick:$=>v(N),onDblclick:$=>h(N)},[e.createVNode(e.unref(Le),{class:"vuefinder__modal-tree__storage-icon"}),e.createElementVNode("span",Zr,e.toDisplayString(N),1)],42,Jr)]),u.value[`${N}:${N}://`]?(e.openBlock(),e.createElementBlock("div",el,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E(N+"://"),$=>(e.openBlock(),e.createBlock(Ir,{key:$.path,folder:$,storage:N,modelValue:n.modelValue,expandedFolders:u.value,modalTreeData:_.value,"onUpdate:modelValue":k,onSelectAndClose:g,onToggleFolder:p},null,8,["folder","storage","modelValue","expandedFolders","modalTreeData"]))),128))])):e.createCommentVNode("",!0)])])]))),128))],512)]))}}),tl={class:"vuefinder__move-modal__content"},ol={class:"vuefinder__move-modal__description"},nl={class:"vuefinder__move-modal__files vf-scrollbar"},rl={key:0,class:"vuefinder__move-modal__icon vuefinder__move-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},ll={key:1,class:"vuefinder__move-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},al={class:"vuefinder__move-modal__file-name"},sl={class:"vuefinder__move-modal__target-title"},il={class:"vuefinder__move-modal__target-container"},cl={class:"vuefinder__move-modal__target-path"},dl={class:"vuefinder__move-modal__target-storage"},ul={key:0,class:"vuefinder__move-modal__target-folder"},ml={class:"vuefinder__move-modal__target-badge"},fl={class:"vuefinder__move-modal__options"},vl={class:"vuefinder__move-modal__checkbox-label"},_l={class:"vuefinder__move-modal__checkbox-text"},pl={class:"vuefinder__move-modal__selected-items"},ot=e.defineComponent({__name:"ModalTransfer",props:{q:{}},setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=n,a=e.ref(t.modal.data.items.from),f=e.ref(t.modal.data.items.to),s=e.ref(""),m=e.ref(!1),i=e.ref(!1),u=e.computed(()=>m.value?o("Copy files"):o("Move files")),_=e.computed(()=>m.value?o("Are you sure you want to copy these files?"):o("Are you sure you want to move these files?")),p=e.computed(()=>m.value?o("Yes, Copy!"):o("Yes, Move!")),E=e.computed(()=>m.value?o("Files copied."):o("Files moved.")),k=c=>{c&&(f.value=c)},g=c=>{c&&(f.value=c,i.value=!1)},v=()=>{const c=f.value.path;if(!c)return{storage:"local",path:""};if(c.endsWith("://"))return{storage:c.replace("://",""),path:""};const y=c.split("://");return{storage:y[0]||"local",path:y[1]||""}},h=()=>{if(a.value.length){const c=m.value?"copy":d.q||"move";t.emitter.emit("vf-fetch",{params:{q:c,m:"post",storage:l.value.storage,path:l.value.path},body:{items:a.value.map(({path:y,type:N})=>({path:y,type:N})),item:f.value.path},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:E})},onError:y=>{s.value=o(y.message)}})}};return(c,y)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:h,class:"vf-btn vf-btn-primary"},e.toDisplayString(p.value),1),e.createElementVNode("button",{type:"button",onClick:y[4]||(y[4]=N=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1),e.createElementVNode("div",pl,e.toDisplayString(e.unref(o)("%s item(s) selected.",a.value.length)),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(kr),title:u.value},null,8,["icon","title"]),e.createElementVNode("div",tl,[e.createElementVNode("p",ol,e.toDisplayString(_.value),1),e.createElementVNode("div",nl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,N=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__move-modal__file",key:N.path},[e.createElementVNode("div",null,[N.type==="dir"?(e.openBlock(),e.createElementBlock("svg",rl,[...y[5]||(y[5]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",ll,[...y[6]||(y[6]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])]))]),e.createElementVNode("div",al,e.toDisplayString(N.path),1)]))),128))]),e.createElementVNode("h4",sl,e.toDisplayString(e.unref(o)("Target Directory")),1),e.createElementVNode("div",il,[e.createElementVNode("div",{class:"vuefinder__move-modal__target-display",onClick:y[0]||(y[0]=N=>i.value=!i.value)},[e.createElementVNode("div",cl,[e.createElementVNode("span",dl,e.toDisplayString(v().storage)+"://",1),v().path?(e.openBlock(),e.createElementBlock("span",ul,e.toDisplayString(v().path),1)):e.createCommentVNode("",!0)]),e.createElementVNode("span",ml,e.toDisplayString(e.unref(o)("Browse")),1)])]),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__move-modal__tree-selector",i.value?"vuefinder__move-modal__tree-selector--expanded":"vuefinder__move-modal__tree-selector--collapsed"])},[e.createVNode(tt,{modelValue:f.value,"onUpdate:modelValue":[y[1]||(y[1]=N=>f.value=N),k],"show-pinned-folders":!0,onSelectAndClose:g},null,8,["modelValue"])],2),e.createElementVNode("div",fl,[e.createElementVNode("label",vl,[e.withDirectives(e.createElementVNode("input",{type:"checkbox","onUpdate:modelValue":y[2]||(y[2]=N=>m.value=N),class:"vuefinder__move-modal__checkbox"},null,512),[[e.vModelCheckbox,m.value]]),e.createElementVNode("span",_l,e.toDisplayString(e.unref(o)("Create a copy instead of moving")),1)])]),s.value.length?(e.openBlock(),e.createBlock(e.unref(s),{key:0,onHidden:y[3]||(y[3]=N=>s.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(s.value),1)]),_:1})):e.createCommentVNode("",!0)])])]),_:1}))}}),ie=e.defineComponent({__name:"ModalMove",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n;return(r,l)=>(e.openBlock(),e.createBlock(ot,{q:"move"}))}}),Re=e.defineComponent({__name:"ModalCopy",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n;return(r,l)=>(e.openBlock(),e.createBlock(ot,{q:"copy"}))}}),J={ESCAPE:"Escape",F2:"F2",F5:"F5",DELETE:"Delete",ENTER:"Enter",BACKSLASH:"Backslash",KEY_A:"KeyA",KEY_E:"KeyE",KEY_F:"KeyF",SPACE:"Space",KEY_C:"KeyC",KEY_X:"KeyX",KEY_V:"KeyV"};function hl(n){const t=n.search,o=n.fs,r=n.config,l=D.useStore(t.state),d=D.useStore(o.selectedItems),a=f=>{if(f.code===J.ESCAPE&&(n.modal.close(),n.root.focus()),!n.modal.visible&&!l.value?.searchMode){if(f.code===J.F2&&n.features.includes(z.RENAME)&&d.value.length===1&&n.modal.open(Ee,{items:d.value}),f.code===J.F5&&n.emitter.emit("vf-fetch",{params:{q:"index",storage:o.path.get().storage,path:o.path.get().path}}),f.code===J.DELETE&&d.value.length===0&&n.modal.open(be,{items:d.value}),f.ctrlKey&&f.code===J.BACKSLASH&&n.modal.open(Te),f.ctrlKey&&f.code===J.KEY_F&&n.features.includes(z.SEARCH)&&(t.enterSearchMode(),f.preventDefault()),f.ctrlKey&&f.code===J.KEY_E&&(r.toggle("showTreeView"),f.preventDefault()),f.ctrlKey&&f.code===J.ENTER&&(r.toggle("fullScreen"),n.root.focus()),f.ctrlKey&&f.code===J.KEY_A&&(o.selectAll(n.selectionMode||"multiple"),f.preventDefault()),f.code===J.SPACE&&d.value.length===1&&d.value[0]?.type!=="dir"&&n.modal.open(Fe,{storage:o.path.get().storage,item:d.value[0]}),f.metaKey&&f.code===J.KEY_C){if(d.value.length===0){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("No items selected")});return}o.setClipboard("copy",new Set(d.value.map(s=>s.path))),n.emitter.emit("vf-toast-push",{label:d.value.length===1?n.i18n.t("Item copied to clipboard"):n.i18n.t("%s items copied to clipboard",d.value.length)}),f.preventDefault()}if(f.metaKey&&f.code===J.KEY_X){if(d.value.length===0){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("No items selected")});return}o.setClipboard("cut",new Set(d.value.map(s=>s.path))),n.emitter.emit("vf-toast-push",{label:d.value.length===1?n.i18n.t("Item cut to clipboard"):n.i18n.t("%s items cut to clipboard",d.value.length)}),f.preventDefault()}if(f.metaKey&&f.code===J.KEY_V){if(o.getClipboard().items.size===0){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("No items in clipboard")});return}if(o.getClipboard().path===o.path.get().path){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("Cannot paste items to the same directory")});return}if(o.getClipboard().type==="cut"){n.modal.open(ie,{items:{from:Array.from(o.getClipboard().items),to:o.path.get()}}),o.clearClipboard();return}if(o.getClipboard().type==="copy"){n.modal.open(Re,{items:{from:Array.from(o.getClipboard().items),to:o.path.get()}});return}f.preventDefault()}}};e.onMounted(()=>{n.root.addEventListener("keydown",a)}),e.onBeforeUnmount(()=>{n.root.removeEventListener("keydown",a)})}function gl(){const n=e.ref(!1),t=e.ref([]);return{isDraggingExternal:n,externalFiles:t,handleDragEnter:f=>{f.preventDefault();const s=f.dataTransfer?.items;s&&Array.from(s).some(i=>i.kind==="file")&&(n.value=!0)},handleDragOver:f=>{n.value&&f.dataTransfer&&(f.dataTransfer.dropEffect="copy",f.preventDefault())},handleDragLeave:f=>{f.preventDefault();const s=f.currentTarget.getBoundingClientRect(),m=f.clientX,i=f.clientY;(m<s.left||m>s.right||i<s.top||i>s.bottom)&&(n.value=!1)},handleDrop:f=>{f.preventDefault(),n.value=!1;const s=f.dataTransfer?.items;if(s){const m=Array.from(s).filter(i=>i.kind==="file");if(m.length>0)return t.value=m.map(i=>{const u=i.getAsFile();if(!u)throw new Error("File not found");return{name:u.name,size:u.size,type:u.type,lastModified:new Date(u.lastModified),file:u}}),t.value}return[]},clearExternalFiles:()=>{t.value=[]}}}const kl={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function wl(n,t){return e.openBlock(),e.createElementBlock("svg",kl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44z"},null,-1)])])}const nt={render:wl},yl={class:"vuefinder__new-folder-modal__content"},bl={class:"vuefinder__new-folder-modal__form"},El={class:"vuefinder__new-folder-modal__description"},Vl=["placeholder"],Pe=e.defineComponent({__name:"ModalNewFolder",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=e.ref(""),a=e.ref(""),f=()=>{d.value!==""&&t.emitter.emit("vf-fetch",{params:{q:"newfolder",m:"post",storage:l.value.storage,path:l.value.path},body:{name:d.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("%s is created.",d.value)})},onError:s=>{a.value=o(s.message)}})};return(s,m)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:f,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Create")),1),e.createElementVNode("button",{type:"button",onClick:m[2]||(m[2]=i=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(nt),title:e.unref(o)("New Folder")},null,8,["icon","title"]),e.createElementVNode("div",yl,[e.createElementVNode("div",bl,[e.createElementVNode("p",El,e.toDisplayString(e.unref(o)("Create a new folder")),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":m[0]||(m[0]=i=>d.value=i),onKeyup:e.withKeys(f,["enter"]),class:"vuefinder__new-folder-modal__input",placeholder:e.unref(o)("Folder Name"),type:"text"},null,40,Vl),[[e.vModelText,d.value]]),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:m[1]||(m[1]=i=>a.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),Nl={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function Sl(n,t){return e.openBlock(),e.createElementBlock("svg",Nl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9"},null,-1)])])}const rt={render:Sl},Bl={class:"vuefinder__new-file-modal__content"},Cl={class:"vuefinder__new-file-modal__form"},xl={class:"vuefinder__new-file-modal__description"},$l=["placeholder"],lt=e.defineComponent({__name:"ModalNewFile",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=e.ref(""),a=e.ref(""),f=()=>{d.value!==""&&t.emitter.emit("vf-fetch",{params:{q:"newfile",m:"post",storage:l.value.storage,path:l.value.path},body:{name:d.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("%s is created.",d.value)})},onError:s=>{a.value=o(s.message)}})};return(s,m)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:f,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Create")),1),e.createElementVNode("button",{type:"button",onClick:m[2]||(m[2]=i=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(rt),title:e.unref(o)("New File")},null,8,["icon","title"]),e.createElementVNode("div",Bl,[e.createElementVNode("div",Cl,[e.createElementVNode("p",xl,e.toDisplayString(e.unref(o)("Create a new file")),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":m[0]||(m[0]=i=>d.value=i),onKeyup:e.withKeys(f,["enter"]),class:"vuefinder__new-file-modal__input",placeholder:e.unref(o)("File Name"),type:"text"},null,40,$l),[[e.vModelText,d.value]]),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:m[1]||(m[1]=i=>a.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),W={PENDING:0,CANCELED:1,UPLOADING:2,ERROR:3,DONE:10};function Dl(){const n=e.inject("ServiceContainer"),{t}=n.i18n,o=n.fs,r=D.useStore(o.path),l=n.config,d=e.ref({QUEUE_ENTRY_STATUS:W}),a=e.ref(null),f=e.ref(null),s=e.ref(null),m=e.ref(null),i=e.ref(null),u=e.ref(null),_=e.ref([]),p=e.ref(""),E=e.ref(!1),k=e.ref(!1),g=e.ref(null);let v;const h=C=>_.value.findIndex(A=>A.id===C),c=(C,A)=>v.addFile({name:A||C.name,type:C.type,data:C,source:"Local"}),y=C=>C.status===W.DONE?"text-green-600":C.status===W.ERROR||C.status===W.CANCELED?"text-red-600":"",N=C=>C.status===W.DONE?"✓":C.status===W.ERROR||C.status===W.CANCELED?"!":"...",$=()=>m.value?.click(),q=()=>n.modal.close(),H=C=>{if(E.value||!_.value.filter(A=>A.status!==W.DONE).length){E.value||(p.value=t("Please select file to upload first."));return}p.value="",g.value=C||r.value,v.upload()},R=()=>{v.cancelAll(),_.value.forEach(C=>{C.status!==W.DONE&&(C.status=W.CANCELED,C.statusName=t("Canceled"))}),E.value=!1},U=C=>{E.value||(v.removeFile(C.id),_.value.splice(h(C.id),1))},K=C=>{if(!E.value)if(v.cancelAll(),C){const A=_.value.filter(S=>S.status!==W.DONE);_.value=[],A.forEach(S=>c(S.originalFile,S.name))}else _.value=[]},Q=C=>{C.forEach(A=>{c(A)})};return e.onMounted(()=>{v=new gt({debug:n.debug,restrictions:{maxFileSize:Ct(l.maxFileSize??"10mb")},locale:n.i18n.t("uppy"),onBeforeFileAdded:(S,V)=>{if(V[S.id]!=null){const I=h(S.id);_.value[I]?.status===W.PENDING&&(p.value=v.i18n("noDuplicates",{fileName:S.name})),_.value=_.value.filter(M=>M.id!==S.id)}return _.value.push({id:S.id,name:S.name,size:n.filesize(S.size),status:W.PENDING,statusName:t("Pending upload"),percent:null,originalFile:S.data}),!0}}),v.use(kt,{endpoint:"WILL_BE_REPLACED_BEFORE_UPLOAD",limit:5,timeout:0}),v.on("restriction-failed",(S,V)=>{const b=_.value[h(S.id)];b&&U(b),p.value=V.message}),v.on("upload",()=>{const S=g.value||r.value,V=n.requester.transformRequestParams({url:"",method:"post",params:{q:"upload",storage:S.storage,path:S.path}});v.setMeta({...V.body});const b=v.getPlugin("XHRUpload");b&&(b.opts.method=V.method,b.opts.endpoint=V.url+"?"+new URLSearchParams(V.params),b.opts.headers=V.headers),delete V.headers["Content-Type"],E.value=!0,_.value.forEach(I=>{I.status!==W.DONE&&(I.percent=null,I.status=W.UPLOADING,I.statusName=t("Pending upload"))})}),v.on("upload-progress",(S,V)=>{const b=V.bytesTotal??1,I=Math.floor(V.bytesUploaded/b*100),M=h(S.id);M!==-1&&_.value[M]&&(_.value[M].percent=`${I}%`)}),v.on("upload-success",S=>{const V=_.value[h(S.id)];V&&(V.status=W.DONE,V.statusName=t("Done"))}),v.on("upload-error",(S,V)=>{const b=_.value[h(S.id)];b&&(b.percent=null,b.status=W.ERROR,b.statusName=V?.isNetworkError?t("Network Error, Unable establish connection to the server or interrupted."):V?.message||t("Unknown Error"))}),v.on("error",S=>{p.value=S.message,E.value=!1,n.emitter.emit("vf-fetch",{params:{q:"index"},dontCloseModal:!0})}),v.on("complete",()=>{E.value=!1;const S=_.value.filter(b=>b.status===W.DONE).map(b=>b.name),V=g.value||r.value;n.emitter.emit("vf-fetch",{params:{q:"index",path:V.path,storage:V.storage},dontCloseModal:!0,onSuccess:b=>{const I=(b?.files||[]).filter(M=>S.includes(M.basename));n.emitter.emit("vf-upload-complete",I)}})}),m.value?.addEventListener("click",()=>f.value?.click()),i.value?.addEventListener("click",()=>s.value?.click()),u.value?.addEventListener("dragover",S=>{S.preventDefault(),k.value=!0}),u.value?.addEventListener("dragleave",S=>{S.preventDefault(),k.value=!1});const C=(S,V)=>{V.isFile&&V.file(b=>S(V,b)),V.isDirectory&&V.createReader().readEntries(b=>b.forEach(I=>C(S,I)))};u.value?.addEventListener("drop",S=>{S.preventDefault(),k.value=!1;const V=/^[/\\](.+)/,b=S.dataTransfer?.items;b&&Array.from(b).forEach(I=>{I.kind==="file"&&C((M,F)=>{const P=V.exec(M.fullPath);c(F,P?P[1]:F.name)},I.webkitGetAsEntry())})});const A=S=>{const V=S.target,b=V.files;if(b){for(const I of b)c(I);V.value=""}};f.value?.addEventListener("change",A),s.value?.addEventListener("change",A)}),{container:a,internalFileInput:f,internalFolderInput:s,pickFiles:m,pickFolders:i,dropArea:u,queue:_,message:p,uploading:E,hasFilesInDropArea:k,definitions:d,openFileSelector:$,upload:H,cancel:R,remove:U,clear:K,close:q,getClassNameForEntry:y,getIconForEntry:N,addExternalFiles:Q}}function Me(n,t=14){const o=`((?=([\\w\\W]{0,${t}}))([\\w\\W]{${t+1},})([\\w\\W]{8,}))`;return n.replace(new RegExp(o),"$2..$4")}const Ml={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function Tl(n,t){return e.openBlock(),e.createElementBlock("svg",Ml,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"},null,-1)])])}const at={render:Tl},Fl={class:"vuefinder__upload-modal__content"},Al={class:"vuefinder__upload-modal__target-section"},Ll={class:"vuefinder__upload-modal__target-label"},Il={class:"vuefinder__upload-modal__target-container"},Rl={class:"vuefinder__upload-modal__target-path"},Pl={class:"vuefinder__upload-modal__target-storage"},zl={key:0,class:"vuefinder__upload-modal__target-folder"},Hl={class:"vuefinder__upload-modal__target-badge"},Ol={key:0,class:"pointer-events-none"},ql={key:1,class:"pointer-events-none"},Ul=["disabled"],jl=["disabled"],Kl={class:"vuefinder__upload-modal__file-list vf-scrollbar"},Gl=["textContent"],Yl={class:"vuefinder__upload-modal__file-info"},Wl={class:"vuefinder__upload-modal__file-name hidden md:block"},Xl={class:"vuefinder__upload-modal__file-name md:hidden"},Ql={key:0,class:"ml-auto"},Jl=["title","disabled","onClick"],Zl={key:0,class:"py-2"},ea=["disabled"],ze=e.defineComponent({__name:"ModalUpload",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=e.ref(l.value),a=e.ref(!1),f=()=>{const S=d.value.path;if(!S)return{storage:"local",path:""};if(S.endsWith("://"))return{storage:S.replace("://",""),path:""};const V=S.split("://");return{storage:V[0]||"local",path:V[1]||""}},s=S=>{S&&(d.value=S)},m=S=>{S&&(d.value=S,a.value=!1)},{container:i,internalFileInput:u,internalFolderInput:_,pickFiles:p,pickFolders:E,dropArea:k,queue:g,message:v,uploading:h,hasFilesInDropArea:c,definitions:y,openFileSelector:N,upload:$,cancel:q,remove:H,clear:R,close:U,getClassNameForEntry:K,getIconForEntry:Q,addExternalFiles:C}=Dl(),A=()=>{$(d.value)};return e.onMounted(()=>{t.emitter.on("vf-external-files-dropped",S=>{C(S)})}),e.onUnmounted(()=>{t.emitter.off("vf-external-files-dropped")}),(S,V)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-primary",disabled:e.unref(h),onClick:e.withModifiers(A,["prevent"])},e.toDisplayString(e.unref(o)("Upload")),9,ea),e.unref(h)?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:"vf-btn vf-btn-secondary",onClick:V[6]||(V[6]=e.withModifiers((...b)=>e.unref(q)&&e.unref(q)(...b),["prevent"]))},e.toDisplayString(e.unref(o)("Cancel")),1)):(e.openBlock(),e.createElementBlock("button",{key:1,type:"button",class:"vf-btn vf-btn-secondary",onClick:V[7]||(V[7]=e.withModifiers((...b)=>e.unref(U)&&e.unref(U)(...b),["prevent"]))},e.toDisplayString(e.unref(o)("Close")),1))]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(at),title:e.unref(o)("Upload Files")},null,8,["icon","title"]),e.createElementVNode("div",Fl,[e.createElementVNode("div",Al,[e.createElementVNode("div",Ll,e.toDisplayString(e.unref(o)("Hedef Klasör")),1),e.createElementVNode("div",Il,[e.createElementVNode("div",{class:"vuefinder__upload-modal__target-display",onClick:V[0]||(V[0]=b=>a.value=!a.value)},[e.createElementVNode("div",Rl,[e.createElementVNode("span",Pl,e.toDisplayString(f().storage)+"://",1),f().path?(e.openBlock(),e.createElementBlock("span",zl,e.toDisplayString(f().path),1)):e.createCommentVNode("",!0)]),e.createElementVNode("span",Hl,e.toDisplayString(e.unref(o)("Browse")),1)])]),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__upload-modal__tree-selector",a.value?"vuefinder__upload-modal__tree-selector--expanded":"vuefinder__upload-modal__tree-selector--collapsed"])},[e.createVNode(tt,{modelValue:d.value,"onUpdate:modelValue":[V[1]||(V[1]=b=>d.value=b),s],"show-pinned-folders":!0,onSelectAndClose:m},null,8,["modelValue"])],2)]),e.createElementVNode("div",{class:"vuefinder__upload-modal__drop-area",ref_key:"dropArea",ref:k,onClick:V[2]||(V[2]=(...b)=>e.unref(N)&&e.unref(N)(...b))},[e.unref(c)?(e.openBlock(),e.createElementBlock("div",Ol,e.toDisplayString(e.unref(o)("Release to drop these files.")),1)):(e.openBlock(),e.createElementBlock("div",ql,e.toDisplayString(e.unref(o)("Drag and drop the files/folders to here.")),1))],512),e.createElementVNode("div",{ref_key:"container",ref:i,class:"vuefinder__upload-modal__buttons"},[e.createElementVNode("button",{ref_key:"pickFiles",ref:p,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Select Files")),513),e.createElementVNode("button",{ref_key:"pickFolders",ref:E,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Select Folders")),513),e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-secondary",disabled:e.unref(h),onClick:V[3]||(V[3]=b=>e.unref(R)(!1))},e.toDisplayString(e.unref(o)("Clear all")),9,Ul),e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-secondary",disabled:e.unref(h),onClick:V[4]||(V[4]=b=>e.unref(R)(!0))},e.toDisplayString(e.unref(o)("Clear only successful")),9,jl)],512),e.createElementVNode("div",Kl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(g),b=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__upload-modal__file-entry",key:b.id},[e.createElementVNode("span",{class:e.normalizeClass(["vuefinder__upload-modal__file-icon",e.unref(K)(b)])},[e.createElementVNode("span",{class:"vuefinder__upload-modal__file-icon-text",textContent:e.toDisplayString(e.unref(Q)(b))},null,8,Gl)],2),e.createElementVNode("div",Yl,[e.createElementVNode("div",Wl,e.toDisplayString(e.unref(Me)(b.name,40))+" ("+e.toDisplayString(b.size)+") ",1),e.createElementVNode("div",Xl,e.toDisplayString(e.unref(Me)(b.name,16))+" ("+e.toDisplayString(b.size)+") ",1),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__upload-modal__file-status",e.unref(K)(b)])},[e.createTextVNode(e.toDisplayString(b.statusName)+" ",1),b.status===e.unref(y).QUEUE_ENTRY_STATUS.UPLOADING?(e.openBlock(),e.createElementBlock("b",Ql,e.toDisplayString(b.percent),1)):e.createCommentVNode("",!0)],2)]),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["vuefinder__upload-modal__file-remove",e.unref(h)?"disabled":""]),title:e.unref(o)("Delete"),disabled:e.unref(h),onClick:I=>e.unref(H)(b)},[...V[8]||(V[8]=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"vuefinder__upload-modal__file-remove-icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],10,Jl)]))),128)),e.unref(g).length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Zl,e.toDisplayString(e.unref(o)("No files selected!")),1))]),e.unref(v).length?(e.openBlock(),e.createBlock(Ze,{key:0,onHidden:V[5]||(V[5]=b=>v.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(v)),1)]),_:1})):e.createCommentVNode("",!0)])]),e.createElementVNode("input",{ref_key:"internalFileInput",ref:u,type:"file",multiple:"",class:"hidden"},null,512),e.createElementVNode("input",{ref_key:"internalFolderInput",ref:_,type:"file",multiple:"",webkitdirectory:"",class:"hidden"},null,512)]),_:1}))}}),ta={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function oa(n,t){return e.openBlock(),e.createElementBlock("svg",ta,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m6 4.125 2.25 2.25m0 0 2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125"},null,-1)])])}const st={render:oa},na={class:"vuefinder__unarchive-modal__content"},ra={class:"vuefinder__unarchive-modal__items"},la={key:0,class:"vuefinder__unarchive-modal__icon vuefinder__unarchive-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},aa={key:1,class:"vuefinder__unarchive-modal__icon vuefinder__unarchive-modal__icon--file",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},sa={class:"vuefinder__unarchive-modal__item-name"},ia={class:"vuefinder__unarchive-modal__info"},He=e.defineComponent({__name:"ModalUnarchive",setup(n){const t=e.inject("ServiceContainer"),o=t.fs,r=D.useStore(o.path),{t:l}=t.i18n,d=e.ref(t.modal.data.items[0]),a=e.ref(""),f=e.ref([]),s=()=>{t.emitter.emit("vf-fetch",{params:{q:"unarchive",m:"post",storage:r.value.storage,path:r.value.path},body:{item:d.value.path},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:l("The file unarchived.")})},onError:m=>{a.value=l(m.message)}})};return(m,i)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:s,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(l)("Unarchive")),1),e.createElementVNode("button",{type:"button",onClick:i[1]||(i[1]=u=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(l)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(st),title:e.unref(l)("Unarchive")},null,8,["icon","title"]),e.createElementVNode("div",na,[e.createElementVNode("div",ra,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,u=>(e.openBlock(),e.createElementBlock("p",{class:"vuefinder__unarchive-modal__item",key:u.path},[u.type==="dir"?(e.openBlock(),e.createElementBlock("svg",la,[...i[2]||(i[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",aa,[...i[3]||(i[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",sa,e.toDisplayString(u.basename),1)]))),128)),e.createElementVNode("p",ia,e.toDisplayString(e.unref(l)("The archive will be unarchived at"))+" ("+e.toDisplayString(e.unref(r).path)+")",1),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:i[0]||(i[0]=u=>a.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),ca={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function da(n,t){return e.openBlock(),e.createElementBlock("svg",ca,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125"},null,-1)])])}const it={render:da},ua={class:"vuefinder__archive-modal__content"},ma={class:"vuefinder__archive-modal__form"},fa={class:"vuefinder__archive-modal__files vf-scrollbar"},va={class:"vuefinder__archive-modal__file"},_a={key:0,class:"vuefinder__archive-modal__icon vuefinder__archive-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},pa={key:1,class:"vuefinder__archive-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},ha={class:"vuefinder__archive-modal__file-name"},ga=["placeholder"],Oe=e.defineComponent({__name:"ModalArchive",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.path),d=e.ref(""),a=e.ref(""),f=e.ref(t.modal.data.items),s=()=>{f.value.length&&t.emitter.emit("vf-fetch",{params:{q:"archive",m:"post",storage:l.value.storage,path:l.value.path},body:{items:f.value.map(({path:m,type:i})=>({path:m,type:i})),name:d.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("The file(s) archived.")})},onError:m=>{a.value=o(m.message)}})};return(m,i)=>(e.openBlock(),e.createBlock(oe,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:s,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Archive")),1),e.createElementVNode("button",{type:"button",onClick:i[2]||(i[2]=u=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ne,{icon:e.unref(it),title:e.unref(o)("Archive the files")},null,8,["icon","title"]),e.createElementVNode("div",ua,[e.createElementVNode("div",ma,[e.createElementVNode("div",fa,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,u=>(e.openBlock(),e.createElementBlock("p",va,[u.type==="dir"?(e.openBlock(),e.createElementBlock("svg",_a,[...i[3]||(i[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",pa,[...i[4]||(i[4]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",ha,e.toDisplayString(u.basename),1)]))),256))]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[0]||(i[0]=u=>d.value=u),onKeyup:e.withKeys(s,["enter"]),class:"vuefinder__archive-modal__input",placeholder:e.unref(o)("Archive name. (.zip file will be created)"),type:"text"},null,40,ga),[[e.vModelText,d.value]]),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:i[1]||(i[1]=u=>a.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),ka={class:"vuefinder__menubar__container"},wa=["onClick","onMouseenter"],ya={class:"vuefinder__menubar__label"},ba=["onMouseenter"],Ea=["onClick"],Va={key:0,class:"vuefinder__menubar__dropdown__label"},Na={key:1,class:"vuefinder__menubar__dropdown__checkmark"},Sa=e.defineComponent({__name:"MenuBar",setup(n){const t=e.inject("ServiceContainer");t||console.error("MenuBar: ServiceContainer not found");const{t:o}=t?.i18n||{t:c=>c},r=t?.fs,l=t?.config,d=t?.search,a=D.useStore(l?.state||{}),f=D.useStore(d?.state||{}),s=D.useStore(r?.selectedItems||[]),m=D.useStore(r?.storages||[]),i=e.ref(null),u=e.ref(!1),_=e.computed(()=>window.opener!==null||window.name!==""||window.history.length<=1),p=e.computed(()=>[{id:"file",label:o("File"),items:[{id:"new-folder",label:o("New Folder"),action:()=>t?.modal?.open(Pe,{items:s.value}),enabled:()=>t?.features?.includes(z.NEW_FOLDER)||!1},{id:"new-file",label:o("New File"),action:()=>t?.modal?.open(lt,{items:s.value}),enabled:()=>t?.features?.includes(z.NEW_FILE)||!1},{type:"separator"},{id:"upload",label:o("Upload"),action:()=>t?.modal?.open(ze,{items:s.value}),enabled:()=>t?.features?.includes(z.UPLOAD)||!1},{type:"separator"},{id:"search",label:o("Search"),action:()=>d?.enterSearchMode(),enabled:()=>t?.features?.includes(z.SEARCH)},{type:"separator"},{id:"archive",label:o("Archive"),action:()=>{s.value.length>0&&t?.modal?.open(Oe,{items:s.value})},enabled:()=>s.value.length>0&&t?.features?.includes(z.ARCHIVE)},{id:"unarchive",label:o("Unarchive"),action:()=>{s.value.length===1&&s.value[0]?.mime_type==="application/zip"&&t?.modal?.open(He,{items:s.value})},enabled:()=>s.value.length===1&&s.value[0]?.mime_type==="application/zip"&&t?.features?.includes(z.UNARCHIVE)},{type:"separator"},{id:"preview",label:o("Preview"),action:()=>{s.value.length===1&&s.value[0]?.type!=="dir"&&t?.modal?.open(Fe,{storage:r?.path?.get()?.storage,item:s.value[0]})},enabled:()=>s.value.length===1&&s.value[0]?.type!=="dir"},..._.value?[{type:"separator"},{id:"exit",label:o("Exit"),action:()=>{try{window.close()}catch(c){console.log("Cannot close window:",c.message)}},enabled:()=>!0}]:[]]},{id:"edit",label:o("Edit"),items:[...t?.selectionMode==="multiple"?[{id:"select-all",label:o("Select All"),action:()=>r?.selectAll(t?.selectionMode||"multiple"),enabled:()=>!0},{id:"deselect",label:o("Deselect All"),action:()=>r?.clearSelection(),enabled:()=>s.value.length>0},{type:"separator"}]:[],{id:"cut",label:o("Cut"),action:()=>{s.value.length>0&&r?.setClipboard("cut",new Set(s.value.map(c=>c.path)))},enabled:()=>s.value.length>0},{id:"copy",label:o("Copy"),action:()=>{s.value.length>0&&r?.setClipboard("copy",new Set(s.value.map(c=>c.path)))},enabled:()=>s.value.length>0},{id:"paste",label:o("Paste"),action:()=>{const c=r?.getClipboard();c?.items?.size>0&&t?.modal?.open(c.type==="cut"?ie:Re,{items:{from:Array.from(c.items),to:r?.path?.get()}})},enabled:()=>r?.getClipboard()?.items?.size>0},{id:"move",label:o("Move"),action:()=>{if(s.value.length>0){const c=t?.fs,y={storage:c?.path?.get()?.storage||"",path:c?.path?.get()?.path||"",type:"dir"};t?.modal?.open(ie,{items:{from:s.value,to:y}})}},enabled:()=>s.value.length>0&&t?.features?.includes(z.MOVE)},{type:"separator"},{id:"copy-path",label:o("Copy Path"),action:()=>{if(s.value.length===1){const c=s.value[0];navigator.clipboard.writeText(c.path).catch(y=>{console.error("Failed to copy path:",y)})}},enabled:()=>s.value.length===1},{id:"copy-download-url",label:o("Copy Download URL"),action:()=>{if(s.value.length===1){const c=s.value[0],y=r?.path?.get()?.storage??"local",N=t?.requester?.getDownloadUrl(y,c);N&&navigator.clipboard.writeText(N).catch($=>{console.error("Failed to copy download URL:",$)})}},enabled:()=>s.value.length===1},{type:"separator"},{id:"rename",label:o("Rename"),action:()=>{s.value.length===1&&t?.modal?.open(Ee,{items:s.value})},enabled:()=>s.value.length===1&&t?.features?.includes(z.RENAME)},{id:"delete",label:o("Delete"),action:()=>{s.value.length>0&&t?.modal?.open(be,{items:s.value})},enabled:()=>s.value.length>0&&t?.features?.includes(z.DELETE)}]},{id:"view",label:o("View"),items:[{id:"refresh",label:o("Refresh"),action:()=>{t?.emitter?.emit("vf-fetch",{params:{q:"index",storage:r?.path?.get()?.storage,path:r?.path?.get()?.path}})},enabled:()=>!0},{type:"separator"},{id:"grid-view",label:o("Grid View"),action:()=>l?.set("view","grid"),enabled:()=>!f.value?.query?.length,checked:()=>a.value?.view==="grid"},{id:"list-view",label:o("List View"),action:()=>l?.set("view","list"),enabled:()=>!f.value?.query?.length,checked:()=>a.value?.view==="list"},{type:"separator"},{id:"tree-view",label:o("Tree View"),action:()=>l?.toggle("showTreeView"),enabled:()=>!0,checked:()=>a.value?.showTreeView},{id:"thumbnails",label:o("Show Thumbnails"),action:()=>l?.toggle("showThumbnails"),enabled:()=>!0,checked:()=>a.value?.showThumbnails},{id:"show-hidden-files",label:o("Show Hidden Files"),action:()=>l?.toggle("showHiddenFiles"),enabled:()=>!0,checked:()=>a.value?.showHiddenFiles},{type:"separator"},{id:"fullscreen",label:o("Full Screen"),action:()=>l?.toggle("fullScreen"),enabled:()=>t?.features?.includes(z.FULL_SCREEN),checked:()=>a.value?.fullScreen}]},{id:"go",label:o("Go"),items:[{id:"forward",label:o("Forward"),action:()=>{r?.goForward(),t?.emitter?.emit("vf-fetch",{params:{q:"index",storage:r?.path?.get()?.storage??"local",path:r?.currentPath?.get()??""}})},enabled:()=>r?.canGoForward?.get()??!1},{id:"back",label:o("Back"),action:()=>{r?.goBack(),t?.emitter?.emit("vf-fetch",{params:{q:"index",storage:r?.path?.get()?.storage??"local",path:r?.currentPath?.get()??""}})},enabled:()=>r?.canGoBack?.get()??!1},{id:"open-containing-folder",label:o("Open containing folder"),action:()=>{const c=r?.path?.get();if(c?.breadcrumb&&c.breadcrumb.length>0){const N=c.breadcrumb[c.breadcrumb.length-2]?.path??`${c.storage}://`;r?.setPath(N),t?.emitter?.emit("vf-fetch",{params:{q:"index",storage:c.storage??"local",path:N}})}},enabled:()=>{const c=r?.path?.get();return c?.breadcrumb&&c.breadcrumb.length>0}},{type:"separator"},...(m.value||[]).map(c=>({id:`storage-${c}`,label:c,action:()=>{const y=`${c}://`;r?.setPath(y),t?.emitter?.emit("vf-fetch",{params:{q:"index",storage:c,path:y}})},enabled:()=>!0})),{type:"separator"},{id:"go-to-folder",label:o("Go to Folder"),action:()=>{const c=prompt(o("Enter folder path:"));c&&(r?.setPath(c),t?.emitter?.emit("vf-fetch",{params:{q:"index",storage:r?.path?.get()?.storage??"local",path:c}}))},enabled:()=>!0}]},{id:"help",label:o("Help"),items:[{id:"about",label:o("About"),action:()=>t?.modal?.open(Te),enabled:()=>!0}]}]),E=c=>{i.value===c?g():(i.value=c,u.value=!0)},k=c=>{u.value&&(i.value=c)},g=()=>{i.value=null,u.value=!1},v=c=>{g(),c()},h=c=>{c.target.closest(".vuefinder__menubar")||g()};return e.onMounted(()=>{document.addEventListener("click",h)}),e.onUnmounted(()=>{document.removeEventListener("click",h)}),(c,y)=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__menubar",onClick:y[0]||(y[0]=e.withModifiers(()=>{},["stop"]))},[e.createElementVNode("div",ka,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,N=>(e.openBlock(),e.createElementBlock("div",{key:N.id,class:e.normalizeClass(["vuefinder__menubar__item",{"vuefinder__menubar__item--active":i.value===N.id}]),onClick:$=>E(N.id),onMouseenter:$=>k(N.id)},[e.createElementVNode("span",ya,e.toDisplayString(N.label),1),i.value===N.id?(e.openBlock(),e.createElementBlock("div",{key:0,class:"vuefinder__menubar__dropdown",onMouseenter:$=>k(N.id)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(N.items,$=>(e.openBlock(),e.createElementBlock("div",{key:$.id||$.type,class:e.normalizeClass(["vuefinder__menubar__dropdown__item",{"vuefinder__menubar__dropdown__item--separator":$.type==="separator","vuefinder__menubar__dropdown__item--disabled":$.enabled&&!$.enabled(),"vuefinder__menubar__dropdown__item--checked":$.checked&&$.checked()}]),onClick:e.withModifiers(q=>$.type!=="separator"&&$.enabled&&$.enabled()?v($.action):null,["stop"])},[$.type!=="separator"?(e.openBlock(),e.createElementBlock("span",Va,e.toDisplayString($.label),1)):e.createCommentVNode("",!0),$.checked&&$.checked()?(e.openBlock(),e.createElementBlock("span",Na," ✓ ")):e.createCommentVNode("",!0)],10,Ea))),128))],40,ba)):e.createCommentVNode("",!0)],42,wa))),128))])]))}}),Ba={xmlns:"http://www.w3.org/2000/svg",fill:"none",class:"animate-spin p-0.5 h-5 w-5 text-white ml-auto",viewBox:"0 0 24 24"};function Ca(n,t){return e.openBlock(),e.createElementBlock("svg",Ba,[...t[0]||(t[0]=[e.createElementVNode("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25 stroke-blue-900 dark:stroke-blue-100"},null,-1),e.createElementVNode("path",{fill:"currentColor",d:"M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12zm2 5.291A7.96 7.96 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938z",class:"opacity-75"},null,-1)])])}const qe={render:Ca},xa={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function $a(n,t){return e.openBlock(),e.createElementBlock("svg",xa,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])])}const Da={render:$a},Ma={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function Ta(n,t){return e.openBlock(),e.createElementBlock("svg",Ma,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"},null,-1)])])}const Fa={render:Ta},Aa={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function La(n,t){return e.openBlock(),e.createElementBlock("svg",Aa,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25zm0 9.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18zM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25zm0 9.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18z"},null,-1)])])}const Ia={render:La},Ra={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Pa(n,t){return e.openBlock(),e.createElementBlock("svg",Ra,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75"},null,-1)])])}const za={render:Pa},Ha={fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Oa(n,t){return e.openBlock(),e.createElementBlock("svg",Ha,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M3 4a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v2.586a1 1 0 0 1-.293.707l-6.414 6.414a1 1 0 0 0-.293.707V17l-4 4v-6.586a1 1 0 0 0-.293-.707L3.293 7.293A1 1 0 0 1 3 6.586z"},null,-1)])])}const qa={render:Oa},Ua={class:"vuefinder__toolbar"},ja={key:0,class:"vuefinder__toolbar__actions"},Ka=["title"],Ga=["title"],Ya=["title"],Wa=["title"],Xa=["title"],Qa=["title"],Ja=["title"],Za={key:1,class:"vuefinder__toolbar__search-results"},es={class:"pl-2"},ts={class:"dark:bg-gray-700 bg-gray-200 text-xs px-2 py-1 rounded"},os={class:"vuefinder__toolbar__controls"},ns={class:"vuefinder__toolbar__control vuefinder__toolbar__dropdown-container"},rs=["title"],ls={class:"relative"},as={key:0,class:"vuefinder__toolbar__filter-indicator"},ss={key:0,class:"vuefinder__toolbar__dropdown"},is={class:"vuefinder__toolbar__dropdown-content"},cs={class:"vuefinder__toolbar__dropdown-section"},ds={class:"vuefinder__toolbar__dropdown-label"},us={class:"vuefinder__toolbar__dropdown-row"},ms={value:"name"},fs={value:"size"},vs={value:"modified"},_s={value:""},ps={value:"asc"},hs={value:"desc"},gs={class:"vuefinder__toolbar__dropdown-section"},ks={class:"vuefinder__toolbar__dropdown-label"},ws={class:"vuefinder__toolbar__dropdown-options"},ys={class:"vuefinder__toolbar__dropdown-option"},bs={class:"vuefinder__toolbar__option-text"},Es={class:"vuefinder__toolbar__dropdown-option"},Vs={class:"vuefinder__toolbar__option-text"},Ns={class:"vuefinder__toolbar__dropdown-option"},Ss={class:"vuefinder__toolbar__option-text"},Bs={class:"vuefinder__toolbar__dropdown-toggle"},Cs={for:"showHidden",class:"vuefinder__toolbar__toggle-label"},xs={class:"vuefinder__toolbar__dropdown-reset"},$s=["title"],Ds=["title"],Ms=e.defineComponent({name:"VfToolbar",__name:"Toolbar",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=t.config,d=t.search,a=D.useStore(l.state),f=D.useStore(d.state),s=D.useStore(r.selectedItems),m=D.useStore(r.sort),i=D.useStore(r.filter);e.watch(()=>a.value.fullScreen,()=>{if(a.value.fullScreen){const v=document.querySelector("body");v&&(v.style.overflow="hidden")}else{const v=document.querySelector("body");v&&(v.style.overflow="")}t.emitter.emit("vf-fullscreen-toggle")});const u=e.ref(!1),_=v=>{v.target.closest(".vuefinder__toolbar__dropdown-container")||(u.value=!1)};e.onMounted(()=>{document.addEventListener("click",_)}),e.onUnmounted(()=>{document.removeEventListener("click",_)});const p=e.ref({sortBy:"name",sortOrder:"",filterKind:"all",showHidden:a.value.showHiddenFiles});e.watch(()=>p.value.sortBy,v=>{if(!p.value.sortOrder){r.clearSort();return}v==="name"?r.setSort("basename",p.value.sortOrder):v==="size"?r.setSort("file_size",p.value.sortOrder):v==="modified"&&r.setSort("last_modified",p.value.sortOrder)}),e.watch(()=>p.value.sortOrder,v=>{if(!v){r.clearSort();return}p.value.sortBy==="name"?r.setSort("basename",v):p.value.sortBy==="size"?r.setSort("file_size",v):p.value.sortBy==="modified"&&r.setSort("last_modified",v)}),e.watch(m,v=>{v.active?(v.column==="basename"?p.value.sortBy="name":v.column==="file_size"?p.value.sortBy="size":v.column==="last_modified"&&(p.value.sortBy="modified"),p.value.sortOrder=v.order):p.value.sortOrder=""},{immediate:!0}),e.watch(()=>p.value.filterKind,v=>{r.setFilter(v,a.value.showHiddenFiles)}),e.watch(()=>p.value.showHidden,v=>{l.set("showHiddenFiles",v),r.setFilter(p.value.filterKind,v)}),e.watch(i,v=>{p.value.filterKind=v.kind},{immediate:!0}),e.watch(()=>a.value.showHiddenFiles,v=>{p.value.showHidden=v,r.setFilter(p.value.filterKind,v)},{immediate:!0});const E=()=>l.set("view",a.value.view==="grid"?"list":"grid"),k=e.computed(()=>i.value.kind!=="all"||!a.value.showHiddenFiles||m.value.active),g=()=>{p.value={sortBy:"name",sortOrder:"",filterKind:"all",showHidden:!0},l.set("showHiddenFiles",!0),r.clearSort(),r.clearFilter()};return(v,h)=>(e.openBlock(),e.createElementBlock("div",Ua,[e.unref(f).query.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",ja,[e.unref(t).features.includes(e.unref(z).NEW_FOLDER)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mx-1.5",title:e.unref(o)("New Folder"),onClick:h[0]||(h[0]=c=>e.unref(t).modal.open(Pe,{items:e.unref(s)}))},[e.createVNode(e.unref(nt))],8,Ka)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(z).NEW_FILE)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"mx-1.5",title:e.unref(o)("New File"),onClick:h[1]||(h[1]=c=>e.unref(t).modal.open(lt,{items:e.unref(s)}))},[e.createVNode(e.unref(rt))],8,Ga)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(z).RENAME)?(e.openBlock(),e.createElementBlock("div",{key:2,class:"mx-1.5",title:e.unref(o)("Rename"),onClick:h[2]||(h[2]=c=>e.unref(s).length!==1||e.unref(t).modal.open(Ee,{items:e.unref(s)}))},[e.createVNode(e.unref(Je),{class:e.normalizeClass(e.unref(s).length===1?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Ya)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(z).DELETE)?(e.openBlock(),e.createElementBlock("div",{key:3,class:"mx-1.5",title:e.unref(o)("Delete"),onClick:h[3]||(h[3]=c=>!e.unref(s).length||e.unref(t).modal.open(be,{items:e.unref(s)}))},[e.createVNode(e.unref(Qe),{class:e.normalizeClass(e.unref(s).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Wa)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(z).UPLOAD)?(e.openBlock(),e.createElementBlock("div",{key:4,class:"mx-1.5",title:e.unref(o)("Upload"),onClick:h[4]||(h[4]=c=>e.unref(t).modal.open(ze,{items:e.unref(s)}))},[e.createVNode(e.unref(at))],8,Xa)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(z).UNARCHIVE)&&e.unref(s).length===1&&e.unref(s)[0].mime_type==="application/zip"?(e.openBlock(),e.createElementBlock("div",{key:5,class:"mx-1.5",title:e.unref(o)("Unarchive"),onClick:h[5]||(h[5]=c=>!e.unref(s).length||e.unref(t).modal.open(He,{items:e.unref(s)}))},[e.createVNode(e.unref(st),{class:e.normalizeClass(e.unref(s).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Qa)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(z).ARCHIVE)?(e.openBlock(),e.createElementBlock("div",{key:6,class:"mx-1.5",title:e.unref(o)("Archive"),onClick:h[6]||(h[6]=c=>!e.unref(s).length||e.unref(t).modal.open(Oe,{items:e.unref(s)}))},[e.createVNode(e.unref(it),{class:e.normalizeClass(e.unref(s).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Ja)):e.createCommentVNode("",!0)])),e.unref(f).query?(e.openBlock(),e.createElementBlock("div",Za,[e.createElementVNode("div",es,[e.createTextVNode(e.toDisplayString(e.unref(o)("Search results for"))+" ",1),e.createElementVNode("span",ts,e.toDisplayString(e.unref(f).query),1)]),e.unref(l).get("loadingIndicator")==="circular"&&e.unref(r).isLoading()?(e.openBlock(),e.createBlock(e.unref(qe),{key:0})):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("div",os,[e.createElementVNode("div",ns,[e.createElementVNode("div",{title:e.unref(o)("Filter"),onClick:h[7]||(h[7]=c=>u.value=!u.value),class:"vuefinder__toolbar__dropdown-trigger"},[e.createElementVNode("div",ls,[e.createVNode(e.unref(qa),{class:"vf-toolbar-icon vuefinder__toolbar__icon w-6 h-6"}),k.value?(e.openBlock(),e.createElementBlock("div",as)):e.createCommentVNode("",!0)])],8,rs),u.value?(e.openBlock(),e.createElementBlock("div",ss,[e.createElementVNode("div",is,[e.createElementVNode("div",cs,[e.createElementVNode("div",ds,e.toDisplayString(e.unref(o)("Sorting")),1),e.createElementVNode("div",us,[e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":h[8]||(h[8]=c=>p.value.sortBy=c),class:"vuefinder__toolbar__dropdown-select"},[e.createElementVNode("option",ms,e.toDisplayString(e.unref(o)("Name")),1),e.createElementVNode("option",fs,e.toDisplayString(e.unref(o)("Size")),1),e.createElementVNode("option",vs,e.toDisplayString(e.unref(o)("Date")),1)],512),[[e.vModelSelect,p.value.sortBy]]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":h[9]||(h[9]=c=>p.value.sortOrder=c),class:"vuefinder__toolbar__dropdown-select"},[e.createElementVNode("option",_s,e.toDisplayString(e.unref(o)("None")),1),e.createElementVNode("option",ps,e.toDisplayString(e.unref(o)("Asc")),1),e.createElementVNode("option",hs,e.toDisplayString(e.unref(o)("Desc")),1)],512),[[e.vModelSelect,p.value.sortOrder]])])]),e.createElementVNode("div",gs,[e.createElementVNode("div",ks,e.toDisplayString(e.unref(o)("Show")),1),e.createElementVNode("div",ws,[e.createElementVNode("label",ys,[e.withDirectives(e.createElementVNode("input",{type:"radio",name:"filterKind",value:"all","onUpdate:modelValue":h[10]||(h[10]=c=>p.value.filterKind=c),class:"vuefinder__toolbar__radio"},null,512),[[e.vModelRadio,p.value.filterKind]]),e.createElementVNode("span",bs,e.toDisplayString(e.unref(o)("All items")),1)]),e.createElementVNode("label",Es,[e.withDirectives(e.createElementVNode("input",{type:"radio",name:"filterKind",value:"files","onUpdate:modelValue":h[11]||(h[11]=c=>p.value.filterKind=c),class:"vuefinder__toolbar__radio"},null,512),[[e.vModelRadio,p.value.filterKind]]),e.createElementVNode("span",Vs,e.toDisplayString(e.unref(o)("Files only")),1)]),e.createElementVNode("label",Ns,[e.withDirectives(e.createElementVNode("input",{type:"radio",name:"filterKind",value:"folders","onUpdate:modelValue":h[12]||(h[12]=c=>p.value.filterKind=c),class:"vuefinder__toolbar__radio"},null,512),[[e.vModelRadio,p.value.filterKind]]),e.createElementVNode("span",Ss,e.toDisplayString(e.unref(o)("Folders only")),1)])])]),e.createElementVNode("div",Bs,[e.createElementVNode("label",Cs,e.toDisplayString(e.unref(o)("Show hidden files")),1),e.withDirectives(e.createElementVNode("input",{type:"checkbox",id:"showHidden","onUpdate:modelValue":h[13]||(h[13]=c=>p.value.showHidden=c),class:"vuefinder__toolbar__checkbox"},null,512),[[e.vModelCheckbox,p.value.showHidden]])]),e.createElementVNode("div",xs,[e.createElementVNode("button",{onClick:g,class:"vuefinder__toolbar__reset-button"},e.toDisplayString(e.unref(o)("Reset")),1)])])])):e.createCommentVNode("",!0)]),e.unref(t).features.includes(e.unref(z).FULL_SCREEN)?(e.openBlock(),e.createElementBlock("div",{key:0,onClick:h[14]||(h[14]=c=>e.unref(l).toggle("fullScreen")),class:"mx-1.5",title:e.unref(o)("Toggle Full Screen")},[e.unref(a).fullScreen?(e.openBlock(),e.createBlock(e.unref(Fa),{key:0})):(e.openBlock(),e.createBlock(e.unref(Da),{key:1}))],8,$s)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"mx-1.5",title:e.unref(o)("Change View"),onClick:h[15]||(h[15]=c=>e.unref(f).query.length||E())},[e.unref(a).view==="grid"?(e.openBlock(),e.createBlock(e.unref(Ia),{key:0,class:e.normalizeClass(["vf-toolbar-icon",e.unref(f).query.length?"vf-toolbar-icon-disabled":""])},null,8,["class"])):e.createCommentVNode("",!0),e.unref(a).view==="list"?(e.openBlock(),e.createBlock(e.unref(za),{key:1,class:e.normalizeClass(["vf-toolbar-icon",e.unref(f).query.length?"vf-toolbar-icon-disabled":""])},null,8,["class"])):e.createCommentVNode("",!0)],8,Ds)])]))}}),Ts=(n,t=0,o=!1)=>{let r;return(...l)=>{o&&!r&&n(...l),clearTimeout(r),r=setTimeout(()=>{n(...l)},t)}},je=(n,t,o)=>{const r=e.ref(n);return e.customRef((l,d)=>({get(){return l(),r.value},set:Ts(a=>{r.value=a,d()},t,!1)}))},Fs={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-300 dark:text-neutral-200 dark:hover:bg-gray-700 cursor-pointer",viewBox:"-40 -40 580 580"};function As(n,t){return e.openBlock(),e.createElementBlock("svg",Fs,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M463.5 224h8.5c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2S461.9 48.1 455 55l-41.6 41.6c-87.6-86.5-228.7-86.2-315.8 1-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2S334.3 224 344 224z"},null,-1)])])}const Ls={render:As},Is={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-0.5 rounded",viewBox:"0 0 20 20"};function Rs(n,t){return e.openBlock(),e.createElementBlock("svg",Is,[...t[0]||(t[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M5.293 9.707a1 1 0 0 1 0-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L11 7.414V15a1 1 0 1 1-2 0V7.414L6.707 9.707a1 1 0 0 1-1.414 0",class:"pointer-events-none","clip-rule":"evenodd"},null,-1)])])}const Ps={render:Rs},zs={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-300 dark:text-neutral-200 dark:hover:bg-gray-700 cursor-pointer",viewBox:"0 0 24 24"};function Hs(n,t){return e.openBlock(),e.createElementBlock("svg",zs,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Os={render:Hs},qs={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-100 dark:text-neutral-300 dark:hover:bg-gray-800 cursor-pointer",viewBox:"0 0 20 20"};function Us(n,t){return e.openBlock(),e.createElementBlock("svg",qs,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M10.707 2.293a1 1 0 0 0-1.414 0l-7 7a1 1 0 0 0 1.414 1.414L4 10.414V17a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-6.586l.293.293a1 1 0 0 0 1.414-1.414z",class:"pointer-events-none"},null,-1)])])}const js={render:Us},Ks={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 m-auto stroke-gray-400 fill-gray-100 dark:stroke-gray-400 dark:fill-gray-400/20",viewBox:"0 0 20 20"};function Gs(n,t){return e.openBlock(),e.createElementBlock("svg",Ks,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607"},null,-1)])])}const Ys={render:Gs},Ws={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"w-6 h-6 cursor-pointer",viewBox:"0 0 24 24"};function Xs(n,t){return e.openBlock(),e.createElementBlock("svg",Ws,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Qs={render:Xs},Js={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-6 w-6 p-1 rounded text-slate-700 dark:text-neutral-300 cursor-pointer",viewBox:"0 0 24 24"};function Zs(n,t){return e.openBlock(),e.createElementBlock("svg",Js,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M9 6h11M12 12h8M15 18h5M5 6v.01M8 12v.01M11 18v.01"},null,-1)])])}const ei={render:Zs},ti={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 448 512"};function oi(n,t){return e.openBlock(),e.createElementBlock("svg",ti,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M8 256a56 56 0 1 1 112 0 56 56 0 1 1-112 0m160 0a56 56 0 1 1 112 0 56 56 0 1 1-112 0m216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112"},null,-1)])])}const ni={render:oi};function ri(n){const[t,o]=li(n);if(!o||o==="/")return t+"://";const r=o.replace(/\/+$/,""),l=r.lastIndexOf("/");return l===0?t+"://":t+":/"+r.slice(0,l)}function li(n){const t=n.indexOf(":/");return t===-1?[void 0,n]:[n.slice(0,t),n.slice(t+2)||"/"]}function he(n,t=[]){const o="vfDragEnterCounter",r=n.fs,l=D.useStore(r.selectedItems);function d(i,u){i.preventDefault(),r.getDraggedItem()===u.path||!u||u.type!=="dir"||l.value.some(p=>p.path===u.path||ri(p.path)===u.path)?i.dataTransfer&&(i.dataTransfer.dropEffect="none",i.dataTransfer.effectAllowed="none"):(i.dataTransfer&&(i.dataTransfer.dropEffect="copy",i.dataTransfer.effectAllowed="all"),i.currentTarget.classList.add(...t))}function a(i){i.preventDefault();const u=i.currentTarget,_=Number(u.dataset[o]||0);u.dataset[o]=String(_+1)}function f(i){i.preventDefault();const u=i.currentTarget,p=Number(u.dataset[o]||0)-1;p<=0?(delete u.dataset[o],u.classList.remove(...t)):u.dataset[o]=String(p)}function s(i,u){if(!u)return;i.preventDefault();const _=i.currentTarget;delete _.dataset[o],_.classList.remove(...t);const p=i.dataTransfer?.getData("items")||"[]",k=JSON.parse(p).map(g=>r.sortedFiles.get().find(v=>v.path===g));r.clearDraggedItem(),n.modal.open(ie,{items:{from:k,to:u}})}function m(i){return{dragover:u=>d(u,i),dragenter:a,dragleave:f,drop:u=>s(u,i)}}return{events:m}}const ai={class:"vuefinder__breadcrumb__container"},si=["title"],ii=["title"],ci=["title"],di=["title"],ui={class:"vuefinder__breadcrumb__list"},mi={key:0,class:"vuefinder__breadcrumb__hidden-list"},fi={class:"relative"},vi=["title","onClick"],_i={class:"vuefinder__breadcrumb__search-mode"},pi=["placeholder"],hi=["onClick"],gi={class:"vuefinder__breadcrumb__hidden-item-content"},ki={class:"vuefinder__breadcrumb__hidden-item-text"},wi=e.defineComponent({__name:"Breadcrumb",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.search,l=t.fs,d=t.config,a=D.useStore(d.state),f=D.useStore(r.state),s=D.useStore(l.path),m=D.useStore(l.loading),i=e.computed(()=>f.value?.searchMode??!1),u=e.ref(null),_=je(0,100),p=e.ref(5),E=e.ref(!1),k=e.computed(()=>s.value?.breadcrumb??[]);function g(M,F){return M.length>F?[M.slice(-F),M.slice(0,-F)]:[M,[]]}const v=e.computed(()=>g(k.value,p.value)[0]),h=e.computed(()=>g(k.value,p.value)[1]);e.watch(_,()=>{if(!u.value)return;const M=u.value.children;let F=0,P=0;const j=5,Z=1;p.value=j,e.nextTick(()=>{for(let te=M.length-1;te>=0;te--){const re=M[te];if(F+re.offsetWidth>_.value-40)break;F+=parseInt(re.offsetWidth.toString(),10),P++}P<Z&&(P=Z),P>j&&(P=j),p.value=P})});const c=()=>{u.value&&(_.value=u.value.offsetWidth)},y=e.ref(null);e.onMounted(()=>{y.value=new ResizeObserver(c),u.value&&y.value.observe(u.value)}),e.onUnmounted(()=>{y.value&&y.value.disconnect()});const N=he(t,["bg-blue-200","dark:bg-slate-600"]);function $(M=null){M??=k.value.length-2;const F={basename:s.value?.storage??"local",extension:"",path:(s.value?.storage??"local")+"://",storage:s.value?.storage??"local",type:"dir",file_size:null,last_modified:null,mime_type:null,visibility:""};return k.value[M]??F}const q=()=>{V()},H=()=>{r.exitSearchMode(),v.value.length>0&&!i.value&&t.emitter.emit("vf-fetch",{params:{q:"index",storage:s.value?.storage??"local",path:k.value[k.value.length-2]?.path??(s.value?.storage??"local")+"://"}})},R=M=>{t.emitter.emit("vf-fetch",{params:{q:"index",storage:s.value?.storage,path:M.path}}),E.value=!1},U=()=>{E.value&&(E.value=!1)},K={mounted(M,F){M.clickOutsideEvent=function(P){M===P.target||M.contains(P.target)||F.value()},document.body.addEventListener("click",M.clickOutsideEvent)},beforeUnmount(M){document.body.removeEventListener("click",M.clickOutsideEvent)}},Q=()=>{d.toggle("showTreeView")},C=e.ref(null),A=je("",400);e.watch(A,M=>{t.emitter.emit("vf-toast-clear"),r.setQuery(M)}),r.state.listen(M=>{A.value=M?.query??""}),e.watch(i,M=>{M&&e.nextTick(()=>{C.value&&C.value.focus()})}),t.emitter.on("vf-search-exit",()=>{r.exitSearchMode()});const S=()=>{A.value===""&&r.exitSearchMode()},V=()=>{r.exitSearchMode(),t.emitter.emit("vf-fetch",{params:{q:"index",storage:s.value.storage,path:s.value.path}})},b=e.ref({x:0,y:0}),I=(M,F=null)=>{if(M.currentTarget instanceof HTMLElement){const{x:P,y:j,height:Z}=M.currentTarget.getBoundingClientRect();b.value={x:P,y:j+Z}}E.value=F??!E.value};return(M,F)=>(e.openBlock(),e.createElementBlock("div",ai,[e.createElementVNode("span",{title:e.unref(o)("Toggle Tree View")},[e.createVNode(e.unref(ei),{onClick:Q,class:e.normalizeClass(["vuefinder__breadcrumb__toggle-tree",e.unref(a).showTreeView?"vuefinder__breadcrumb__toggle-tree--active":""])},null,8,["class"])],8,si),e.createElementVNode("span",{title:e.unref(o)("Go up a directory")},[e.createVNode(e.unref(Ps),e.mergeProps(e.toHandlers(k.value.length&&!i.value?e.unref(N).events($()):{}),{onClick:H,class:k.value.length&&!i.value?"vuefinder__breadcrumb__go-up--active":"vuefinder__breadcrumb__go-up--inactive"}),null,16,["class"])],8,ii),e.unref(l).isLoading()?(e.openBlock(),e.createElementBlock("span",{key:1,title:e.unref(o)("Cancel")},[e.createVNode(e.unref(Os),{onClick:F[0]||(F[0]=P=>e.unref(t).emitter.emit("vf-fetch-abort"))})],8,di)):(e.openBlock(),e.createElementBlock("span",{key:0,title:e.unref(o)("Refresh")},[e.createVNode(e.unref(Ls),{onClick:q})],8,ci)),e.withDirectives(e.createElementVNode("div",{class:"group vuefinder__breadcrumb__search-container",onClick:F[3]||(F[3]=(...P)=>e.unref(r).enterSearchMode&&e.unref(r).enterSearchMode(...P))},[e.createElementVNode("div",null,[e.createVNode(e.unref(js),e.mergeProps(e.toHandlers(e.unref(N).events($(-1))),{onClick:F[1]||(F[1]=e.withModifiers(P=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:e.unref(s).storage??"local"}}),["stop"]))}),null,16)]),e.createElementVNode("div",ui,[h.value.length?e.withDirectives((e.openBlock(),e.createElementBlock("div",mi,[F[5]||(F[5]=e.createElementVNode("div",{class:"vuefinder__breadcrumb__separator"},"/",-1)),e.createElementVNode("div",fi,[e.createElementVNode("span",{onDragenter:F[2]||(F[2]=P=>I(P,!0)),onClick:e.withModifiers(I,["stop"]),class:"vuefinder__breadcrumb__hidden-toggle"},[e.createVNode(e.unref(ni),{class:"vuefinder__breadcrumb__hidden-toggle-icon"})],32)])])),[[K,U]]):e.createCommentVNode("",!0)]),e.createElementVNode("div",{ref_key:"breadcrumbContainer",ref:u,class:"vuefinder__breadcrumb__visible-list pointer-events-none"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,(P,j)=>(e.openBlock(),e.createElementBlock("div",{key:j},[F[6]||(F[6]=e.createElementVNode("span",{class:"vuefinder__breadcrumb__separator"},"/",-1)),e.createElementVNode("span",e.mergeProps(e.toHandlers(e.unref(N).events(P),!0),{class:"vuefinder__breadcrumb__item pointer-events-auto",title:P.basename,onClick:e.withModifiers(Z=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:e.unref(s).storage,path:P.path}}),["stop"])}),e.toDisplayString(P.name),17,vi)]))),128))],512),e.unref(d).get("loadingIndicator")==="circular"&&e.unref(m)?(e.openBlock(),e.createBlock(e.unref(qe),{key:0})):e.createCommentVNode("",!0)],512),[[e.vShow,!i.value]]),e.withDirectives(e.createElementVNode("div",_i,[e.createElementVNode("div",null,[e.createVNode(e.unref(Ys))]),e.withDirectives(e.createElementVNode("input",{ref_key:"searchInput",ref:C,onKeydown:e.withKeys(V,["esc"]),onBlur:S,"onUpdate:modelValue":F[4]||(F[4]=P=>e.isRef(A)?A.value=P:null),placeholder:e.unref(o)("Search anything.."),class:"vuefinder__breadcrumb__search-input",type:"text"},null,40,pi),[[e.vModelText,e.unref(A)]]),e.createVNode(e.unref(Qs),{onClick:V})],512),[[e.vShow,i.value]]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(t).theme.actualValue)},[e.withDirectives(e.createElementVNode("div",{style:e.normalizeStyle({position:"absolute",top:b.value.y+"px",left:b.value.x+"px"}),class:"vuefinder vuefinder__breadcrumb__hidden-dropdown"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(P,j)=>(e.openBlock(),e.createElementBlock("div",e.mergeProps({key:j},e.toHandlers(e.unref(N).events(P),!0),{onClick:Z=>R(P),class:"vuefinder__breadcrumb__hidden-item"}),[e.createElementVNode("div",gi,[e.createElementVNode("span",null,[e.createVNode(e.unref(ce),{class:"vuefinder__breadcrumb__hidden-item-icon"})]),F[7]||(F[7]=e.createTextVNode()),e.createElementVNode("span",ki,e.toDisplayString(P.name),1)])],16,hi))),128))],4),[[e.vShow,E.value]])],2)]))]))}});function yi(n,t){const{scrollContainer:o,itemWidth:r=100,rowHeight:l,overscan:d=2,containerPadding:a=48,lockItemsPerRow:f}=t,s=n,m=()=>typeof l=="number"?l:l.value,i=e.ref(0),u=e.ref(6),_=e.ref(600);let p=null;const E=e.computed(()=>Math.ceil(s.value.length/u.value)),k=e.computed(()=>E.value*m()),g=e.computed(()=>{const R=m(),U=Math.max(0,Math.floor(i.value/R)-d),K=Math.min(E.value,Math.ceil((i.value+_.value)/R)+d);return{start:U,end:K}}),v=e.computed(()=>{const{start:R,end:U}=g.value;return Array.from({length:U-R},(K,Q)=>R+Q)}),h=()=>_.value,c=()=>f.value,y=()=>{if(c()){u.value=1;return}if(o.value){const R=o.value.clientWidth-a;u.value=Math.max(Math.floor(R/r),2)}},N=R=>{const U=R.target;i.value=U.scrollTop};e.watch(()=>s.value.length,()=>{y()});const $=(R,U)=>{const K=U*u.value;return R.slice(K,K+u.value)},q=(R,U,K,Q,C)=>{const A=[];for(let S=U;S<=K;S++)for(let V=Q;V<=C;V++){const b=S*u.value+V;b<R.length&&R[b]&&A.push(R[b])}return A},H=R=>({row:Math.floor(R/u.value),col:R%u.value});return e.onMounted(async()=>{await e.nextTick(),o.value&&(_.value=o.value.clientHeight||600),y(),window.addEventListener("resize",()=>{o.value&&(_.value=o.value.clientHeight||600),y()}),o.value&&"ResizeObserver"in window&&(p=new ResizeObserver(R=>{const U=R[0];U&&(_.value=Math.round(U.contentRect.height)),y()}),p.observe(o.value))}),e.onUnmounted(()=>{window.removeEventListener("resize",y),p&&(p.disconnect(),p=null)}),{scrollTop:i,itemsPerRow:u,totalRows:E,totalHeight:k,visibleRange:g,visibleRows:v,updateItemsPerRow:y,handleScroll:N,getRowItems:$,getItemsInRange:q,getItemPosition:H,getContainerHeight:h}}function bi(n){const{getItemPosition:t,getItemsInRange:o,getKey:r,selectionObject:l,rowHeight:d,itemWidth:a}=n,f=Math.floor(Math.random()*2**32).toString(),s=e.inject("ServiceContainer"),m=s.fs,i=D.useStore(m.selectedKeys),u=D.useStore(m.sortedFiles),_=e.ref(new Set),p=e.ref(!1),E=e.ref(!1),k=e.ref(null),g=C=>C.map(A=>A.getAttribute("data-key")).filter(A=>!!A),v=C=>{C.selection.getSelection().forEach(A=>{C.selection.deselect(A,!0)})},h=C=>{i.value&&i.value.forEach(A=>{const S=document.querySelector(`[data-key="${A}"]`);S&&C.selection.select(S,!0)})},c=C=>{if(C.size===0)return null;const S=Array.from(C).map(F=>{const P=u.value?.findIndex(j=>r(j)===F)??-1;return t(P>=0?P:0)}),V=Math.min(...S.map(F=>F.row)),b=Math.max(...S.map(F=>F.row)),I=Math.min(...S.map(F=>F.col)),M=Math.max(...S.map(F=>F.col));return{minRow:V,maxRow:b,minCol:I,maxCol:M}},y=C=>{if(s.selectionMode==="single")return!1;p.value=!1,!C.event?.metaKey&&!C.event?.ctrlKey&&(E.value=!0),C.selection.resolveSelectables(),v(C),h(C)},N=({event:C,selection:A})=>{if(s.selectionMode==="single")return;const S=C;S&&"type"in S&&S.type==="touchend"&&S.preventDefault();const V=C;if(!V?.ctrlKey&&!V?.metaKey&&(m.clearSelection(),A.clearSelection(!0,!0)),_.value.clear(),V&&l.value){const b=l.value.getSelectables()[0]?.closest(".scroller-"+f);if(b){const I=b.getBoundingClientRect(),M=V.clientY-I.top+b.scrollTop,F=V.clientX-I.left,P=Math.floor(M/d.value),j=Math.floor(F/a);k.value={row:P,col:j}}}},$=C=>{if(s.selectionMode==="single")return;const A=C.selection,S=g(C.store.changed.added),V=g(C.store.changed.removed);E.value=!1,p.value=!0,S.forEach(b=>{i.value&&!i.value.has(b)&&_.value.add(b),m.select(b,s.selectionMode||"multiple")}),V.forEach(b=>{document.querySelector(`[data-key="${b}"]`)&&u.value?.find(M=>r(M)===b)&&_.value.delete(b),m.deselect(b)}),A.resolveSelectables(),h(C)},q=()=>{_.value.clear()},H=C=>{if(C.event&&k.value&&_.value.size>0){const S=Array.from(_.value).map(V=>{const b=u.value?.findIndex(I=>r(I)===V)??-1;return b>=0?t(b):null}).filter(V=>V!==null);if(S.length>0){const V=[...S,k.value],b={minRow:Math.min(...V.map(I=>I.row)),maxRow:Math.max(...V.map(I=>I.row)),minCol:Math.min(...V.map(I=>I.col)),maxCol:Math.max(...V.map(I=>I.col))};o(u.value||[],b.minRow,b.maxRow,b.minCol,b.maxCol).forEach(I=>{const M=r(I);document.querySelector(`[data-key="${M}"]`)||m.select(M,s.selectionMode||"multiple")})}}},R=C=>{H(C),v(C),h(C),m.setSelectedCount(i.value?.size||0),p.value=!1,k.value=null},U=()=>{l.value=new wt({selectables:[".file-item-"+f],boundaries:[".scroller-"+f],selectionContainerClass:"selection-area-container",behaviour:{overlap:"invert",intersect:"touch",startThreshold:0,triggers:[0],scrolling:{speedDivider:10,manualSpeed:750,startScrollMargins:{x:0,y:10}}},features:{touch:!0,range:!0,deselectOnBlur:!0,singleTap:{allow:!1,intersect:"native"}}}),l.value.on("beforestart",y),l.value.on("start",N),l.value.on("move",$),l.value.on("stop",R)},K=()=>{l.value&&(l.value.destroy(),l.value=null)},Q=C=>{E.value&&(l.value?.clearSelection(),q(),E.value=!1);const A=C;!_.value.size&&!E.value&&!A?.ctrlKey&&!A?.metaKey&&(m.clearSelection(),l.value?.clearSelection())};return e.onMounted(()=>{const C=A=>{!A.buttons&&p.value&&(p.value=!1)};document.addEventListener("dragleave",C),e.onUnmounted(()=>{document.removeEventListener("dragleave",C)})}),{isDragging:p,selectionStarted:E,explorerId:f,extractIds:g,cleanupSelection:v,refreshSelection:h,getSelectionRange:c,selectSelectionRange:H,initializeSelectionArea:U,destroySelectionArea:K,handleContentClick:Q}}const Ei={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 20 20"};function Vi(n,t){return e.openBlock(),e.createElementBlock("svg",Ei,[...t[0]||(t[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 0 1 1.414 0L10 10.586l3.293-3.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 0-1.414","clip-rule":"evenodd"},null,-1)])])}const Ni={render:Vi},Si={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 20 20"};function Bi(n,t){return e.openBlock(),e.createElementBlock("svg",Si,[...t[0]||(t[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 0 1-1.414 0L10 9.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1 0 1.414","clip-rule":"evenodd"},null,-1)])])}const Ci={render:Bi},we=e.defineComponent({__name:"SortIcon",props:{direction:{}},setup(n){return(t,o)=>(e.openBlock(),e.createElementBlock("div",null,[n.direction==="asc"?(e.openBlock(),e.createBlock(e.unref(Ni),{key:0})):e.createCommentVNode("",!0),n.direction==="desc"?(e.openBlock(),e.createBlock(e.unref(Ci),{key:1})):e.createCommentVNode("",!0)]))}}),xi={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"absolute h-6 w-6 md:h-12 md:w-12 m-auto stroke-neutral-500 fill-white dark:fill-gray-700 dark:stroke-gray-600 z-10",viewBox:"0 0 24 24"};function $i(n,t){return e.openBlock(),e.createElementBlock("svg",xi,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 0 0 2-2V9.414a1 1 0 0 0-.293-.707l-5.414-5.414A1 1 0 0 0 12.586 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"},null,-1)])])}const Di={render:$i},Mi={class:"vuefinder__drag-item__container"},Ti={class:"vuefinder__drag-item__count"},Fi=e.defineComponent({__name:"DragItem",props:{count:{}},setup(n){const t=n;return(o,r)=>(e.openBlock(),e.createElementBlock("div",Mi,[e.createVNode(e.unref(Di)),e.createElementVNode("div",Ti,e.toDisplayString(t.count),1)]))}}),Ai={key:2,class:"vuefinder__item-icon__extension"},Ke=e.defineComponent({__name:"ItemIcon",props:{item:{},ext:{type:Boolean},small:{type:Boolean}},setup(n){const t=n,o=e.inject("ServiceContainer"),r=D.useStore(o.config.state),l={app:o,config:r.value,item:t.item};return(d,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__item-icon",n.small?"vuefinder__item-icon--small":"vuefinder__item-icon--large"])},[e.renderSlot(d.$slots,"icon",e.normalizeProps(e.guardReactiveProps(l)),()=>[n.item.type==="dir"?(e.openBlock(),e.createBlock(e.unref(ce),{key:0,class:"vuefinder__item-icon__folder"})):(e.openBlock(),e.createBlock(e.unref(et),{key:1,class:"vuefinder__item-icon__file"})),n.ext&&n.item.type!=="dir"&&n.item.extension?(e.openBlock(),e.createElementBlock("div",Ai,e.toDisplayString(n.item.extension.substring(0,3)),1)):e.createCommentVNode("",!0)])],2))}}),Li={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"};function Ii(n,t){return e.openBlock(),e.createElementBlock("svg",Li,[...t[0]||(t[0]=[e.createElementVNode("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M12 2a5 5 0 0 1 5 5v3a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3v-6a3 3 0 0 1 3-3V7a5 5 0 0 1 5-5m0 12a2 2 0 0 0-1.995 1.85L10 16a2 2 0 1 0 2-2m0-10a3 3 0 0 0-3 3v3h6V7a3 3 0 0 0-3-3"},null,-1)])])}const Ge={render:Ii},Ri=["data-key","data-row","data-col","draggable"],Pi={key:0},zi={class:"vuefinder__explorer__item-grid-content"},Hi=["data-src","alt"],Oi={class:"vuefinder__explorer__item-title"},qi={key:1,class:"vuefinder__explorer__item-list-content"},Ui={class:"vuefinder__explorer__item-list-name"},ji={class:"vuefinder__explorer__item-list-icon"},Ki={class:"vuefinder__explorer__item-name"},Gi={key:0,class:"vuefinder__explorer__item-path"},Yi={key:1,class:"vuefinder__explorer__item-size"},Wi={key:0},Xi={key:2,class:"vuefinder__explorer__item-date"},Qi=e.defineComponent({__name:"FileItem",props:{item:{},view:{},compact:{type:Boolean},showThumbnails:{type:Boolean},isSelected:{type:Boolean},isDragging:{type:Boolean},rowIndex:{},colIndex:{},showPath:{type:Boolean},explorerId:{}},emits:["click","dblclick","contextmenu","dragstart","dragend"],setup(n,{emit:t}){const o=n,r=t,l=e.inject("ServiceContainer"),d=l.fs,a=l.config,f=e.computed(()=>["file-item-"+o.explorerId,o.view==="grid"?"vf-explorer-item-grid":"vf-explorer-item-list",o.isSelected?"vf-explorer-selected":""]),s=e.computed(()=>({opacity:o.isDragging||d.isCut(o.item.path)?.5:""}));let m=null;const i=e.ref(null);let u=!1;const _=()=>{m&&clearTimeout(m),p.value=!0},p=e.ref(!0),E=k=>{if(p.value=!1,m&&(k.preventDefault(),clearTimeout(m)),!u)u=!0,r("click",k),i.value=setTimeout(()=>{u=!1},300);else return u=!1,r("dblclick",k),m&&clearTimeout(m),!1;if(k.currentTarget&&k.currentTarget instanceof HTMLElement){const g=k.currentTarget.getBoundingClientRect();k.preventDefault(),m=setTimeout(()=>{let c=g.y+g.height;c+146>window.innerHeight-10&&(c=g.y-146),c<10&&(c=10);const y=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2,buttons:0,clientX:g.x,clientY:c});k.target?.dispatchEvent(y)},300)}};return(k,g)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(f.value),style:e.normalizeStyle(s.value),"data-key":n.item.path,"data-row":n.rowIndex,"data-col":n.colIndex,draggable:p.value,onTouchstart:g[1]||(g[1]=v=>E(v)),onTouchend:g[2]||(g[2]=v=>_()),onClick:g[3]||(g[3]=v=>r("click",v)),onDblclick:g[4]||(g[4]=v=>r("dblclick",v)),onContextmenu:g[5]||(g[5]=e.withModifiers(v=>r("contextmenu",v),["prevent","stop"])),onDragstart:g[6]||(g[6]=v=>r("dragstart",v)),onDragend:g[7]||(g[7]=v=>r("dragend",v))},[n.view==="grid"?(e.openBlock(),e.createElementBlock("div",Pi,[e.unref(d).isReadOnly(n.item)?(e.openBlock(),e.createBlock(e.unref(Ge),{key:0,class:"vuefinder__item--readonly vuefinder__item--readonly--left",title:"Read Only"})):e.createCommentVNode("",!0),e.createElementVNode("div",zi,[(n.item.mime_type??"").startsWith("image")&&n.showThumbnails?(e.openBlock(),e.createElementBlock("img",{key:0,onTouchstart:g[0]||(g[0]=v=>v.preventDefault()),src:"data:image/png;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"vuefinder__explorer__item-thumbnail lazy","data-src":e.unref(l).requester.getPreviewUrl(n.item.storage,n.item),alt:n.item.basename},null,40,Hi)):(e.openBlock(),e.createBlock(Ke,{key:1,item:n.item,ext:!0},{icon:e.withCtx(v=>[e.renderSlot(k.$slots,"icon",e.normalizeProps(e.guardReactiveProps(v)))]),_:3},8,["item"]))]),e.createElementVNode("span",Oi,e.toDisplayString(e.unref(Me)(n.item.basename)),1)])):(e.openBlock(),e.createElementBlock("div",qi,[e.createElementVNode("div",Ui,[e.createElementVNode("div",ji,[e.createVNode(Ke,{item:n.item,small:n.compact},{icon:e.withCtx(v=>[e.renderSlot(k.$slots,"icon",e.normalizeProps(e.guardReactiveProps(v)))]),_:3},8,["item","small"])]),e.createElementVNode("span",Ki,e.toDisplayString(n.item.basename),1),e.createElementVNode("div",null,[e.unref(d).isReadOnly(n.item)?(e.openBlock(),e.createBlock(e.unref(Ge),{key:0,class:"vuefinder__item--readonly vuefinder__item--readonly--list",title:"Read Only"})):e.createCommentVNode("",!0)])]),n.showPath?(e.openBlock(),e.createElementBlock("div",Gi,e.toDisplayString(n.item.path),1)):e.createCommentVNode("",!0),n.showPath?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Yi,[n.item.file_size?(e.openBlock(),e.createElementBlock("div",Wi,e.toDisplayString(e.unref(l).filesize(n.item.file_size)),1)):e.createCommentVNode("",!0)])),!n.showPath&&n.item.last_modified?(e.openBlock(),e.createElementBlock("div",Xi,e.toDisplayString(new Date(n.item.last_modified*1e3).toLocaleString()),1)):e.createCommentVNode("",!0)])),e.unref(a).get("pinnedFolders").find(v=>v.path===n.item.path)?(e.openBlock(),e.createBlock(e.unref(Ae),{key:2,class:"vuefinder__item--pinned"})):e.createCommentVNode("",!0)],46,Ri))}}),Ji=["data-row"],De=e.defineComponent({__name:"FileRow",props:{rowIndex:{},rowHeight:{},view:{},itemsPerRow:{},items:{},compact:{type:Boolean},showThumbnails:{type:Boolean},showPath:{type:Boolean},isDraggingItem:{type:Function},isSelected:{type:Function},dragNDropEvents:{type:Function},explorerId:{}},emits:["click","dblclick","contextmenu","dragstart","dragend"],setup(n,{emit:t}){const o=n,r=t,l=e.computed(()=>[o.view==="grid"?"vf-explorer-item-grid-row":"vf-explorer-item-list-row","pointer-events-none"]),d=e.computed(()=>({position:"absolute",top:0,left:0,width:"100%",height:`${o.rowHeight}px`,transform:`translateY(${o.rowIndex*o.rowHeight}px)`})),a=e.computed(()=>o.view==="grid"?{gridTemplateColumns:`repeat(${o.itemsPerRow||1}, 1fr)`}:{gridTemplateColumns:"1fr"});return(f,s)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(l.value),"data-row":n.rowIndex,style:e.normalizeStyle(d.value)},[e.createElementVNode("div",{class:e.normalizeClass(["grid justify-self-start",{"w-full":n.view==="list"}]),style:e.normalizeStyle(a.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.items,(m,i)=>(e.openBlock(),e.createBlock(Qi,e.mergeProps({key:m.path,item:m,view:n.view,compact:n.compact,"show-thumbnails":n.showThumbnails,"show-path":n.showPath,"is-selected":n.isSelected(m.path),"is-dragging":n.isDraggingItem(m.path),"row-index":n.rowIndex,"col-index":i},e.toHandlers(n.dragNDropEvents(m)),{onClick:s[0]||(s[0]=u=>r("click",u)),onDblclick:s[1]||(s[1]=u=>r("dblclick",u)),onContextmenu:s[2]||(s[2]=u=>r("contextmenu",u)),onDragstart:s[3]||(s[3]=u=>r("dragstart",u)),onDragend:s[4]||(s[4]=u=>r("dragend",u)),explorerId:n.explorerId}),{icon:e.withCtx(u=>[e.renderSlot(f.$slots,"icon",e.mergeProps({ref_for:!0},u))]),_:3},16,["item","view","compact","show-thumbnails","show-path","is-selected","is-dragging","row-index","col-index","explorerId"]))),128))],6)],14,Ji))}}),Zi=["onClick"],ec=e.defineComponent({__name:"Toast",setup(n){const t=e.inject("ServiceContainer"),{getStore:o}=t.storage,r=e.ref(o("full-screen",!1)),l=e.ref([]),d=s=>s==="error"?"text-red-400 border-red-400 dark:text-red-300 dark:border-red-300":"text-lime-600 border-lime-600 dark:text-lime-300 dark:border-lime-1300",a=s=>{l.value.splice(s,1)},f=s=>{let m=l.value.findIndex(i=>i.id===s);m!==-1&&a(m)};return t.emitter.on("vf-toast-clear",()=>{l.value=[]}),t.emitter.on("vf-toast-push",s=>{let m=new Date().getTime().toString(36).concat(performance.now().toString(),Math.random().toString()).replace(/\./g,"");s.id=m,l.value.push(s),setTimeout(()=>{f(m)},5e3)}),(s,m)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__toast",r.value.value?"vuefinder__toast--fixed":"vuefinder__toast--absolute"])},[e.createVNode(e.TransitionGroup,{name:"vuefinder__toast-item","enter-active-class":"vuefinder__toast-item--enter-active","leave-active-class":"vuefinder__toast-item--leave-active","leave-to-class":"vuefinder__toast-item--leave-to"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,(i,u)=>(e.openBlock(),e.createElementBlock("div",{key:u,onClick:_=>a(u),class:e.normalizeClass(["vuefinder__toast__message",d(i.type)])},e.toDisplayString(i.label),11,Zi))),128))]),_:1})],2))}}),tc={class:"vuefinder__explorer__container"},oc={ref:"customScrollBar",class:"vuefinder__explorer__scrollbar"},nc={key:0,class:"vuefinder__explorer__header"},rc={key:0,class:"vuefinder__linear-loader"},lc=e.defineComponent({__name:"Explorer",props:{onFileDclick:{type:Function},onFolderDclick:{type:Function}},setup(n){const t=n,o=e.inject("ServiceContainer"),r=he(o,["bg-blue-200","dark:bg-slate-600"]),l=e.useTemplateRef("dragImage"),d=e.shallowRef(null),a=e.useTemplateRef("scrollContainer"),f=e.useTemplateRef("scrollContent"),s=o.search,m=o.fs,i=o.config,u=D.useStore(i.state),_=D.useStore(s.state),p=D.useStore(m.sort),E=D.useStore(m.sortedFiles),k=D.useStore(m.selectedKeys),g=D.useStore(m.loading),v=e.computed(()=>_.value.query.length>0),h=x=>k.value?.has(x)??!1;let c=null;const y=e.ref(null),N=e.useTemplateRef("customScrollBar"),$=e.useTemplateRef("customScrollBarContainer"),q=e.computed(()=>{const x=u.value.view,L=u.value.compactListView;return x==="grid"&&!(_.value.searchMode&&_.value.query.length)?88:L?24:50}),{t:H}=o.i18n,{itemsPerRow:R,totalHeight:U,visibleRows:K,handleScroll:Q,getRowItems:C,getItemsInRange:A,getItemPosition:S,updateItemsPerRow:V}=yi(e.computed(()=>E.value??[]),{scrollContainer:a,itemWidth:104,rowHeight:q,overscan:2,containerPadding:0,lockItemsPerRow:e.computed(()=>u.value.view==="list"||!!_.value.query.length)}),{explorerId:b,isDragging:I,initializeSelectionArea:M,destroySelectionArea:F,handleContentClick:P}=bi({getItemPosition:S,getItemsInRange:A,getKey:x=>x.path,selectionObject:d,rowHeight:q,itemWidth:104}),j=e.ref(null),Z=x=>{if(!x||!j.value)return!1;const L=k.value?.has(j.value)??!1;return I.value&&(L?k.value?.has(x)??!1:x===j.value)};e.watch(()=>i.get("view"),x=>{x==="list"?R.value=1:V()},{immediate:!0}),e.watch(R,x=>{i.get("view")==="list"&&x!==1&&(R.value=1)});const te=x=>E.value?.[x];e.onMounted(()=>{if(M(),d.value&&d.value.on("beforestart",({event:x})=>{const L=x?.target===f.value;if(!x?.metaKey&&!x?.ctrlKey&&!x?.altKey&&!L)return!1}),a.value&&(c=new Ye({elements_selector:".lazy",container:a.value})),e.watch(()=>_.value.query,x=>{const L=m.path.get().storage,w=m.path.get().path;!L||!w||x&&o.emitter.emit("vf-fetch",{params:{q:"search",storage:L,path:w,filter:x},onSuccess:B=>{B.files.length||o.emitter.emit("vf-toast-push",{label:H("No search result found.")})}})}),$.value){const x=ye.OverlayScrollbars($.value,{scrollbars:{theme:"vf-scrollbars-theme"}},{initialized:L=>{y.value=L},scroll:L=>{const{scrollOffsetElement:w}=L.elements();a.value&&a.value.scrollTo({top:w.scrollTop,left:0})}});y.value=x}a.value&&a.value.addEventListener("scroll",()=>{const x=y.value;if(!x)return;const{scrollOffsetElement:L}=x.elements();L.scrollTo({top:a.value.scrollTop,left:0})})}),e.onMounted(()=>{o.emitter.on("vf-refresh-thumbnails",()=>{c&&c.update()})}),e.onUpdated(()=>{if(c&&c.update(),y.value&&N.value&&a.value){const L=a.value.scrollHeight>a.value.clientHeight,w=N.value;w.style.display=L?"block":"none",w.style.height=`${U.value}px`}}),e.onUnmounted(()=>{F(),c&&(c.destroy(),c=null),y.value&&(y.value.destroy(),y.value=null)});const re=x=>{const L=x.target?.closest(".file-item-"+b),w=x;if(L){const B=String(L.getAttribute("data-key")),T=o.selectionMode||"multiple";!w?.ctrlKey&&!w?.metaKey&&(x.type!=="touchstart"||!m.isSelected(B))&&(m.clearSelection(),d.value?.clearSelection(!0,!0)),d.value?.resolveSelectables(),x.type==="touchstart"&&m.isSelected(B)?m.select(B,T):m.toggleSelect(B,T)}m.setSelectedCount(k.value?.size||0)},Se=x=>{if(x.type==="file"&&t.onFileDclick){o.emitter.emit("vf-file-dclick",x);return}if(x.type==="dir"&&t.onFolderDclick){o.emitter.emit("vf-folder-dclick",x);return}const L=o.contextMenuItems.find(w=>w.show(o,{searchQuery:"",items:[x],target:x}));L&&L.action(o,[x])},de=x=>{const L=x.target?.closest(".file-item-"+b),w=L?String(L.getAttribute("data-key")):null;if(!w)return;const B=E.value?.find(T=>T.path===w);B&&Se(B)},ge=()=>{const x=k.value;return E.value?.filter(L=>x?.has(L.path))||[]},ue=x=>{x.preventDefault();const L=x.target?.closest(".file-item-"+b);if(L){const w=String(L.getAttribute("data-key")),B=E.value?.find(T=>T.path===w);k.value?.has(w)||(m.clearSelection(),m.select(w)),o.emitter.emit("vf-contextmenu-show",{event:x,items:ge(),target:B})}},Be=x=>{x.preventDefault(),o.emitter.emit("vf-contextmenu-show",{event:x,items:ge()})},me=x=>{if(x.altKey||x.ctrlKey||x.metaKey)return x.preventDefault(),!1;I.value=!0;const L=x.target?.closest(".file-item-"+b);if(j.value=L?String(L.dataset.key):null,x.dataTransfer&&j.value){x.dataTransfer.setDragImage(l.value,0,15),x.dataTransfer.effectAllowed="all",x.dataTransfer.dropEffect="copy";const w=k.value?.has(j.value)?Array.from(k.value):[j.value];x.dataTransfer.setData("items",JSON.stringify(w)),m.setDraggedItem(j.value)}},ke=()=>{j.value=null};return(x,L)=>(e.openBlock(),e.createElementBlock("div",tc,[e.createElementVNode("div",{ref:"customScrollBarContainer",class:e.normalizeClass(["vuefinder__explorer__scrollbar-container",[{"grid-view":e.unref(u).view==="grid"},{"search-active":v.value}]])},[e.createElementVNode("div",oc,null,512)],2),e.unref(u).view==="list"||v.value?(e.openBlock(),e.createElementBlock("div",nc,[e.createElementVNode("div",{onClick:L[0]||(L[0]=w=>e.unref(m).toggleSort("basename")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--name vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(H)("Name"))+" ",1),e.withDirectives(e.createVNode(we,{direction:e.unref(p).order},null,8,["direction"]),[[e.vShow,e.unref(p).active&&e.unref(p).column==="basename"]])]),v.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,onClick:L[1]||(L[1]=w=>e.unref(m).toggleSort("file_size")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--size vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(H)("Size"))+" ",1),e.withDirectives(e.createVNode(we,{direction:e.unref(p).order},null,8,["direction"]),[[e.vShow,e.unref(p).active&&e.unref(p).column==="file_size"]])])),v.value?(e.openBlock(),e.createElementBlock("div",{key:1,onClick:L[2]||(L[2]=w=>e.unref(m).toggleSort("path")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--path vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(H)("Filepath"))+" ",1),e.withDirectives(e.createVNode(we,{direction:e.unref(p).order},null,8,["direction"]),[[e.vShow,e.unref(p).active&&e.unref(p).column==="path"]])])):e.createCommentVNode("",!0),v.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:2,onClick:L[3]||(L[3]=w=>e.unref(m).toggleSort("last_modified")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--date vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(H)("Date"))+" ",1),e.withDirectives(e.createVNode(we,{direction:e.unref(p).order},null,8,["direction"]),[[e.vShow,e.unref(p).active&&e.unref(p).column==="last_modified"]])]))])):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContainer",ref:a,class:e.normalizeClass(["vuefinder__explorer__selector-area","scroller-"+e.unref(b)]),onScroll:L[5]||(L[5]=(...w)=>e.unref(Q)&&e.unref(Q)(...w))},[e.unref(i).get("loadingIndicator")==="linear"&&e.unref(g)?(e.openBlock(),e.createElementBlock("div",rc)):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContent",ref:f,class:"scrollContent min-h-full",style:e.normalizeStyle({height:`${e.unref(U)}px`,position:"relative",width:"100%"}),onContextmenu:e.withModifiers(Be,["self","prevent"]),onClick:L[4]||(L[4]=e.withModifiers((...w)=>e.unref(P)&&e.unref(P)(...w),["self"]))},[e.createElementVNode("div",{ref_key:"dragImage",ref:l,class:"vuefinder__explorer__drag-item"},[e.createVNode(Fi,{count:j.value&&e.unref(k)?.has(j.value)?e.unref(k)?.size:1},null,8,["count"])],512),e.unref(_).query.length?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(K),w=>(e.openBlock(),e.createBlock(De,{key:w,"row-index":w,"row-height":q.value,view:"list",items:te(w)?[te(w)]:[],compact:e.unref(u).compactListView,"show-path":!0,"is-dragging-item":Z,"is-selected":h,"drag-n-drop-events":B=>e.unref(r).events(B),explorerId:e.unref(b),onClick:re,onDblclick:de,onContextmenu:ue,onDragstart:me,onDragend:ke},{icon:e.withCtx(B=>[e.renderSlot(x.$slots,"icon",e.mergeProps({ref_for:!0},B))]),_:3},8,["row-index","row-height","items","compact","drag-n-drop-events","explorerId"]))),128)):e.unref(u).view==="grid"?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(K),w=>(e.openBlock(),e.createBlock(De,{key:w,"row-index":w,"row-height":q.value,view:"grid","items-per-row":e.unref(R),items:e.unref(C)(e.unref(E),w),"show-thumbnails":e.unref(u).showThumbnails,"is-dragging-item":Z,"is-selected":h,"drag-n-drop-events":B=>e.unref(r).events(B),explorerId:e.unref(b),onClick:re,onDblclick:de,onContextmenu:ue,onDragstart:me,onDragend:ke},{icon:e.withCtx(B=>[e.renderSlot(x.$slots,"icon",e.mergeProps({ref_for:!0},B))]),_:3},8,["row-index","row-height","items-per-row","items","show-thumbnails","drag-n-drop-events","explorerId"]))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(e.unref(K),w=>(e.openBlock(),e.createBlock(De,{key:w,"row-index":w,"row-height":q.value,view:"list",items:te(w)?[te(w)]:[],compact:e.unref(u).compactListView,"is-dragging-item":Z,"is-selected":h,"drag-n-drop-events":B=>e.unref(r).events(B),explorerId:e.unref(b),onClick:re,onDblclick:de,onContextmenu:ue,onDragstart:me,onDragend:ke},{icon:e.withCtx(B=>[e.renderSlot(x.$slots,"icon",e.mergeProps({ref_for:!0},B))]),_:3},8,["row-index","row-height","items","compact","drag-n-drop-events","explorerId"]))),128))],36)],34),e.createVNode(ec)]))}}),ac=["href","download"],sc=["onClick"],ic=e.defineComponent({__name:"ContextMenu",setup(n){const t=e.inject("ServiceContainer"),o=t.search,r=D.useStore(o.state),l=e.ref(null),d=e.ref([]),a=e.reactive({active:!1,items:[],positions:{left:"0px",top:"0px"}});t.emitter.on("vf-context-selected",i=>{d.value=i});const f=i=>i.link(t,d.value),s=i=>{t.emitter.emit("vf-contextmenu-hide"),i.action(t,d.value)};t.emitter.on("vf-contextmenu-show",({event:i,items:u,target:_=null})=>{if(a.items=t.contextMenuItems.filter(p=>p.show(t,{searchQuery:r.value.query,items:u,target:_})),r.value.query)if(_)t.emitter.emit("vf-context-selected",[_]);else return;else!_&&!r.value.query?t.emitter.emit("vf-context-selected",[]):u.length>1&&u.some(p=>p.path===_.path)?t.emitter.emit("vf-context-selected",u):t.emitter.emit("vf-context-selected",[_]);m(i)}),t.emitter.on("vf-contextmenu-hide",()=>{a.active=!1});const m=i=>{const u=t.root,_=t.root.getBoundingClientRect(),p=u.getBoundingClientRect();let E=i.clientX-_.left,k=i.clientY-_.top;a.active=!0,e.nextTick(()=>{const g=l.value?.getBoundingClientRect();let v=g?.height??0,h=g?.width??0;E=p.right-i.pageX+window.scrollX<h?E-h:E,k=p.bottom-i.pageY+window.scrollY<v?k-v:k,a.positions={left:String(E)+"px",top:String(k)+"px"}})};return(i,u)=>e.withDirectives((e.openBlock(),e.createElementBlock("ul",{ref_key:"contextmenu",ref:l,class:e.normalizeClass([{"vuefinder__context-menu--active":a.active,"vuefinder__context-menu--inactive":!a.active},"vuefinder__context-menu"]),style:e.normalizeStyle(a.positions)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.items,_=>(e.openBlock(),e.createElementBlock("li",{class:"vuefinder__context-menu__item",key:_.title},[_.link?(e.openBlock(),e.createElementBlock("a",{key:0,class:"vuefinder__context-menu__link",target:"_blank",href:f(_),download:f(_),onClick:u[0]||(u[0]=p=>e.unref(t).emitter.emit("vf-contextmenu-hide"))},[e.createElementVNode("span",null,e.toDisplayString(_.title(e.unref(t).i18n)),1)],8,ac)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"vuefinder__context-menu__action",onClick:p=>s(_)},[e.createElementVNode("span",null,e.toDisplayString(_.title(e.unref(t).i18n)),1)],8,sc))]))),128))],6)),[[e.vShow,a.active]])}}),cc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2",class:"h-5 w-5 stroke-slate-500 cursor-pointer",viewBox:"0 0 24 24"};function dc(n,t){return e.openBlock(),e.createElementBlock("svg",cc,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0"},null,-1)])])}const uc={render:dc},mc={class:"vuefinder__status-bar__wrapper"},fc={class:"vuefinder__status-bar__storage"},vc=["title"],_c={class:"vuefinder__status-bar__storage-icon"},pc=["value"],hc=["value"],gc={class:"vuefinder__status-bar__info space-x-2"},kc={key:0},wc={key:1},yc={key:0,class:"vuefinder__status-bar__size"},bc={class:"vuefinder__status-bar__actions"},Ec=["title"],Vc=e.defineComponent({__name:"Statusbar",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,r=t.fs,l=D.useStore(r.sortedFiles),d=D.useStore(r.path),a=D.useStore(r.selectedCount),f=D.useStore(r.storages),s=D.useStore(r.selectedItems),m=D.useStore(r.path),i=_=>{const p=_.target.value;t.emitter.emit("vf-search-exit"),t.emitter.emit("vf-fetch",{params:{q:"index",storage:p}})},u=e.computed(()=>!s.value||s.value.length===0?0:s.value.reduce((_,p)=>_+(p.file_size||0),0));return(_,p)=>(e.openBlock(),e.createElementBlock("div",mc,[e.createElementVNode("div",fc,[e.createElementVNode("div",{class:"vuefinder__status-bar__storage-container",title:e.unref(o)("Storage")},[e.createElementVNode("div",_c,[e.createVNode(e.unref(Le))]),e.createElementVNode("select",{name:"vuefinder-media-selector",value:e.unref(d)?.storage,onChange:i,class:"vuefinder__status-bar__storage-select",tabindex:"-1"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),E=>(e.openBlock(),e.createElementBlock("option",{value:E,key:E},e.toDisplayString(E),9,hc))),128))],40,pc)],8,vc),e.createElementVNode("div",gc,[e.unref(a)===0?(e.openBlock(),e.createElementBlock("span",kc,e.toDisplayString(e.unref(l).length)+" "+e.toDisplayString(e.unref(o)("items")),1)):(e.openBlock(),e.createElementBlock("span",wc,[e.createTextVNode(e.toDisplayString(e.unref(a))+" "+e.toDisplayString(e.unref(o)("selected"))+" ",1),u.value?(e.openBlock(),e.createElementBlock("span",yc,e.toDisplayString(e.unref(t).filesize(u.value)),1)):e.createCommentVNode("",!0)]))])]),e.createElementVNode("div",bc,[e.renderSlot(_.$slots,"actions",{path:e.unref(m).path,count:e.unref(a)||0,selected:e.unref(s)||[]}),e.createElementVNode("span",{class:"vuefinder__status-bar__about",title:e.unref(o)("About"),onClick:p[0]||(p[0]=E=>e.unref(t).modal.open(Te))},[e.createVNode(e.unref(uc))],8,Ec)])]))}}),Nc={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 24 24"};function Sc(n,t){return e.openBlock(),e.createElementBlock("svg",Nc,[...t[0]||(t[0]=[e.createElementVNode("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2m3.6 5.2a1 1 0 0 0-1.4.2L12 10.333 9.8 7.4a1 1 0 1 0-1.6 1.2l2.55 3.4-2.55 3.4a1 1 0 1 0 1.6 1.2l2.2-2.933 2.2 2.933a1 1 0 0 0 1.6-1.2L13.25 12l2.55-3.4a1 1 0 0 0-.2-1.4"},null,-1)])])}const Bc={render:Sc};function ct(n,t){const o=n.findIndex(r=>r.path===t.path);o>-1?n[o]=t:n.push(t)}const Cc={class:"vuefinder__folder-loader-indicator"},xc={key:1,class:"vuefinder__folder-loader-indicator--icon"},dt=e.defineComponent({__name:"FolderLoaderIndicator",props:e.mergeModels({storage:{},path:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,o=e.inject("ServiceContainer"),{t:r}=o.i18n,l=e.useModel(n,"modelValue"),d=e.ref(!1);e.watch(()=>l.value,()=>a()?.folders.length||f());function a(){return o.treeViewData.find(s=>s.path===t.path)}const f=()=>{d.value=!0,o.requester.send({url:"",method:"get",params:{q:"subfolders",storage:t.storage,path:t.path}}).then(s=>{ct(o.treeViewData,{path:t.path,type:"dir",...s})}).catch(s=>{}).finally(()=>{d.value=!1})};return(s,m)=>(e.openBlock(),e.createElementBlock("div",Cc,[d.value?(e.openBlock(),e.createBlock(e.unref(qe),{key:0,class:"vuefinder__folder-loader-indicator--loading"})):(e.openBlock(),e.createElementBlock("div",xc,[l.value&&a()?.folders.length?(e.openBlock(),e.createBlock(e.unref(Ne),{key:0,class:"vuefinder__folder-loader-indicator--minus"})):e.createCommentVNode("",!0),l.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(Ve),{key:1,class:"vuefinder__folder-loader-indicator--plus"}))]))]))}}),$c=["onClick"],Dc=["title","onDblclick","onClick"],Mc={class:"vuefinder__treesubfolderlist__item-icon"},Tc={class:"vuefinder__treesubfolderlist__subfolder"},Fc=e.defineComponent({__name:"TreeSubfolderList",props:{storage:{},path:{}},setup(n){const t=e.inject("ServiceContainer"),o=t.fs,r=he(t,["bg-blue-200","dark:bg-slate-600"]),l=e.ref({}),d=D.useStore(o.path),a=n,f=e.ref(null);e.onMounted(()=>{a.path===a.storage+"://"&&f.value&&ye.OverlayScrollbars(f.value,{scrollbars:{theme:"vf-scrollbars-theme"}})});const s=e.computed(()=>t.treeViewData.find(m=>m.path===a.path)?.folders||[]);return(m,i)=>{const u=e.resolveComponent("TreeSubfolderList",!0);return e.openBlock(),e.createElementBlock("ul",{ref_key:"parentSubfolderList",ref:f,class:"vuefinder__treesubfolderlist__container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,_=>(e.openBlock(),e.createElementBlock("li",{key:_.path,class:"vuefinder__treesubfolderlist__item"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(r).events({..._,type:"dir"}),!0),{class:"vuefinder__treesubfolderlist__item-content"}),[e.createElementVNode("div",{class:"vuefinder__treesubfolderlist__item-toggle",onClick:p=>l.value[_.path]=!l.value[_.path]},[e.createVNode(dt,{storage:n.storage,path:_.path,modelValue:l.value[_.path],"onUpdate:modelValue":p=>l.value[_.path]=p},null,8,["storage","path","modelValue","onUpdate:modelValue"])],8,$c),e.createElementVNode("div",{class:"vuefinder__treesubfolderlist__item-link",title:_.path,onDblclick:p=>l.value[_.path]=!l.value[_.path],onClick:p=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:a.storage,path:_.path}})},[e.createElementVNode("div",Mc,[e.unref(d)?.path===_.path?(e.openBlock(),e.createBlock(e.unref(Ie),{key:0})):(e.openBlock(),e.createBlock(e.unref(ce),{key:1,class:"vuefinder__item-icon__folder"}))]),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__treesubfolderlist__item-text",{"vuefinder__treesubfolderlist__item-text--active":e.unref(d)?.path===_.path}])},e.toDisplayString(_.basename),3)],40,Dc)],16),e.createElementVNode("div",Tc,[e.withDirectives(e.createVNode(u,{storage:a.storage,path:_.path},null,8,["storage","path"]),[[e.vShow,l.value[_.path]]])])]))),128))],512)}}}),Ac=e.defineComponent({__name:"TreeStorageItem",props:{storage:{}},setup(n){const t=e.inject("ServiceContainer"),o=t.fs,r=e.ref(!1),l=n,d=he(t,["bg-blue-200","dark:bg-slate-600"]),a=D.useStore(o.path),f=e.computed(()=>l.storage===a.value?.storage),s={storage:l.storage,path:l.storage+"://",type:"dir",basename:l.storage,extension:"",file_size:null,last_modified:null,mime_type:null,visibility:"public"};function m(i){i===a.value?.storage?r.value=!r.value:(t.emitter.emit("vf-search-exit"),t.emitter.emit("vf-fetch",{params:{q:"index",storage:i}}))}return(i,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{onClick:u[2]||(u[2]=_=>m(n.storage)),class:"vuefinder__treestorageitem__header"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(d).events(s),!0),{class:["vuefinder__treestorageitem__info",f.value?"vuefinder__treestorageitem__info--active":""]}),[e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__treestorageitem__icon",f.value?"vuefinder__treestorageitem__icon--active":""])},[e.createVNode(e.unref(Le))],2),e.createElementVNode("div",null,e.toDisplayString(n.storage),1)],16),e.createElementVNode("div",{class:"vuefinder__treestorageitem__loader",onClick:u[1]||(u[1]=e.withModifiers(_=>r.value=!r.value,["stop"]))},[e.createVNode(dt,{storage:n.storage,path:n.storage+"://",modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=_=>r.value=_)},null,8,["storage","path","modelValue"])])]),e.withDirectives(e.createVNode(Fc,{storage:n.storage,path:n.storage+"://",class:"vuefinder__treestorageitem__subfolder"},null,8,["storage","path"]),[[e.vShow,r.value]])],64))}}),Lc={class:"vuefinder__folder-indicator"},Ic={class:"vuefinder__folder-indicator--icon"},Rc=e.defineComponent({__name:"FolderIndicator",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const t=e.useModel(n,"modelValue");return(o,r)=>(e.openBlock(),e.createElementBlock("div",Lc,[e.createElementVNode("div",Ic,[t.value?(e.openBlock(),e.createBlock(e.unref(Ne),{key:0,class:"vuefinder__folder-indicator--minus"})):e.createCommentVNode("",!0),t.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(Ve),{key:1,class:"vuefinder__folder-indicator--plus"}))])]))}}),Pc={class:"vuefinder__treeview__header"},zc={class:"vuefinder__treeview__pinned-label"},Hc={class:"vuefinder__treeview__pin-text text-nowrap"},Oc={key:0,class:"vuefinder__treeview__pinned-list"},qc=["onClick"],Uc=["title"],jc=["onClick"],Kc={key:0},Gc={class:"vuefinder__treeview__no-pinned"},Yc=e.defineComponent({__name:"TreeView",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,{getStore:r,setStore:l}=t.storage,d=t.fs,a=t.config,f=D.useStore(a.state),s=D.useStore(d.sortedFiles),m=D.useStore(d.storages),i=D.useStore(d.path),u=he(t,["bg-blue-200","dark:bg-slate-600"]),_=e.ref(190),p=e.ref(r("pinned-folders-opened",!0));e.watch(p,v=>l("pinned-folders-opened",v));const E=v=>{a.set("pinnedFolders",a.get("pinnedFolders").filter(h=>h.path!==v.path))},k=v=>{const h=v.clientX,c=v.target.parentElement;if(!c)return;const y=c.getBoundingClientRect().width;c.classList.remove("transition-[width]"),c.classList.add("transition-none");const N=q=>{_.value=y+q.clientX-h,_.value<50&&(_.value=0,a.set("showTreeView",!1)),_.value>50&&a.set("showTreeView",!0)},$=()=>{const q=c.getBoundingClientRect();_.value=q.width,c.classList.add("transition-[width]"),c.classList.remove("transition-none"),window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",$)};window.addEventListener("mousemove",N),window.addEventListener("mouseup",$)},g=e.ref(null);return e.onMounted(()=>{g.value&&ye.OverlayScrollbars(g.value,{overflow:{x:"hidden"},scrollbars:{theme:"vf-scrollbars-theme"}})}),e.watch(s,v=>{const h=v.filter(c=>c.type==="dir");ct(t.treeViewData,{path:i.value?.path||"",folders:h.map(c=>({storage:c.storage,path:c.path,basename:c.basename,type:"dir"}))})}),(v,h)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{onClick:h[0]||(h[0]=c=>e.unref(a).toggle("showTreeView")),class:e.normalizeClass(["vuefinder__treeview__overlay",e.unref(f).showTreeView?"vuefinder__treeview__backdrop":"hidden"])},null,2),e.createElementVNode("div",{style:e.normalizeStyle(e.unref(f).showTreeView?"min-width:100px;max-width:75%; width: "+_.value+"px":"width: 0"),class:"vuefinder__treeview__container"},[e.createElementVNode("div",{ref_key:"treeViewScrollElement",ref:g,class:"vuefinder__treeview__scroll"},[e.createElementVNode("div",Pc,[e.createElementVNode("div",{onClick:h[2]||(h[2]=c=>p.value=!p.value),class:"vuefinder__treeview__pinned-toggle"},[e.createElementVNode("div",zc,[e.createVNode(e.unref(Ae),{class:"vuefinder__treeview__pin-icon"}),e.createElementVNode("div",Hc,e.toDisplayString(e.unref(o)("Pinned Folders")),1)]),e.createVNode(Rc,{modelValue:p.value,"onUpdate:modelValue":h[1]||(h[1]=c=>p.value=c)},null,8,["modelValue"])]),p.value?(e.openBlock(),e.createElementBlock("ul",Oc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f).pinnedFolders,c=>(e.openBlock(),e.createElementBlock("li",{key:c.path,class:"vuefinder__treeview__pinned-item"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(u).events(c),!0),{class:"vuefinder__treeview__pinned-folder",onClick:y=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:c.storage,path:c.path}})}),[e.unref(i)?.path!==c.path?(e.openBlock(),e.createBlock(e.unref(ce),{key:0,class:"vuefinder__treeview__folder-icon vuefinder__item-icon__folder"})):e.createCommentVNode("",!0),e.unref(i)?.path===c.path?(e.openBlock(),e.createBlock(e.unref(Ie),{key:1,class:"vuefinder__treeview__open-folder-icon"})):e.createCommentVNode("",!0),e.createElementVNode("div",{title:c.path,class:e.normalizeClass(["vuefinder__treeview__folder-name",{"vuefinder__treeview__folder-name--active":e.unref(i)?.path===c.path}])},e.toDisplayString(c.basename),11,Uc)],16,qc),e.createElementVNode("div",{class:"vuefinder__treeview__remove-folder",onClick:y=>E(c)},[e.createVNode(e.unref(Bc),{class:"vuefinder__treeview__remove-icon"})],8,jc)]))),128)),e.unref(f).pinnedFolders.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("li",Kc,[e.createElementVNode("div",Gc,e.toDisplayString(e.unref(o)("No folders pinned")),1)]))])):e.createCommentVNode("",!0)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),c=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__treeview__storage",key:c},[e.createVNode(Ac,{storage:c},null,8,["storage"])]))),128))],512),e.createElementVNode("div",{onMousedown:k,class:"vuefinder__treeview__resize-handle"},null,32)],4)],64))}}),X={newfolder:"newfolder",selectAll:"selectAll",pinFolder:"pinFolder",unpinFolder:"unpinFolder",delete:"delete",refresh:"refresh",preview:"preview",open:"open",openDir:"openDir",download:"download",download_archive:"download_archive",archive:"archive",unarchive:"unarchive",rename:"rename",move:"move",copy:"copy",paste:"paste"};function Wc(n){return n.items.length>1&&n.items.some(t=>t.path===n.target?.path)?"many":n.target?"one":"none"}function Y(n){const t=Object.assign({needsSearchQuery:!1},n);return(o,r)=>!(t.needsSearchQuery!==!!r.searchQuery||t.target!==void 0&&t.target!==Wc(r)||t.targetType!==void 0&&t.targetType!==r.target?.type||t.mimeType!==void 0&&t.mimeType!==r.target?.mime_type||t.feature!==void 0&&!o.features.includes(t.feature))}function _e(...n){return(t,o)=>n.some(r=>r(t,o))}function pe(...n){return(t,o)=>n.every(r=>r(t,o))}const ut=[{id:X.openDir,title:({t:n})=>n("Open containing folder"),action:(n,t)=>{const o=t[0];o&&(n.emitter.emit("vf-fetch",{params:{q:"index",storage:o.storage,path:o.dir}}),n.search.setQuery("",!0))},show:Y({target:"one",needsSearchQuery:!0})},{id:X.refresh,title:({t:n})=>n("Refresh"),action:n=>{const t=n.fs;n.emitter.emit("vf-fetch",{params:{q:"index",storage:t.path.get().storage,path:t.path.get().path}})},show:_e(Y({target:"none"}),Y({target:"many"}))},{id:X.selectAll,title:({t:n})=>n("Select All"),action:n=>{n.fs.selectAll(n.selectionMode||"multiple")},show:(n,t)=>n.selectionMode==="multiple"&&Y({target:"none"})(n,t)},{id:X.newfolder,title:({t:n})=>n("New Folder"),action:n=>n.modal.open(Pe),show:Y({target:"none",feature:z.NEW_FOLDER})},{id:X.open,title:({t:n})=>n("Open"),action:(n,t)=>{n.emitter.emit("vf-search-exit"),t[0]&&n.emitter.emit("vf-fetch",{params:{q:"index",storage:t[0].storage,path:t[0].path}})},show:Y({target:"one",targetType:"dir"})},{id:X.pinFolder,title:({t:n})=>n("Pin Folder"),action:(n,t)=>{const o=n.config,r=o.get("pinnedFolders"),l=r.concat(t.filter(d=>r.findIndex(a=>a.path===d.path)===-1));o.set("pinnedFolders",l)},show:pe(Y({target:"one",targetType:"dir"}),(n,t)=>n.config.get("pinnedFolders").findIndex(l=>l.path===t.target?.path)===-1)},{id:X.unpinFolder,title:({t:n})=>n("Unpin Folder"),action:(n,t)=>{const o=n.config,r=o.get("pinnedFolders");o.set("pinnedFolders",r.filter(l=>!t.find(d=>d.path===l.path)))},show:pe(Y({target:"one",targetType:"dir"}),(n,t)=>n.config.get("pinnedFolders").findIndex(l=>l.path===t.target?.path)!==-1)},{id:X.preview,title:({t:n})=>n("Preview"),action:(n,t)=>n.modal.open(Fe,{storage:t[0]?.storage,item:t[0]}),show:pe(Y({target:"one",feature:z.PREVIEW}),(n,t)=>t.target?.type!=="dir")},{id:X.download,link:(n,t)=>n.requester.getDownloadUrl(t[0]?.storage,t[0]),title:({t:n})=>n("Download"),action:()=>{},show:pe(Y({target:"one",feature:z.DOWNLOAD}),(n,t)=>t.target?.type!=="dir")},{id:X.rename,title:({t:n})=>n("Rename"),action:(n,t)=>n.modal.open(Ee,{items:t}),show:Y({target:"one",feature:z.RENAME})},{id:X.move,title:({t:n})=>n("Move"),action:(n,t)=>{const o=n.fs,r={storage:o.path.get().storage||"",path:o.path.get().path||"",type:"dir"};n.modal.open(ie,{items:{from:t,to:r}})},show:_e(Y({target:"one",feature:z.MOVE}),Y({target:"many",feature:z.MOVE}))},{id:X.copy,title:({t:n})=>n("Copy"),action:(n,t)=>{t.length>0&&n.fs.setClipboard("copy",new Set(t.map(o=>o.path)))},show:_e(Y({target:"one",feature:z.COPY}),Y({target:"many",feature:z.COPY}))},{id:X.paste,title:({t:n})=>n("Paste"),action:(n,t)=>{const o=n.fs.getClipboard();if(o?.items?.size>0){const l=n.fs.path.get();let d=l.path,a=l.storage;t.length===1&&t[0].type==="dir"&&(d=t[0].path,a=t[0].storage);const f={storage:a||"",path:d||"",type:"dir"};n.modal.open(o.type==="cut"?ie:Re,{items:{from:Array.from(o.items),to:f}})}},show:(n,t)=>n.fs.getClipboard()?.items?.size>0},{id:X.archive,title:({t:n})=>n("Archive"),action:(n,t)=>n.modal.open(Oe,{items:t}),show:_e(Y({target:"many",feature:z.ARCHIVE}),pe(Y({target:"one",feature:z.ARCHIVE}),(n,t)=>t.target?.mime_type!=="application/zip"))},{id:X.unarchive,title:({t:n})=>n("Unarchive"),action:(n,t)=>n.modal.open(He,{items:t}),show:Y({target:"one",feature:z.UNARCHIVE,mimeType:"application/zip"})},{id:X.delete,title:({t:n})=>n("Delete"),action:(n,t)=>{n.modal.open(be,{items:t})},show:_e(Y({feature:z.DELETE,target:"one"}),Y({feature:z.DELETE,target:"many"}))}],Xc={key:0,class:"vuefinder__external-drop-overlay"},Qc={class:"vuefinder__external-drop-message"},Jc={class:"vuefinder__main__content"},mt=e.defineComponent({__name:"VueFinder",props:{id:{default:"vf"},config:{},request:{},features:{type:[Boolean,Array],default:!0},debug:{type:Boolean,default:!1},theme:{default:"system"},locale:{},contextMenuItems:{default:()=>ut},selectionMode:{default:"multiple"},onError:{},onSelect:{},onPathChange:{},onUploadComplete:{},onDeleteComplete:{},onReady:{},onFileDclick:{},onFolderDclick:{}},emits:["select","path-change","upload-complete","delete-complete","error","ready","file-dclick","folder-dclick"],setup(n,{emit:t}){const o=t,r=n,l=At(r,e.inject("VueFinderOptions")||{});e.provide("ServiceContainer",l);const d=l.config,a=l.fs,f=D.useStore(d.state);hl(l);const{isDraggingExternal:s,handleDragEnter:m,handleDragOver:i,handleDragLeave:u,handleDrop:_}=gl();let p=null;l.emitter.on("vf-fetch-abort",()=>{p&&p.abort(),a.setLoading(!1)}),l.emitter.on("vf-upload-complete",g=>{o("upload-complete",g)}),l.emitter.on("vf-delete-complete",g=>{o("delete-complete",g)}),l.emitter.on("vf-file-dclick",g=>{o("file-dclick",g)}),l.emitter.on("vf-folder-dclick",g=>{o("folder-dclick",g)}),l.emitter.on("vf-fetch",g=>{const{params:v,body:h=null,onSuccess:c=null,onError:y=null,dontCloseModal:N=!1,dontChangePath:$=!1}=g;$||["index","search"].includes(v.q)&&(p&&p.abort(),a.setLoading(!0)),p=new AbortController;const q=p.signal;l.requester.send({url:"",method:v.m||"get",params:v,body:h,abortSignal:q}).then(H=>{const R=H;$||(a.setPath(R.dirname),d.get("persist")&&d.set("path",R.dirname),a.setReadOnly(R.read_only),N||l.modal.close(),a.setFiles(R.files),a.clearSelection(),a.setSelectedCount(0),a.setStorages(R.storages)),c&&c(R)}).catch(H=>{console.error(H),y?y(H):H&&typeof H=="object"&&"message"in H&&l.emitter.emit("vf-toast-push",{label:H.message,type:"error"}),o("error",H)}).finally(()=>{["index","search"].includes(v.q)&&a.setLoading(!1)})});function E(g){let v={};g&&g.includes("://")&&(v={storage:g.split("://")[0],path:g}),l.emitter.emit("vf-fetch",{params:{q:"index",storage:a.path.get().storage,...v},onError:r.onError??(h=>{h&&typeof h=="object"&&"message"in h&&l.emitter.emit("vf-toast-push",{label:h.message,type:"error"})})})}e.onMounted(()=>{e.watch(()=>d.get("path"),v=>{E(v)});const g=d.get("persist")?d.get("path"):d.get("initialPath")??"";a.setPath(g),E(g),a.path.listen(v=>{o("path-change",v.path)}),a.selectedItems.listen(v=>{o("select",v)}),o("ready")});const k=g=>{const v=_(g);v.length>0&&(l.modal.open(ze),setTimeout(()=>{l.emitter.emit("vf-external-files-dropped",v.map(h=>h.file))},100))};return(g,v)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder vuefinder__main",{"vuefinder--dragging-external":e.unref(s)}]),ref:"root",tabindex:"0",onDragenter:v[2]||(v[2]=(...h)=>e.unref(m)&&e.unref(m)(...h)),onDragover:v[3]||(v[3]=(...h)=>e.unref(i)&&e.unref(i)(...h)),onDragleave:v[4]||(v[4]=(...h)=>e.unref(u)&&e.unref(u)(...h)),onDrop:k},[e.createElementVNode("div",{class:e.normalizeClass(e.unref(l).theme.actualValue),style:{height:"100%",width:"100%"}},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(f)?.fullScreen?"vuefinder__main__fixed":"vuefinder__main__relative","vuefinder__main__container"]),onMousedown:v[0]||(v[0]=h=>e.unref(l).emitter.emit("vf-contextmenu-hide")),onTouchstart:v[1]||(v[1]=h=>e.unref(l).emitter.emit("vf-contextmenu-hide"))},[e.unref(s)?(e.openBlock(),e.createElementBlock("div",Xc,[e.createElementVNode("div",Qc,e.toDisplayString(e.unref(l).i18n.t("Drop files here")),1)])):e.createCommentVNode("",!0),e.createVNode(Sa),e.createVNode(Ms),e.createVNode(wi),e.createElementVNode("div",Jc,[e.createVNode(Yc),e.createVNode(lc,{"on-file-dclick":r.onFileDclick,"on-folder-dclick":r.onFolderDclick},{icon:e.withCtx(h=>[e.renderSlot(g.$slots,"icon",e.normalizeProps(e.guardReactiveProps(h)))]),_:3},8,["on-file-dclick","on-folder-dclick"])]),e.createVNode(Vc,null,{actions:e.withCtx(h=>[e.renderSlot(g.$slots,"status-bar",e.normalizeProps(e.guardReactiveProps(h)))]),_:3})],34),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[e.unref(l).modal.visible?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l).modal.type),{key:0})):e.createCommentVNode("",!0)]),_:1})])),e.createVNode(ic)],2)],34))}}),ft={install(n,t={}){t.i18n=t.i18n??{};let[o]=Object.keys(t.i18n);t.locale=t.locale??o??"en",n.provide("VueFinderOptions",t),n.component("VueFinder",mt)}};exports.ContextMenuIds=X;exports.VueFinder=mt;exports.VueFinderPlugin=ft;exports.contextMenuItems=ut;exports.default=ft;
