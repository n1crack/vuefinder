"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),R=require("@nanostores/vue"),kn=require("mitt"),yn=require("@nanostores/persistent"),ne=require("nanostores"),En=require("@uppy/core"),Sn=require("@uppy/xhr-upload"),xn=require("@viselect/vanilla"),Cn=require("vanilla-lazyload"),ct=require("overlayscrollbars"),qe=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");class Bn{config;constructor(n){this.config=Object.assign({baseUrl:"",headers:{},params:{},body:{},xsrfHeaderName:"X-CSRF-Token",fetchParams:{}},n)}customFetch=async(...n)=>{let[o,i]=n;this.config.fetchRequestInterceptor&&(i=this.config.fetchRequestInterceptor(i));let s=await fetch(o,i);return this.config.fetchResponseInterceptor&&(s=await this.config.fetchResponseInterceptor(s)),s};transformRequestParams(n){const o=this.config,i={};qe!=null&&qe!==""&&o.xsrfHeaderName&&(i[o.xsrfHeaderName]=qe);const s=Object.assign({},o.headers,i,n.headers),r=Object.assign({},o.params,n.params),l=o.baseUrl+n.url,c=n.method;let a;if(c!=="get")if(n.body instanceof FormData){const d=n.body;o.body!=null&&Object.entries(this.config.body).forEach(([u,m])=>{d.append(u,String(m))}),a=d}else{const d=Object.assign({},n.body??{});o.body!=null&&Object.assign(d,this.config.body),a=d}const h={url:l,method:c,headers:s,params:r,body:a};if(o.transformRequest!=null){const d=o.transformRequest({url:l,method:c,headers:s,params:r,body:a??null});d.url!=null&&(h.url=d.url),d.method!=null&&(h.method=d.method),d.params!=null&&(h.params=d.params),d.headers!=null&&(h.headers=d.headers),d.body!=null&&(h.body=d.body)}return h}getDownloadUrl(n,o){if(o.url!=null)return o.url;const i=this.transformRequestParams({url:"",method:"get",params:{q:"download",storage:n,adapter:n,path:o.path}});return i.url+"?"+new URLSearchParams(i.params).toString()}getPreviewUrl(n,o){if(o.url!=null)return o.url;const i=this.transformRequestParams({url:"",method:"get",params:{q:"preview",storage:n,adapter:n,path:o.path}});return i.url+"?"+new URLSearchParams(i.params).toString()}async send(n){const o=this.transformRequestParams(n),i=n.responseType||"json",s={method:n.method,headers:o.headers,signal:n.abortSignal},r=o.url+"?"+new URLSearchParams(o.params);if(o.method!=="get"&&o.body!=null){let c;o.body instanceof FormData?c=n.body:(c=JSON.stringify(o.body),s.headers["Content-Type"]="application/json"),s.body=c}this.config.fetchParams&&Object.assign(s,this.config.fetchParams);const l=await this.customFetch(r,s);if(l.ok)return await l[i]();throw await l.json()}}function Vn(t){const n={baseUrl:"",headers:{},params:{},body:{},xsrfHeaderName:"X-CSRF-Token",fetchParams:{}};return typeof t=="string"?Object.assign(n,{baseUrl:t}):Object.assign(n,t),new Bn(n)}function Nn(t){let n=localStorage.getItem(t+"_storage");const o=e.reactive(JSON.parse(n??"{}"));e.watch(o,i);function i(){Object.keys(o).length?localStorage.setItem(t+"_storage",JSON.stringify(o)):localStorage.removeItem(t+"_storage")}function s(a,h){o[a]=h}function r(a){delete o[a]}function l(){Object.keys(o).forEach(a=>r(a))}return{getStore:(a,h=null)=>a in o?o[a]:h,setStore:s,removeStore:r,clearStore:l}}async function Mn(t,n){const o=n[t];return typeof o=="function"?(await o()).default:o}function $n(t,n,o,i){const{getStore:s,setStore:r}=t,l=e.ref({}),c=e.ref(s("locale",n)),a=(u,m=n)=>{Mn(u,i).then(f=>{l.value=f,r("locale",u),c.value=u,r("translations",f),Object.values(i).length>1&&(o.emit("vf-toast-push",{label:"The language is set to "+u}),o.emit("vf-language-saved"))}).catch(()=>{m?(o.emit("vf-toast-push",{label:"The selected locale is not yet supported!",type:"error"}),a(m,null)):o.emit("vf-toast-push",{label:"Locale cannot be loaded!",type:"error"})})};e.watch(c,u=>{a(u)}),!s("locale")&&!Object.keys(i).length?a(n):l.value=s("translations");const h=(u,...m)=>m.length?h(u=u.replace("%s",String(m.shift())),...m):u;function d(u,...m){return l.value&&Object.prototype.hasOwnProperty.call(l.value,u)?h(l.value[u]||u,...m):h(u,...m)}return e.reactive({t:d,locale:c})}const W={EDIT:"edit",NEW_FILE:"newfile",NEW_FOLDER:"newfolder",PREVIEW:"preview",ARCHIVE:"archive",UNARCHIVE:"unarchive",SEARCH:"search",RENAME:"rename",UPLOAD:"upload",DELETE:"delete",FULL_SCREEN:"fullscreen",DOWNLOAD:"download",LANGUAGE:"language"},An=Object.values(W),Dn="3.0.0-dev";function Mt(t,n,o,i,s){return n=Math,o=n.log,i=1024,s=o(t)/o(i)|0,(t/n.pow(i,s)).toFixed(0)+" "+(s?"KMGTPEZY"[--s]+"iB":"B")}function $t(t,n,o,i,s){return n=Math,o=n.log,i=1e3,s=o(t)/o(i)|0,(t/n.pow(i,s)).toFixed(0)+" "+(s?"KMGTPEZY"[--s]+"B":"B")}function zn(t){if(typeof t=="number")return t;const n={k:1,m:2,g:3,t:4},i=/(\d+(?:\.\d+)?)\s?(k|m|g|t)?b?/i.exec(t);if(!i)return 0;const s=parseFloat(i[1]||"0"),r=(i[2]||"").toLowerCase(),l=n[r]??0;return Math.round(s*Math.pow(1024,l))}const be={SYSTEM:"system",LIGHT:"light",DARK:"dark"};function Rn(t,n){const o=e.ref(be.SYSTEM),i=e.ref(be.LIGHT);o.value=t.getStore("theme",n??be.SYSTEM);const s=window.matchMedia("(prefers-color-scheme: dark)"),r=l=>{o.value===be.DARK||o.value===be.SYSTEM&&l.matches?i.value=be.DARK:i.value=be.LIGHT};return r(s),s.addEventListener("change",r),{value:o,actualValue:i,set(l){o.value=l,l!==be.SYSTEM?t.setStore("theme",l):t.removeStore("theme"),r(s)}}}function Tn(){const t=e.shallowRef(null),n=e.ref(!1),o=e.ref();return{visible:n,type:t,data:o,open:(r,l=null)=>{document.querySelector("body").style.overflow="hidden",n.value=!0,t.value=r,o.value=l},close:()=>{document.querySelector("body").style.overflow="",n.value=!1,t.value=null}}}const Ye={view:"grid",fullScreen:!1,showTreeView:!1,compactListView:!0,metricUnits:!1,showThumbnails:!0,persist:!1,path:"",loadingIndicator:"circular",maxFileSize:null,pinnedFolders:[],customIcon:void 0,selectButton:!1},In=t=>{const n=`vuefinder_config_${t}`,o=yn.persistentAtom(n,Ye,{encode:JSON.stringify,decode:JSON.parse}),i=(h={})=>{const d=o.get(),u={...Ye,...h,...d};o.set(u)},s=h=>o.get()[h],r=()=>o.get(),l=(h,d)=>{const u=o.get();typeof h=="object"&&h!==null?o.set({...u,...h}):o.set({...u,[h]:d})};return{state:o,init:i,get:s,set:l,toggle:h=>{const d=o.get();l(h,!d[h])},all:r,reset:()=>{o.set({...Ye})}}};function Ln(t,n){if(typeof t=="string"&&typeof n=="string")return t.toLowerCase().localeCompare(n.toLowerCase());const o=Number(t)||0,i=Number(n)||0;return o===i?0:o<i?-1:1}const Fn=()=>{const t=ne.atom(""),n=ne.atom([]),o=ne.atom([]),i=ne.atom({active:!1,column:"",order:""}),s=ne.atom(new Set),r=ne.atom({type:"copy",path:"",items:new Set}),l=ne.atom(null),c=ne.atom(0),a=ne.atom(!1),h=ne.computed([t],w=>{const E=(w||"local://").trim(),U=E.indexOf("://"),Q=U>=0?E.slice(0,U):"",ye=(U>=0?E.slice(U+3):E).split("/").filter(Boolean);let fe="";const Ee=ye.map(we=>(fe=fe?`${fe}/${we}`:we,{basename:we,name:we,path:Q?`${Q}://${fe}`:fe,type:"dir"}));return{storage:Q,breadcrumb:Ee,path:E}}),d=ne.computed([o,i],(w,E)=>{const{active:U,column:Q,order:_e}=E;if(!U||!Q)return w;const ye=_e==="asc"?1:-1;return w.slice().sort((fe,Ee)=>Ln(fe[Q],Ee[Q])*ye)}),u=ne.computed([o,s],(w,E)=>E.size===0?[]:w.filter(U=>E.has(U.path))),m=w=>{t.set(w)},f=w=>{o.set(w??[])},v=w=>{n.set(w??[])},p=(w,E)=>{i.set({active:!0,column:w,order:E})},_=w=>{const E=i.get();E.active&&E.column===w?i.set({active:E.order==="asc",column:w,order:"desc"}):i.set({active:!0,column:w,order:"asc"})},g=()=>{i.set({active:!1,column:"",order:""})},k=w=>{const E=new Set(s.get());E.add(w),s.set(E),c.set(E.size)},S=w=>{const E=new Set(s.get());E.delete(w),s.set(E),c.set(E.size)},N=w=>{const E=new Set(s.get());E.has(w)?E.delete(w):E.add(w),s.set(E),c.set(E.size)},O=()=>{const w=new Set(o.get().map(E=>E.path));s.set(w),c.set(w.size)},q=()=>{s.set(new Set),c.set(0)},$=w=>{const E=new Set(w??[]);s.set(E),c.set(E.size)},V=w=>{c.set(w)},Y=w=>{a.set(!!w)},T=()=>a.get(),G=(w,E)=>{const U=o.get().filter(Q=>E.has(Q.path));r.set({type:w,path:h.get().path,items:new Set(U)})},C=w=>ne.computed([r],E=>E.type==="cut"&&Array.from(E.items).some(U=>U.path===w)),b=w=>ne.computed([r],E=>E.type==="copy"&&Array.from(E.items).some(U=>U.path===w));return{files:o,storages:n,currentPath:t,sort:i,selectedKeys:s,selectedCount:c,loading:a,draggedItem:l,clipboardItems:r,path:h,sortedFiles:d,selectedItems:u,setPath:m,setFiles:f,setStorages:v,setSort:p,toggleSort:_,clearSort:g,select:k,deselect:S,toggleSelect:N,selectAll:O,clearSelection:q,setSelection:$,setSelectedCount:V,setLoading:Y,isLoading:T,setClipboard:G,createIsCut:C,createIsCopied:b,isCut:w=>{const E=C(w);return R.useStore(E).value??!1},isCopied:w=>{const E=b(w);return R.useStore(E).value??!1},clearClipboard:()=>{r.set({type:"copy",path:"",items:new Set})},getClipboard:()=>r.get(),setDraggedItem:w=>{l.set(w)},getDraggedItem:()=>l.get(),clearDraggedItem:()=>{l.set(null)}}},gt={query:"",searchMode:!1},Hn=()=>{const t=ne.atom(gt),n=ne.computed(t,h=>h.query.length>0);return{state:t,hasQuery:n,setQuery:h=>{const d=t.get();t.set({...d,query:h??""})},enterSearchMode:()=>{const h=t.get();t.set({...h,searchMode:!0})},exitSearchMode:()=>{t.set({query:"",searchMode:!1})},get:h=>t.get()[h],set:(h,d)=>{const u=t.get();typeof h=="object"&&h!==null?t.set({...u,...h}):t.set({...u,[h]:d})},all:()=>t.get(),reset:()=>{t.set({...gt})}}},Pn=(t,n)=>{const o=Nn(t.id),i=kn(),s=Rn(o,t.theme),r=n.i18n,l=t.locale??n.locale,c=In(t.id),a=Fn(),h=Hn(),d=u=>Array.isArray(u)?u:An;return e.reactive({version:Dn,config:c,fs:a,search:h,root:e.useTemplateRef("root"),debug:t.debug,emitter:i,storage:o,i18n:$n(o,l,i,r),modal:Tn(),requester:Vn(t.request),features:d(t.features),treeViewData:[],theme:s,filesize:c.get("metricUnits")?$t:Mt,contextMenuItems:t.contextMenuItems,customIcon:t.icon,selectButton:t.selectButton})},On={class:"vuefinder__modal-layout__container"},jn={class:"vuefinder__modal-layout__content"},Wn={class:"vuefinder__modal-layout__footer"},me=e.defineComponent({__name:"ModalLayout",setup(t){const n=e.ref(null),o=e.inject("ServiceContainer");return e.onMounted(()=>{const i=document.querySelector(".v-f-modal input");i&&i.focus(),e.nextTick(()=>{if(document.querySelector(".v-f-modal input")&&window.innerWidth<768&&n.value){const s=n.value.getBoundingClientRect().bottom+16;window.scrollTo({top:s,left:0,behavior:"smooth"})}})}),(i,s)=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__modal-layout","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",onKeyup:s[1]||(s[1]=e.withKeys(r=>e.unref(o).modal.close(),["esc"])),tabindex:"0"},[s[2]||(s[2]=e.createElementVNode("div",{class:"vuefinder__modal-layout__overlay"},null,-1)),e.createElementVNode("div",On,[e.createElementVNode("div",{class:"vuefinder__modal-layout__wrapper",onMousedown:s[0]||(s[0]=e.withModifiers(r=>e.unref(o).modal.close(),["self"]))},[e.createElementVNode("div",{ref_key:"modalBody",ref:n,class:"vuefinder__modal-layout__body"},[e.createElementVNode("div",jn,[e.renderSlot(i.$slots,"default")]),e.createElementVNode("div",Wn,[e.renderSlot(i.$slots,"buttons")])],512)],32)])],32))}}),Un={class:"vuefinder__modal-header"},qn={class:"vuefinder__modal-header__icon-container"},Yn={class:"vuefinder__modal-header__title",id:"modal-title"},ge=e.defineComponent({__name:"ModalHeader",props:{title:{},icon:{}},setup(t){return(n,o)=>(e.openBlock(),e.createElementBlock("div",Un,[e.createElementVNode("div",qn,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.icon),{class:"vuefinder__modal-header__icon"}))]),e.createElementVNode("h3",Yn,e.toDisplayString(t.title),1)]))}}),Kn={props:{on:{type:String,required:!0}},setup(t,{emit:n,slots:o}){const i=e.inject("ServiceContainer"),s=e.ref(!1),{t:r}=i.i18n;let l=null;const c=()=>{clearTimeout(l),s.value=!0,l=setTimeout(()=>{s.value=!1},2e3)};return e.onMounted(()=>{i.emitter.on(t.on,c)}),e.onUnmounted(()=>{clearTimeout(l)}),{shown:s,t:r}}},Gn=(t,n)=>{const o=t.__vccOpts||t;for(const[i,s]of n)o[i]=s;return o},Xn={key:1};function Qn(t,n,o,i,s,r){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__action-message",{"vuefinder__action-message--hidden":!i.shown}])},[t.$slots.default?e.renderSlot(t.$slots,"default",{key:0}):(e.openBlock(),e.createElementBlock("span",Xn,e.toDisplayString(i.t("Saved.")),1))],2)}const xe=Gn(Kn,[["render",Qn]]),Zn={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"h-6 w-6 stroke-blue-600 dark:stroke-blue-100",viewBox:"0 0 24 24"};function Jn(t,n){return e.openBlock(),e.createElementBlock("svg",Zn,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87q.11.06.22.127c.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a8 8 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a7 7 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a7 7 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a7 7 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124q.108-.066.22-.128c.332-.183.582-.495.644-.869z"},null,-1),e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0"},null,-1)])])}const eo={render:Jn},to={class:"vuefinder__about-modal__content"},no={class:"vuefinder__about-modal__main"},oo={class:"vuefinder__about-modal__tabs","aria-label":"Tabs"},io=["onClick","aria-current"],ro={key:0,class:"vuefinder__about-modal__tab-content"},so={class:"vuefinder__about-modal__description"},ao={href:"https://vuefinder.ozdemir.be",class:"vuefinder__about-modal__link",target:"_blank"},lo={href:"https://github.com/n1crack/vuefinder",class:"vuefinder__about-modal__link",target:"_blank"},co={key:1,class:"vuefinder__about-modal__tab-content"},uo={class:"vuefinder__about-modal__description"},ho={class:"vuefinder__about-modal__settings"},mo={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},fo={class:"vuefinder__about-modal__setting-input"},po=["checked"],vo={class:"vuefinder__about-modal__setting-label"},go={for:"metric_unit",class:"vuefinder__about-modal__label"},_o={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},wo={class:"vuefinder__about-modal__setting-input"},bo=["checked"],ko={class:"vuefinder__about-modal__setting-label"},yo={for:"large_icons",class:"vuefinder__about-modal__label"},Eo={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},So={class:"vuefinder__about-modal__setting-input"},xo=["checked"],Co={class:"vuefinder__about-modal__setting-label"},Bo={for:"persist_path",class:"vuefinder__about-modal__label"},Vo={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},No={class:"vuefinder__about-modal__setting-input"},Mo=["checked"],$o={class:"vuefinder__about-modal__setting-label"},Ao={for:"show_thumbnails",class:"vuefinder__about-modal__label"},Do={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},zo={class:"vuefinder__about-modal__setting-input"},Ro={for:"theme",class:"vuefinder__about-modal__label"},To={class:"vuefinder__about-modal__setting-label"},Io=["label"],Lo=["value"],Fo={key:0,class:"vuefinder__about-modal__setting"},Ho={class:"vuefinder__about-modal__setting-input"},Po={for:"language",class:"vuefinder__about-modal__label"},Oo={class:"vuefinder__about-modal__setting-label"},jo=["label"],Wo=["value"],Uo={key:2,class:"vuefinder__about-modal__tab-content"},qo={class:"vuefinder__about-modal__shortcuts"},Yo={class:"vuefinder__about-modal__shortcut"},Ko={class:"vuefinder__about-modal__shortcut"},Go={class:"vuefinder__about-modal__shortcut"},Xo={class:"vuefinder__about-modal__shortcut"},Qo={class:"vuefinder__about-modal__shortcut"},Zo={class:"vuefinder__about-modal__shortcut"},Jo={class:"vuefinder__about-modal__shortcut"},ei={class:"vuefinder__about-modal__shortcut"},ti={class:"vuefinder__about-modal__shortcut"},ni={class:"vuefinder__about-modal__shortcut"},oi={key:3,class:"vuefinder__about-modal__tab-content"},ii={class:"vuefinder__about-modal__description"},At=e.defineComponent({__name:"ModalAbout",setup(t){const n=e.inject("ServiceContainer"),o=n.config,{clearStore:i}=n.storage,{t:s}=n.i18n,r={ABOUT:"about",SETTINGS:"settings",SHORTCUTS:"shortcuts",RESET:"reset"},l=e.computed(()=>[{name:s("About"),key:r.ABOUT,current:!1},{name:s("Settings"),key:r.SETTINGS,current:!1},{name:s("Shortcuts"),key:r.SHORTCUTS,current:!1},{name:s("Reset"),key:r.RESET,current:!1}]),c=e.ref("about"),a=async()=>{o.reset(),i(),location.reload()},h=k=>{n.theme.set(k),n.emitter.emit("vf-theme-saved")},d=()=>{o.toggle("metricUnits"),n.filesize=o.get("metricUnits")?$t:Mt,n.emitter.emit("vf-metric-units-saved")},u=()=>{o.toggle("compactListView"),n.emitter.emit("vf-compact-view-saved")},m=()=>{o.toggle("showThumbnails"),n.emitter.emit("vf-show-thumbnails-saved")},f=()=>{o.toggle("persist"),n.emitter.emit("vf-persist-path-saved")},{i18n:v}=e.inject("VueFinderOptions"),_=Object.fromEntries(Object.entries({ar:"Arabic (العربيّة)",en:"English",fr:"French (Français)",de:"German (Deutsch)",fa:"Persian (فارسی)",he:"Hebrew (עִברִית)",hi:"Hindi (हिंदी)",pl:"Polish (Polski)",ru:"Russian (Pусский)",sv:"Swedish (Svenska)",tr:"Turkish (Türkçe)",nl:"Dutch (Nederlands)",zhCN:"Simplified Chinese (简体中文)",zhTW:"Traditional Chinese (繁體中文)"}).filter(([k])=>Object.keys(v).includes(k))),g=e.computed(()=>({system:s("System"),light:s("Light"),dark:s("Dark")}));return(k,S)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:S[3]||(S[3]=N=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(s)("Close")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",to,[e.createVNode(ge,{icon:e.unref(eo),title:"Vuefinder "+e.unref(n).version},null,8,["icon","title"]),e.createElementVNode("div",no,[e.createElementVNode("div",null,[e.createElementVNode("div",null,[e.createElementVNode("nav",oo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,N=>(e.openBlock(),e.createElementBlock("button",{key:N.name,onClick:O=>c.value=N.key,class:e.normalizeClass([N.key===c.value?"vuefinder__about-modal__tab--active":"vuefinder__about-modal__tab--inactive","vuefinder__about-modal__tab"]),"aria-current":N.current?"page":void 0},e.toDisplayString(N.name),11,io))),128))])])]),c.value===r.ABOUT?(e.openBlock(),e.createElementBlock("div",ro,[e.createElementVNode("div",so,e.toDisplayString(e.unref(s)("Vuefinder is a simple, lightweight, and fast file manager library for Vue.js applications")),1),e.createElementVNode("a",ao,e.toDisplayString(e.unref(s)("Project home")),1),e.createElementVNode("a",lo,e.toDisplayString(e.unref(s)("Follow on GitHub")),1)])):e.createCommentVNode("",!0),c.value===r.SETTINGS?(e.openBlock(),e.createElementBlock("div",co,[e.createElementVNode("div",uo,e.toDisplayString(e.unref(s)("Customize your experience with the following settings")),1),e.createElementVNode("div",ho,[e.createElementVNode("fieldset",null,[e.createElementVNode("div",mo,[e.createElementVNode("div",fo,[e.createElementVNode("input",{id:"metric_unit",name:"metric_unit",type:"checkbox",checked:e.unref(o).get("metricUnits"),onChange:d,class:"vuefinder__about-modal__checkbox"},null,40,po)]),e.createElementVNode("div",vo,[e.createElementVNode("label",go,[e.createTextVNode(e.toDisplayString(e.unref(s)("Use Metric Units"))+" ",1),e.createVNode(xe,{class:"ms-3",on:"vf-metric-units-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",_o,[e.createElementVNode("div",wo,[e.createElementVNode("input",{id:"large_icons",name:"large_icons",type:"checkbox",checked:e.unref(o).get("compactListView"),onChange:u,class:"vuefinder__about-modal__checkbox"},null,40,bo)]),e.createElementVNode("div",ko,[e.createElementVNode("label",yo,[e.createTextVNode(e.toDisplayString(e.unref(s)("Compact list view"))+" ",1),e.createVNode(xe,{class:"ms-3",on:"vf-compact-view-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",Eo,[e.createElementVNode("div",So,[e.createElementVNode("input",{id:"persist_path",name:"persist_path",type:"checkbox",checked:e.unref(o).get("persist"),onChange:f,class:"vuefinder__about-modal__checkbox"},null,40,xo)]),e.createElementVNode("div",Co,[e.createElementVNode("label",Bo,[e.createTextVNode(e.toDisplayString(e.unref(s)("Persist path on reload"))+" ",1),e.createVNode(xe,{class:"ms-3",on:"vf-persist-path-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",Vo,[e.createElementVNode("div",No,[e.createElementVNode("input",{id:"show_thumbnails",name:"show_thumbnails",type:"checkbox",checked:e.unref(o).get("showThumbnails"),onChange:m,class:"vuefinder__about-modal__checkbox"},null,40,Mo)]),e.createElementVNode("div",$o,[e.createElementVNode("label",Ao,[e.createTextVNode(e.toDisplayString(e.unref(s)("Show thumbnails"))+" ",1),e.createVNode(xe,{class:"ms-3",on:"vf-show-thumbnails-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",Do,[e.createElementVNode("div",zo,[e.createElementVNode("label",Ro,e.toDisplayString(e.unref(s)("Theme")),1)]),e.createElementVNode("div",To,[e.withDirectives(e.createElementVNode("select",{id:"theme","onUpdate:modelValue":S[0]||(S[0]=N=>e.unref(n).theme.value=N),onChange:S[1]||(S[1]=N=>h(N.target?.value||"")),class:"vuefinder__about-modal__select"},[e.createElementVNode("optgroup",{label:e.unref(s)("Theme")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,(N,O)=>(e.openBlock(),e.createElementBlock("option",{value:O},e.toDisplayString(N),9,Lo))),256))],8,Io)],544),[[e.vModelSelect,e.unref(n).theme.value]]),e.createVNode(xe,{class:"ms-3",on:"vf-theme-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("Saved.")),1)]),_:1})])]),e.unref(n).features.includes(e.unref(W).LANGUAGE)&&Object.keys(e.unref(_)).length>1?(e.openBlock(),e.createElementBlock("div",Fo,[e.createElementVNode("div",Ho,[e.createElementVNode("label",Po,e.toDisplayString(e.unref(s)("Language")),1)]),e.createElementVNode("div",Oo,[e.withDirectives(e.createElementVNode("select",{id:"language","onUpdate:modelValue":S[2]||(S[2]=N=>e.unref(n).i18n.locale=N),class:"vuefinder__about-modal__select"},[e.createElementVNode("optgroup",{label:e.unref(s)("Language")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),(N,O)=>(e.openBlock(),e.createElementBlock("option",{value:O},e.toDisplayString(N),9,Wo))),256))],8,jo)],512),[[e.vModelSelect,e.unref(n).i18n.locale]]),e.createVNode(xe,{class:"ms-3",on:"vf-language-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)("Saved.")),1)]),_:1})])])):e.createCommentVNode("",!0)])])])):e.createCommentVNode("",!0),c.value===r.SHORTCUTS?(e.openBlock(),e.createElementBlock("div",Uo,[e.createElementVNode("div",qo,[e.createElementVNode("div",Yo,[e.createElementVNode("div",null,e.toDisplayString(e.unref(s)("Rename")),1),S[4]||(S[4]=e.createElementVNode("kbd",null,"F2",-1))]),e.createElementVNode("div",Ko,[e.createElementVNode("div",null,e.toDisplayString(e.unref(s)("Refresh")),1),S[5]||(S[5]=e.createElementVNode("kbd",null,"F5",-1))]),e.createElementVNode("div",Go,[e.createTextVNode(e.toDisplayString(e.unref(s)("Delete"))+" ",1),S[6]||(S[6]=e.createElementVNode("kbd",null,"Del",-1))]),e.createElementVNode("div",Xo,[e.createTextVNode(e.toDisplayString(e.unref(s)("Escape"))+" ",1),S[7]||(S[7]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Esc")],-1))]),e.createElementVNode("div",Qo,[e.createTextVNode(e.toDisplayString(e.unref(s)("Select All"))+" ",1),S[8]||(S[8]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"A")],-1))]),e.createElementVNode("div",Zo,[e.createTextVNode(e.toDisplayString(e.unref(s)("Search"))+" ",1),S[9]||(S[9]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"F")],-1))]),e.createElementVNode("div",Jo,[e.createTextVNode(e.toDisplayString(e.unref(s)("Toggle Sidebar"))+" ",1),S[10]||(S[10]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"E")],-1))]),e.createElementVNode("div",ei,[e.createTextVNode(e.toDisplayString(e.unref(s)("Open Settings"))+" ",1),S[11]||(S[11]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,",")],-1))]),e.createElementVNode("div",ti,[e.createTextVNode(e.toDisplayString(e.unref(s)("Toggle Full Screen"))+" ",1),S[12]||(S[12]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"Enter")],-1))]),e.createElementVNode("div",ni,[e.createTextVNode(e.toDisplayString(e.unref(s)("Preview"))+" ",1),S[13]||(S[13]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Space")],-1))])])])):e.createCommentVNode("",!0),c.value===r.RESET?(e.openBlock(),e.createElementBlock("div",oi,[e.createElementVNode("div",ii,e.toDisplayString(e.unref(s)("Reset all settings to default")),1),e.createElementVNode("button",{onClick:a,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(s)("Reset Settings")),1)])):e.createCommentVNode("",!0)])])]),_:1}))}}),ri={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function si(t,n){return e.openBlock(),e.createElementBlock("svg",ri,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21q.512.078 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48 48 0 0 0-3.478-.397m-12 .562q.51-.089 1.022-.165m0 0a48 48 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a52 52 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a49 49 0 0 0-7.5 0"},null,-1)])])}const Dt={render:si},ai={class:"vuefinder__delete-modal__content"},li={class:"vuefinder__delete-modal__form"},ci={class:"vuefinder__delete-modal__description"},ui={class:"vuefinder__delete-modal__files vf-scrollbar"},di={class:"vuefinder__delete-modal__file"},hi={key:0,class:"vuefinder__delete-modal__icon vuefinder__delete-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},mi={key:1,class:"vuefinder__delete-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},fi={class:"vuefinder__delete-modal__file-name"},pi={class:"vuefinder__delete-modal__warning"},ut=e.defineComponent({__name:"ModalDelete",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=R.useStore(i.path),r=e.ref(n.modal.data.items),l=e.ref(""),c=()=>{r.value.length&&n.emitter.emit("vf-fetch",{params:{q:"delete",m:"post",storage:s.value.storage,path:s.value.path},body:{items:r.value.map(({path:a,type:h})=>({path:a,type:h}))},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:o("Files deleted.")})},onError:a=>{l.value=o(a.message)}})};return(a,h)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:c,class:"vf-btn vf-btn-danger"},e.toDisplayString(e.unref(o)("Yes, Delete!")),1),e.createElementVNode("button",{type:"button",onClick:h[1]||(h[1]=d=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1),e.createElementVNode("div",pi,e.toDisplayString(e.unref(o)("This action cannot be undone.")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(Dt),title:e.unref(o)("Delete files")},null,8,["icon","title"]),e.createElementVNode("div",ai,[e.createElementVNode("div",li,[e.createElementVNode("p",ci,e.toDisplayString(e.unref(o)("Are you sure you want to delete these files?")),1),e.createElementVNode("div",ui,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,d=>(e.openBlock(),e.createElementBlock("p",di,[d.type==="dir"?(e.openBlock(),e.createElementBlock("svg",hi,[...h[2]||(h[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",mi,[...h[3]||(h[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",fi,e.toDisplayString(d.basename),1)]))),256))]),l.value.length?(e.openBlock(),e.createBlock(e.unref(l),{key:0,onHidden:h[0]||(h[0]=d=>l.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),vi={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function gi(t,n){return e.openBlock(),e.createElementBlock("svg",vi,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"},null,-1)])])}const zt={render:gi},_i={class:"vuefinder__rename-modal__content"},wi={class:"vuefinder__rename-modal__item"},bi={class:"vuefinder__rename-modal__item-info"},ki={key:0,class:"vuefinder__rename-modal__icon vuefinder__rename-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},yi={key:1,class:"vuefinder__rename-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},Ei={class:"vuefinder__rename-modal__item-name"},dt=e.defineComponent({__name:"ModalRename",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=R.useStore(i.path),r=e.ref(n.modal.data.items[0]),l=e.ref(n.modal.data.items[0].basename),c=e.ref(""),a=()=>{l.value!=""&&n.emitter.emit("vf-fetch",{params:{q:"rename",m:"post",storage:s.value.storage,path:s.value.path},body:{item:r.value.path,name:l.value},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:o("%s is renamed.",l.value)})},onError:h=>{c.value=o(h.message)}})};return(h,d)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:a,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Rename")),1),e.createElementVNode("button",{type:"button",onClick:d[2]||(d[2]=u=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(zt),title:e.unref(o)("Rename")},null,8,["icon","title"]),e.createElementVNode("div",_i,[e.createElementVNode("div",wi,[e.createElementVNode("p",bi,[r.value.type==="dir"?(e.openBlock(),e.createElementBlock("svg",ki,[...d[3]||(d[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",yi,[...d[4]||(d[4]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",Ei,e.toDisplayString(r.value.basename),1)]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":d[0]||(d[0]=u=>l.value=u),onKeyup:e.withKeys(a,["enter"]),class:"vuefinder__rename-modal__input",placeholder:"Name",type:"text"},null,544),[[e.vModelText,l.value]]),c.value.length?(e.openBlock(),e.createBlock(e.unref(c),{key:0,onHidden:d[1]||(d[1]=u=>c.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),Si=["title"],Rt=e.defineComponent({__name:"Message",props:{error:{type:Boolean}},emits:["hidden"],setup(t,{emit:n}){const o=n,i=e.inject("ServiceContainer"),{t:s}=i.i18n,r=e.ref(!1),l=e.ref(null),c=e.ref(l.value?.innerHTML);e.watch(c,()=>r.value=!1);const a=()=>{o("hidden"),r.value=!0};return(h,d)=>(e.openBlock(),e.createElementBlock("div",null,[r.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"strMessage",ref:l,class:e.normalizeClass(["vuefinder__message",t.error?"vuefinder__message--error":"vuefinder__message--success"])},[e.renderSlot(h.$slots,"default"),e.createElementVNode("div",{class:"vuefinder__message__close",onClick:a,title:e.unref(s)("Close")},[...d[0]||(d[0]=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"vuefinder__message__icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Si)],2))]))}}),xi={class:"vuefinder__text-preview"},Ci={class:"vuefinder__text-preview__header"},Bi=["title"],Vi={class:"vuefinder__text-preview__actions"},Ni={key:0,class:"vuefinder__text-preview__content"},Mi={key:1},$i=e.defineComponent({__name:"Text",emits:["success"],setup(t,{emit:n}){const o=n,i=e.ref(""),s=e.ref(""),r=e.ref(null),l=e.ref(!1),c=e.ref(""),a=e.ref(!1),h=e.inject("ServiceContainer"),{t:d}=h.i18n;e.onMounted(()=>{h.requester.send({url:"",method:"get",params:{q:"preview",storage:h.modal.data.storage,adapter:h.modal.data.storage,path:h.modal.data.item.path},responseType:"text"}).then(f=>{i.value=f,o("success")})});const u=()=>{l.value=!l.value,s.value=i.value},m=()=>{c.value="",a.value=!1,h.requester.send({url:"",method:"post",params:{q:"save",storage:h.modal.data.storage,adapter:h.modal.data.storage,path:h.modal.data.item.path},body:{content:s.value},responseType:"text"}).then(f=>{c.value=d("Updated."),i.value=f,o("success"),l.value=!l.value}).catch(f=>{c.value=d(f.message),a.value=!0})};return(f,v)=>(e.openBlock(),e.createElementBlock("div",xi,[e.createElementVNode("div",Ci,[e.createElementVNode("div",{class:"vuefinder__text-preview__title",id:"modal-title",title:e.unref(h).modal.data.item.path},e.toDisplayString(e.unref(h).modal.data.item.basename),9,Bi),e.createElementVNode("div",Vi,[l.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:m,class:"vuefinder__text-preview__save-button"},e.toDisplayString(e.unref(d)("Save")),1)):e.createCommentVNode("",!0),e.unref(h).features.includes(e.unref(W).EDIT)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"vuefinder__text-preview__edit-button",onClick:v[0]||(v[0]=p=>u())},e.toDisplayString(l.value?e.unref(d)("Cancel"):e.unref(d)("Edit")),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",null,[l.value?(e.openBlock(),e.createElementBlock("div",Mi,[e.withDirectives(e.createElementVNode("textarea",{ref_key:"editInput",ref:r,"onUpdate:modelValue":v[1]||(v[1]=p=>s.value=p),class:"vuefinder__text-preview__textarea",name:"text",cols:"30",rows:"10"},null,512),[[e.vModelText,s.value]])])):(e.openBlock(),e.createElementBlock("pre",Ni,e.toDisplayString(i.value),1)),c.value.length?(e.openBlock(),e.createBlock(Rt,{key:2,onHidden:v[2]||(v[2]=p=>c.value=""),error:a.value},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1},8,["error"])):e.createCommentVNode("",!0)])]))}});function _t(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),o.push.apply(o,i)}return o}function H(t){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?_t(Object(o),!0).forEach((function(i){ae(t,i,o[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):_t(Object(o)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(o,i))}))}return t}function ae(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function Ai(t,n){if(t==null)return{};var o,i,s=(function(l,c){if(l==null)return{};var a,h,d={},u=Object.keys(l);for(h=0;h<u.length;h++)a=u[h],c.indexOf(a)>=0||(d[a]=l[a]);return d})(t,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)o=r[i],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(s[o]=t[o])}return s}function Se(t){return(function(n){if(Array.isArray(n))return Ke(n)})(t)||(function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)})(t)||(function(n,o){if(n){if(typeof n=="string")return Ke(n,o);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ke(n,o)}})(t)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function Ke(t,n){(n==null||n>t.length)&&(n=t.length);for(var o=0,i=new Array(n);o<n;o++)i[o]=t[o];return i}var wt,Di,ze,K=(wt=function(t){/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var n={}.hasOwnProperty;function o(){for(var i=[],s=0;s<arguments.length;s++){var r=arguments[s];if(r){var l=typeof r;if(l==="string"||l==="number")i.push(r);else if(Array.isArray(r)){if(r.length){var c=o.apply(null,r);c&&i.push(c)}}else if(l==="object")if(r.toString===Object.prototype.toString)for(var a in r)n.call(r,a)&&r[a]&&i.push(a);else i.push(r.toString())}}return i.join(" ")}t.exports?(o.default=o,t.exports=o):window.classNames=o})()},wt(ze={path:Di,exports:{},require:function(t,n){return(function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")})(n==null&&ze.path)}},ze.exports),ze.exports),ce=function(t){return function(n,o){if(!n)return t;var i;typeof n=="string"?i=n:o=n;var s=t;return i&&(s+="__"+i),s+(o?Object.keys(o).reduce((function(r,l){var c=o[l];return c&&(r+=" "+(typeof c=="boolean"?s+"--"+l:s+"--"+l+"_"+c)),r}),""):"")}};function nt(t,n,o){var i,s,r,l,c;function a(){var d=Date.now()-l;d<n&&d>=0?i=setTimeout(a,n-d):(i=null,o||(c=t.apply(r,s),r=s=null))}n==null&&(n=100);var h=function(){r=this,s=arguments,l=Date.now();var d=o&&!i;return i||(i=setTimeout(a,n)),d&&(c=t.apply(r,s),r=s=null),c};return h.clear=function(){i&&(clearTimeout(i),i=null)},h.flush=function(){i&&(c=t.apply(r,s),r=s=null,clearTimeout(i),i=null)},h}nt.debounce=nt;var ot=nt,B=function(){return B=Object.assign||function(t){for(var n,o=1,i=arguments.length;o<i;o++)for(var s in n=arguments[o])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t},B.apply(this,arguments)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Tt(t,n){var o,i;return t&&n?(o=""+t+n[0].toUpperCase()+n.slice(1),i=t+"-"+n):(o=t||n,i=t||n),{name:o,classname:i}}function It(t){return/^blob:/.test(t)}function bt(t){return It(t)||(function(n){return/^data:/.test(n)})(t)}function Ce(t){return!!(t&&t.constructor&&t.call&&t.apply)}function X(t){return t===void 0}function He(t){return typeof t=="object"&&t!==null}function it(t,n,o){var i={};return He(t)?(Object.keys(n).forEach((function(s){X(t[s])?i[s]=n[s]:He(n[s])?He(t[s])?i[s]=it(t[s],n[s],o[s]):i[s]=t[s]?n[s]:o[s]:n[s]===!0||n[s]===!1?i[s]=!!t[s]:i[s]=t[s]})),i):t?n:o}function Re(t){var n=Number(t);return Number.isNaN(n)?t:n}function kt(t){return typeof(t=="number"||(function(n){return typeof n=="object"&&n!==null})(t)&&toString.call(t)=="[object Number]")&&!Lt(t)}function Lt(t){return t!=t}function Ft(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}var $e=function(t,n){t===void 0&&(t={}),n===void 0&&(n={}),this.type="manipulateImage",this.move=t,this.scale=n},zi=function(t,n){n===void 0&&(n={}),this.type="resize",this.directions=t,this.params=n},ht=function(t){this.type="move",this.directions=t},Ri=(function(){function t(n,o,i,s,r){this.type="drag",this.nativeEvent=n,this.position=i,this.previousPosition=s,this.element=o,this.anchor=r}return t.prototype.shift=function(){var n=this,o=n.element,i=n.anchor,s=n.position;if(o){var r=o.getBoundingClientRect(),l=r.left,c=r.top;return{left:s.left-l-i.left,top:s.top-c-i.top}}return{left:0,top:0}},t})(),mt={name:"DraggableElement",props:{classname:{type:String}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){if(!this.$refs.draggable)throw new Error('You should add ref "draggable" to your root element to use draggable mixin');this.touches=[],this.hovered=!1},methods:{onMouseOver:function(){this.hovered||(this.hovered=!0,this.$emit("enter"))},onMouseLeave:function(){this.hovered&&!this.touches.length&&(this.hovered=!1,this.$emit("leave"))},onTouchStart:function(t){t.cancelable&&!this.disabled&&t.touches.length===1&&(this.touches=Se(t.touches),this.hovered||(this.$emit("enter"),this.hovered=!0),t.touches.length&&this.initAnchor(this.touches.reduce((function(n,o){return{clientX:n.clientX+o.clientX/t.touches.length,clientY:n.clientY+o.clientY/t.touches.length}}),{clientX:0,clientY:0})),t.preventDefault&&t.preventDefault(),t.stopPropagation())},onTouchEnd:function(){this.processEnd()},onTouchMove:function(t){this.touches.length&&(this.processMove(t,t.touches),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())},onMouseDown:function(t){if(!this.disabled){var n={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[n],this.initAnchor(n),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.preventDefault())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var n=this.$refs.draggable.getBoundingClientRect(),o=n.left,i=n.right,s=n.bottom,r=n.top;this.anchor={left:t.clientX-o,top:t.clientY-r,bottom:s-t.clientY,right:i-t.clientX}},processMove:function(t,n){var o=Se(n);if(this.touches.length){if(this.touches.length===1&&o.length===1){var i=this.$refs.draggable;this.$emit("drag",new Ri(t,i,{left:o[0].clientX,top:o[0].clientY},{left:this.touches[0].clientX,top:this.touches[0].clientY},this.anchor))}this.touches=o}},processEnd:function(){this.touches.length&&this.$emit("drag-end"),this.hovered&&(this.$emit("leave"),this.hovered=!1),this.touches=[]}},emits:["drag","drag-end","leave","enter"]};mt.render=function(t,n,o,i,s,r){return e.openBlock(),e.createBlock("div",{ref:"draggable",class:o.classname,onTouchstart:n[1]||(n[1]=function(){return r.onTouchStart&&r.onTouchStart.apply(r,arguments)}),onMousedown:n[2]||(n[2]=function(){return r.onMouseDown&&r.onMouseDown.apply(r,arguments)}),onMouseover:n[3]||(n[3]=function(){return r.onMouseOver&&r.onMouseOver.apply(r,arguments)}),onMouseleave:n[4]||(n[4]=function(){return r.onMouseLeave&&r.onMouseLeave.apply(r,arguments)})},[e.renderSlot(t.$slots,"default")],34)};var Ge=ce("vue-handler-wrapper"),Ht={name:"HandlerWrapper",components:{DraggableElement:mt},props:{horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},computed:{classes:function(){var t;if(this.horizontalPosition||this.verticalPosition){var n,o=Tt(this.horizontalPosition,this.verticalPosition);t=Ge((ae(n={},o.classname,!0),ae(n,"disabled",this.disabled),n))}else t=Ge({disabled:this.disabled});return{root:t,draggable:Ge("draggable")}}},emits:["leave","enter","drag","drag-end"]};Ht.render=function(t,n,o,i,s,r){var l=e.resolveComponent("DraggableElement");return e.openBlock(),e.createBlock("div",{class:r.classes.root},[e.createVNode(l,{class:r.classes.draggable,onDrag:n[1]||(n[1]=function(c){return t.$emit("drag",c)}),onDragEnd:n[2]||(n[2]=function(c){return t.$emit("drag-end")}),onLeave:n[3]||(n[3]=function(c){return t.$emit("leave")}),onEnter:n[4]||(n[4]=function(c){return t.$emit("enter")})},{default:e.withCtx((function(){return[e.renderSlot(t.$slots,"default")]})),_:3},8,["class"])],2)};var Ti=ce("vue-line-wrapper"),Pt={name:"LineWrapper",components:{DraggableElement:mt},props:{position:{type:String,required:!0},disabled:{type:Boolean,default:!1}},computed:{classname:function(){var t;return Ti((ae(t={},this.position,!0),ae(t,"disabled",this.disabled),t))}},emits:["leave","enter","drag","drag-end"]};Pt.render=function(t,n,o,i,s,r){var l=e.resolveComponent("DraggableElement");return e.openBlock(),e.createBlock(l,{class:r.classname,onDrag:n[1]||(n[1]=function(c){return t.$emit("drag",c)}),onDragEnd:n[2]||(n[2]=function(c){return t.$emit("drag-end")}),onLeave:n[3]||(n[3]=function(c){return t.$emit("leave")}),onEnter:n[4]||(n[4]=function(c){return t.$emit("enter")})},{default:e.withCtx((function(){return[e.renderSlot(t.$slots,"default")]})),_:3},8,["class"])};var de=["left","right","top","bottom"],Ii=["left","right"],Li=["top","bottom"],Fi=["left","top"],Hi=["fill-area","fit-area","stencil","none"],yt={left:0,top:0,width:0,height:0};function Et(t,n,o){return!(o=o||["width","height","left","top"]).some((function(i){return t[i]!==n[i]}))}function he(t){return{left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height}}function Be(t,n){return{left:t.left-n.left,top:t.top-n.top}}function J(t){return{left:t.left+t.width/2,top:t.top+t.height/2}}function Ae(t,n){var o={left:0,top:0,right:0,bottom:0};return de.forEach((function(i){var s=n[i],r=he(t)[i];o[i]=s!==void 0&&r!==void 0?i==="left"||i==="top"?Math.max(0,s-r):Math.max(0,r-s):0})),o}function ue(t,n){return{left:t.left-n.left,top:t.top-n.top,width:t.width+n.left+n.right,height:t.height+n.top+n.bottom}}function Pe(t){return{left:-t.left,top:-t.top}}function re(t,n){return B(B({},t),{left:t.left+n.left,top:t.top+n.top})}function le(t,n,o,i){if(n!==1){if(o){var s=J(t);return{width:t.width*n,height:t.height*n,left:t.left+t.width*(1-n)/2+(o.left-s.left)*(1-n),top:t.top+t.height*(1-n)/2+(o.top-s.top)*(1-n)}}return{width:t.width*n,height:t.height*n,left:t.left+t.width*(1-n)/2,top:t.top+t.height*(1-n)/2}}return t}function P(t){return t.width/t.height}function Ve(t,n){return Math.min(n.right!==void 0&&n.left!==void 0?(n.right-n.left)/t.width:1/0,n.bottom!==void 0&&n.top!==void 0?(n.bottom-n.top)/t.height:1/0)}function Ne(t,n){var o={left:0,top:0},i=Ae(t,n);return i.left&&i.left>0?o.left=i.left:i.right&&i.right>0&&(o.left=-i.right),i.top&&i.top>0?o.top=i.top:i.bottom&&i.bottom>0&&(o.top=-i.bottom),o}function Xe(t,n){var o;return n.minimum&&t<n.minimum?o=n.minimum:n.maximum&&t>n.maximum&&(o=n.maximum),o}function Ot(t,n){var o=P(t),i=P(n);return n.width<1/0&&n.height<1/0?o>i?{width:n.width,height:n.width/o}:{width:n.height*o,height:n.height}:n.width<1/0?{width:n.width,height:n.width/o}:n.height<1/0?{width:n.height*o,height:n.height}:t}function jt(t,n){var o=n*Math.PI/180;return{width:Math.abs(t.width*Math.cos(o))+Math.abs(t.height*Math.sin(o)),height:Math.abs(t.width*Math.sin(o))+Math.abs(t.height*Math.cos(o))}}function ke(t,n){var o=n*Math.PI/180;return{left:t.left*Math.cos(o)-t.top*Math.sin(o),top:t.left*Math.sin(o)+t.top*Math.cos(o)}}function Oe(t,n){var o=Ae(ee(t,n),n);return o.left+o.right+o.top+o.bottom?o.left+o.right>o.top+o.bottom?Math.min((t.width+o.left+o.right)/t.width,Ve(t,n)):Math.min((t.height+o.top+o.bottom)/t.height,Ve(t,n)):1}function ee(t,n,o){o===void 0&&(o=!1);var i=Ne(t,n);return re(t,o?Pe(i):i)}function rt(t){return{width:t.right!==void 0&&t.left!==void 0?t.right-t.left:1/0,height:t.bottom!==void 0&&t.top!==void 0?t.bottom-t.top:1/0}}function Pi(t,n){return B(B({},t),{minWidth:Math.min(n.width,t.minWidth),minHeight:Math.min(n.height,t.minHeight),maxWidth:Math.min(n.width,t.maxWidth),maxHeight:Math.min(n.height,t.maxHeight)})}function Wt(t,n,o){o===void 0&&(o=!0);var i={};return de.forEach((function(s){var r=t[s],l=n[s];r!==void 0&&l!==void 0?i[s]=s==="left"||s==="top"?o?Math.max(r,l):Math.min(r,l):o?Math.min(r,l):Math.max(r,l):l!==void 0?i[s]=l:r!==void 0&&(i[s]=r)})),i}function je(t,n){return Wt(t,n,!0)}function St(t){var n=t.size,o=t.aspectRatio,i=t.ignoreMinimum,s=t.sizeRestrictions;return!!((n.correctRatio||P(n)>=o.minimum&&P(n)<=o.maximum)&&n.height<=s.maxHeight&&n.width<=s.maxWidth&&n.width&&n.height&&(i||n.height>=s.minHeight&&n.width>=s.minWidth))}function xt(t,n){return Math.pow(t.width-n.width,2)+Math.pow(t.height-n.height,2)}function ve(t){var n=t.width,o=t.height,i=t.sizeRestrictions,s={minimum:t.aspectRatio&&t.aspectRatio.minimum||0,maximum:t.aspectRatio&&t.aspectRatio.maximum||1/0},r={width:Math.max(i.minWidth,Math.min(i.maxWidth,n)),height:Math.max(i.minHeight,Math.min(i.maxHeight,o))};function l(h,d){return d===void 0&&(d=!1),h.reduce((function(u,m){return St({size:m,aspectRatio:s,sizeRestrictions:i,ignoreMinimum:d})&&(!u||xt(m,{width:n,height:o})<xt(u,{width:n,height:o}))?m:u}),null)}var c=[];s&&[s.minimum,s.maximum].forEach((function(h){h&&c.push({width:r.width,height:r.width/h,correctRatio:!0},{width:r.height*h,height:r.height,correctRatio:!0})})),St({size:r,aspectRatio:s,sizeRestrictions:i})&&c.push(r);var a=l(c)||l(c,!0);return a&&{width:a.width,height:a.height}}function st(t){var n=t.event,o=t.coordinates,i=t.positionRestrictions,s=i===void 0?{}:i,r=re(o,n.directions);return re(r,Ne(r,s))}function Oi(t){var n=t.coordinates,o=t.transform,i=t.imageSize,s=t.sizeRestrictions,r=t.positionRestrictions,l=t.aspectRatio,c=t.visibleArea,a=function(d,u){return st({coordinates:d,positionRestrictions:r,event:new ht({left:u.left-d.left,top:u.top-d.top})})},h=B({},n);return(Array.isArray(o)?o:[o]).forEach((function(d){var u={};X((u=typeof d=="function"?d({coordinates:h,imageSize:i,visibleArea:c}):d).width)&&X(u.height)||(h=(function(m,f){var v=B(B(B({},m),ve({width:f.width,height:f.height,sizeRestrictions:s,aspectRatio:l})),{left:0,top:0});return a(v,{left:m.left,top:m.top})})(h,B(B({},h),u))),X(u.left)&&X(u.top)||(h=a(h,B(B({},h),u)))})),h}function ji(t){t.event;var n=t.getAreaRestrictions,o=t.boundaries,i=t.coordinates,s=t.visibleArea;t.aspectRatio;var r=t.stencilSize,l=t.sizeRestrictions,c=t.positionRestrictions;t.stencilReference;var a,h,d,u=B({},i),m=B({},s),f=B({},r);a=P(f),h=P(u),d===void 0&&(d=.001),(a===0||h===0?Math.abs(h-a)<d:Math.abs(h/a)<1+d&&Math.abs(h/a)>1-d)||(u=B(B({},u),ve({sizeRestrictions:l,width:u.width,height:u.height,aspectRatio:{minimum:P(f),maximum:P(f)}})));var v=Oe(m=le(m,u.width*o.width/(m.width*f.width)),n({visibleArea:m,type:"resize"}));return v!==1&&(m=le(m,v),u=le(u,v)),m=ee(m=re(m,Be(J(u),J(m))),n({visibleArea:m,type:"move"})),{coordinates:u=ee(u,je(he(m),c)),visibleArea:m}}function Wi(t){var n=t.event,o=t.getAreaRestrictions,i=t.boundaries,s=t.coordinates,r=t.visibleArea;t.aspectRatio,t.stencilSize,t.sizeRestrictions;var l=t.positionRestrictions;t.stencilReference;var c=B({},s),a=B({},r);if(s&&r&&n.type!=="manipulateImage"){var h={width:0,height:0};a.width,i.width,P(i)>P(c)?(h.height=.8*i.height,h.width=h.height*P(c)):(h.width=.8*i.width,h.height=h.width*P(c));var d=Oe(a=le(a,c.width*i.width/(a.width*h.width)),o({visibleArea:a,type:"resize"}));a=le(a,d),d!==1&&(h.height/=d,h.width/=d),a=ee(a=re(a,Be(J(c),J(a))),o({visibleArea:a,type:"move"})),c=ee(c,je(he(a),l))}return{coordinates:c,visibleArea:a}}function Ui(t){var n=t.event,o=t.coordinates,i=t.visibleArea,s=t.getAreaRestrictions,r=B({},i),l=B({},o);if(n.type==="setCoordinates"){var c=Math.max(0,l.width-r.width),a=Math.max(0,l.height-r.height);c>a?r=le(r,Math.min(l.width/r.width,Ve(r,s({visibleArea:r,type:"resize"})))):a>c&&(r=le(r,Math.min(l.height/r.height,Ve(r,s({visibleArea:r,type:"resize"}))))),r=ee(r=re(r,Pe(Ne(l,he(r)))),s({visibleArea:r,type:"move"}))}return{visibleArea:r,coordinates:l}}function qi(t){var n=t.imageSize,o=t.visibleArea,i=t.coordinates,s=o||n;return{left:(o?o.left:0)+s.width/2-i.width/2,top:(o?o.top:0)+s.height/2-i.height/2}}function Yi(t){var n=t.imageSize,o=t.visibleArea,i=t.aspectRatio,s=t.sizeRestrictions,r=o||n,l=Math.min(i.maximum||1/0,Math.max(i.minimum||0,P(r))),c=r.width<r.height?{width:.8*r.width,height:.8*r.width/l}:{height:.8*r.height,width:.8*r.height*l};return ve(B(B({},c),{aspectRatio:i,sizeRestrictions:s}))}function Ki(t){var n,o,i=t.imageSize,s=t.visibleArea,r=t.boundaries,l=t.aspectRatio,c=t.sizeRestrictions,a=t.stencilSize,h=s||i;return P(h)>P(r)?o=(n=a.height*h.height/r.height)*P(a):n=(o=a.width*h.width/r.width)/P(a),ve({width:o,height:n,aspectRatio:l,sizeRestrictions:c})}function Gi(t){var n=t.getAreaRestrictions,o=t.coordinates,i=t.imageSize,s=P(t.boundaries);if(o){var r={height:Math.max(o.height,i.height),width:Math.max(o.width,i.width)},l=Ot({width:P(r)>s?r.width:r.height*s,height:P(r)>s?r.width/s:r.height},rt(n())),c={left:o.left+o.width/2-l.width/2,top:o.top+o.height/2-l.height/2,width:l.width,height:l.height},a=Ae(o,he(B({left:0,top:0},i))),h={};return!a.left&&!a.right&&c.width<=i.width&&(h.left=0,h.right=i.width),!a.top&&!a.bottom&&c.height<=i.height&&(h.top=0,h.bottom=i.height),ee(c,h)}var d=P(i);return l={height:d>s?i.height:i.width/s,width:d>s?i.height*s:i.width},{left:i.width/2-l.width/2,top:i.height/2-l.height/2,width:l.width,height:l.height}}function Te(t,n){return Wt(t,he(n))}function Xi(t){var n=t.event,o=t.coordinates,i=t.visibleArea,s=t.sizeRestrictions,r=t.getAreaRestrictions,l=t.positionRestrictions,c=t.adjustStencil,a=n.scale,h=n.move,d=B({},i),u=B({},o),m=1,f=1,v=a.factor&&Math.abs(a.factor-1)>.001;d=re(d,{left:h.left||0,top:h.top||0});var p={stencil:{minimum:Math.max(s.minWidth?s.minWidth/u.width:0,s.minHeight?s.minHeight/u.height:0),maximum:Math.min(s.maxWidth?s.maxWidth/u.width:1/0,s.maxHeight?s.maxHeight/u.height:1/0,Ve(u,l))},area:{maximum:Ve(d,r({visibleArea:d,type:"resize"}))}};a.factor&&v&&(a.factor<1?(f=Math.max(a.factor,p.stencil.minimum))>1&&(f=1):a.factor>1&&(f=Math.min(a.factor,Math.min(p.area.maximum,p.stencil.maximum)))<1&&(f=1)),f&&(d=le(d,f,a.center));var _=o.left-i.left,g=i.width+i.left-(o.width+o.left),k=o.top-i.top,S=i.height+i.top-(o.height+o.top);return d=ee(d=re(d,Ne(d,{left:l.left!==void 0?l.left-_*f:void 0,top:l.top!==void 0?l.top-k*f:void 0,bottom:l.bottom!==void 0?l.bottom+S*f:void 0,right:l.right!==void 0?l.right+g*f:void 0})),r({visibleArea:d,type:"move"})),u.width=u.width*f,u.height=u.height*f,u.left=d.left+_*f,u.top=d.top+k*f,u=ee(u,je(he(d),l)),a.factor&&v&&c&&(a.factor>1?m=Math.min(p.area.maximum,a.factor)/f:a.factor<1&&(m=Math.max(u.height/d.height,u.width/d.width,a.factor/f)),m!==1&&(d=re(d=ee(d=le(d,m,a.factor>1?a.center:J(u)),r({visibleArea:d,type:"move"})),Pe(Ne(u,he(d)))))),{coordinates:u,visibleArea:d}}function Qi(t){var n=t.aspectRatio,o=t.getAreaRestrictions,i=t.coordinates,s=t.visibleArea,r=t.sizeRestrictions,l=t.positionRestrictions,c=t.imageSize,a=t.previousImageSize,h=t.angle,d=B({},i),u=B({},s),m=ke(J(B({left:0,top:0},a)),h);return(d=B(B({},ve({sizeRestrictions:r,aspectRatio:n,width:d.width,height:d.height})),ke(J(d),h))).left-=m.left-c.width/2+d.width/2,d.top-=m.top-c.height/2+d.height/2,u=le(u,Oe(u,o({visibleArea:u,type:"resize"}))),{coordinates:d=ee(d,l),visibleArea:u=ee(u=re(u,Be(J(d),J(i))),o({visibleArea:u,type:"move"}))}}function Zi(t){var n=t.flip,o=t.previousFlip,i=t.rotate,s=t.getAreaRestrictions,r=t.coordinates,l=t.visibleArea,c=t.imageSize,a=B({},r),h=B({},l),d=o.horizontal!==n.horizontal,u=o.vertical!==n.vertical;if(d||u){var m=ke({left:c.width/2,top:c.height/2},-i),f=ke(J(a),-i),v=ke({left:d?m.left-(f.left-m.left):f.left,top:u?m.top-(f.top-m.top):f.top},i);a=re(a,Be(v,J(a))),f=ke(J(h),-i),h=ee(h=re(h,Be(v=ke({left:d?m.left-(f.left-m.left):f.left,top:u?m.top-(f.top-m.top):f.top},i),J(h))),s({visibleArea:h,type:"move"}))}return{coordinates:a,visibleArea:h}}function Ct(t){var n=t.directions,o=t.coordinates,i=t.positionRestrictions,s=i===void 0?{}:i,r=t.sizeRestrictions,l=t.preserveRatio,c=t.compensate,a=B({},n),h=ue(o,a).width,d=ue(o,a).height;h<0&&(a.left<0&&a.right<0?(a.left=-(o.width-r.minWidth)/(a.left/a.right),a.right=-(o.width-r.minWidth)/(a.right/a.left)):a.left<0?a.left=-(o.width-r.minWidth):a.right<0&&(a.right=-(o.width-r.minWidth))),d<0&&(a.top<0&&a.bottom<0?(a.top=-(o.height-r.minHeight)/(a.top/a.bottom),a.bottom=-(o.height-r.minHeight)/(a.bottom/a.top)):a.top<0?a.top=-(o.height-r.minHeight):a.bottom<0&&(a.bottom=-(o.height-r.minHeight)));var u=Ae(ue(o,a),s);c&&(u.left&&u.left>0&&u.right===0?(a.right+=u.left,a.left-=u.left):u.right&&u.right>0&&u.left===0&&(a.left+=u.right,a.right-=u.right),u.top&&u.top>0&&u.bottom===0?(a.bottom+=u.top,a.top-=u.top):u.bottom&&u.bottom>0&&u.top===0&&(a.top+=u.bottom,a.bottom-=u.bottom),u=Ae(ue(o,a),s));var m={width:1/0,height:1/0,left:1/0,right:1/0,top:1/0,bottom:1/0};if(de.forEach((function(p){var _=u[p];_&&a[p]&&(m[p]=Math.max(0,1-_/a[p]))})),l){var f=Math.min.apply(null,de.map((function(p){return m[p]})));f!==1/0&&de.forEach((function(p){a[p]*=f}))}else de.forEach((function(p){m[p]!==1/0&&(a[p]*=m[p])}));if(h=ue(o,a).width,d=ue(o,a).height,a.right+a.left&&(h>r.maxWidth?m.width=(r.maxWidth-o.width)/(a.right+a.left):h<r.minWidth&&(m.width=(r.minWidth-o.width)/(a.right+a.left))),a.bottom+a.top&&(d>r.maxHeight?m.height=(r.maxHeight-o.height)/(a.bottom+a.top):d<r.minHeight&&(m.height=(r.minHeight-o.height)/(a.bottom+a.top))),l){var v=Math.min(m.width,m.height);v!==1/0&&de.forEach((function(p){a[p]*=v}))}else m.width!==1/0&&Ii.forEach((function(p){a[p]*=m.width})),m.height!==1/0&&Li.forEach((function(p){a[p]*=m.height}));return a}function Ie(t,n,o){return n==0&&o==0?t/2:n==0?0:o==0?t:t*Math.abs(n/(n+o))}var Ji=ce("vue-simple-handler"),er=ce("vue-simple-handler-wrapper"),ft={name:"SimpleHandler",components:{HandlerWrapper:Ht},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},horizontalPosition:{type:String},verticalPosition:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){var t,n=(ae(t={},this.horizontalPosition,!!this.horizontalPosition),ae(t,this.verticalPosition,!!this.verticalPosition),ae(t,"".concat(this.horizontalPosition,"-").concat(this.verticalPosition),!!(this.verticalPosition&&this.horizontalPosition)),ae(t,"hover",this.hover),t);return{default:K(Ji(n),this.defaultClass,this.hover&&this.hoverClass),wrapper:K(er(n),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};ft.render=function(t,n,o,i,s,r){var l=e.resolveComponent("HandlerWrapper");return e.openBlock(),e.createBlock(l,{class:r.classes.wrapper,"vertical-position":o.verticalPosition,"horizontal-position":o.horizontalPosition,disabled:o.disabled,onDrag:r.onDrag,onDragEnd:r.onDragEnd,onEnter:r.onEnter,onLeave:r.onLeave},{default:e.withCtx((function(){return[e.createVNode("div",{class:r.classes.default},null,2)]})),_:1},8,["class","vertical-position","horizontal-position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var tr=ce("vue-simple-line"),nr=ce("vue-simple-line-wrapper"),pt={name:"SimpleLine",components:{LineWrapper:Pt},props:{defaultClass:{type:String},hoverClass:{type:String},wrapperClass:{type:String},position:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{hover:!1}},computed:{classes:function(){return{root:K(tr(ae({},this.position,!0)),this.defaultClass,this.hover&&this.hoverClass),wrapper:K(nr(ae({},this.position,!0)),this.wrapperClass)}}},methods:{onDrag:function(t){this.$emit("drag",t)},onEnter:function(){this.hover=!0},onLeave:function(){this.hover=!1},onDragEnd:function(){this.$emit("drag-end")}},emits:["drag","drag-end"]};pt.render=function(t,n,o,i,s,r){var l=e.resolveComponent("LineWrapper");return e.openBlock(),e.createBlock(l,{class:r.classes.wrapper,position:o.position,disabled:o.disabled,onDrag:r.onDrag,onDragEnd:r.onDragEnd,onEnter:r.onEnter,onLeave:r.onLeave},{default:e.withCtx((function(){return[e.createVNode("div",{class:r.classes.root},null,2)]})),_:1},8,["class","position","disabled","onDrag","onDragEnd","onEnter","onLeave"])};var Qe=ce("vue-bounding-box"),or=["east","west",null],ir=["south","north",null],Ut={name:"BoundingBox",props:{width:{type:Number},height:{type:Number},transitions:{type:Object},handlers:{type:Object,default:function(){return{eastNorth:!0,north:!0,westNorth:!0,west:!0,westSouth:!0,south:!0,eastSouth:!0,east:!0}}},handlersComponent:{type:[Object,String],default:function(){return ft}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}},lines:{type:Object,default:function(){return{west:!0,north:!0,east:!0,south:!0}}},linesComponent:{type:[Object,String],default:function(){return pt}},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},resizable:{type:Boolean,default:!0}},data:function(){var t=[];return or.forEach((function(n){ir.forEach((function(o){if(n!==o){var i=Tt(n,o),s=i.name,r=i.classname;t.push({name:s,classname:r,verticalDirection:o,horizontalDirection:n})}}))})),{points:t}},computed:{style:function(){var t={};return this.width&&this.height&&(t.width="".concat(this.width,"px"),t.height="".concat(this.height,"px"),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction))),t},classes:function(){var t=this.handlersClasses,n=this.handlersWrappersClasses,o=this.linesClasses,i=this.linesWrappersClasses;return{root:Qe(),handlers:t,handlersWrappers:n,lines:o,linesWrappers:i}},lineNodes:function(){var t=this,n=[];return this.points.forEach((function(o){o.horizontalDirection&&o.verticalDirection||!t.lines[o.name]||n.push({name:o.name,component:t.linesComponent,class:K(t.classes.lines.default,t.classes.lines[o.name],!t.resizable&&t.classes.lines.disabled),wrapperClass:K(t.classes.linesWrappers.default,t.classes.linesWrappers[o.name],!t.resizable&&t.classes.linesWrappers.disabled),hoverClass:t.classes.lines.hover,verticalDirection:o.verticalDirection,horizontalDirection:o.horizontalDirection,disabled:!t.resizable})})),n},handlerNodes:function(){var t=this,n=[],o=this.width,i=this.height;return this.points.forEach((function(s){if(t.handlers[s.name]){var r={name:s.name,component:t.handlersComponent,class:K(t.classes.handlers.default,t.classes.handlers[s.name]),wrapperClass:K(t.classes.handlersWrappers.default,t.classes.handlersWrappers[s.name]),hoverClass:t.classes.handlers.hover,verticalDirection:s.verticalDirection,horizontalDirection:s.horizontalDirection,disabled:!t.resizable};if(o&&i){var l=s.horizontalDirection,c=s.verticalDirection,a=l==="east"?o:l==="west"?0:o/2,h=c==="south"?i:c==="north"?0:i/2;r.wrapperClass=Qe("handler"),r.wrapperStyle={transform:"translate(".concat(a,"px, ").concat(h,"px)")},t.transitions&&t.transitions.enabled&&(r.wrapperStyle.transition="".concat(t.transitions.time,"ms ").concat(t.transitions.timingFunction))}else r.wrapperClass=Qe("handler",ae({},s.classname,!0));n.push(r)}})),n}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[]},methods:{onEnd:function(){this.$emit("resize-end")},onHandlerDrag:function(t,n,o){var i,s=t.shift(),r=s.left,l=s.top,c={left:0,right:0,top:0,bottom:0};n==="west"?c.left-=r:n==="east"&&(c.right+=r),o==="north"?c.top-=l:o==="south"&&(c.bottom+=l),!o&&n?i="width":o&&!n&&(i="height"),this.resizable&&this.$emit("resize",new zi(c,{allowedDirections:{left:n==="west"||!n,right:n==="east"||!n,bottom:o==="south"||!o,top:o==="north"||!o},preserveAspectRatio:t.nativeEvent&&t.nativeEvent.shiftKey,respectDirection:i}))}},emits:["resize","resize-end"]};Ut.render=function(t,n,o,i,s,r){return e.openBlock(),e.createBlock("div",{ref:"box",class:r.classes.root,style:r.style},[e.renderSlot(t.$slots,"default"),e.createVNode("div",null,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(r.lineNodes,(function(l){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.component),{key:l.name,"default-class":l.class,"hover-class":l.hoverClass,"wrapper-class":l.wrapperClass,position:l.name,disabled:l.disabled,onDrag:function(c){return r.onHandlerDrag(c,l.horizontalDirection,l.verticalDirection)},onDragEnd:n[1]||(n[1]=function(c){return r.onEnd()})},null,8,["default-class","hover-class","wrapper-class","position","disabled","onDrag"])})),128))]),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(r.handlerNodes,(function(l){return e.openBlock(),e.createBlock("div",{key:l.name,style:l.wrapperStyle,class:l.wrapperClass},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.component),{"default-class":l.class,"hover-class":l.hoverClass,"wrapper-class":l.wrapperClass,"horizontal-position":l.horizontalDirection,"vertical-position":l.verticalDirection,disabled:l.disabled,onDrag:function(c){return r.onHandlerDrag(c,l.horizontalDirection,l.verticalDirection)},onDragEnd:n[2]||(n[2]=function(c){return r.onEnd()})},null,8,["default-class","hover-class","wrapper-class","horizontal-position","vertical-position","disabled","onDrag"]))],6)})),128))],6)};var rr=ce("vue-draggable-area"),qt={name:"DraggableArea",props:{movable:{type:Boolean,default:!0},activationDistance:{type:Number,default:20}},computed:{classnames:function(){return{default:rr()}}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},mounted:function(){this.touches=[],this.touchStarted=!1},methods:{onTouchStart:function(t){if(t.cancelable){var n=this.movable&&t.touches.length===1;n&&(this.touches=Se(t.touches)),(this.touchStarted||n)&&(t.preventDefault(),t.stopPropagation())}},onTouchEnd:function(){this.touchStarted=!1,this.processEnd()},onTouchMove:function(t){this.touches.length>=1&&(this.touchStarted?(this.processMove(t,t.touches),t.preventDefault(),t.stopPropagation()):Ft({x:this.touches[0].clientX,y:this.touches[0].clientY},{x:t.touches[0].clientX,y:t.touches[0].clientY})>this.activationDistance&&(this.initAnchor({clientX:t.touches[0].clientX,clientY:t.touches[0].clientY}),this.touchStarted=!0))},onMouseDown:function(t){if(this.movable&&t.button===0){var n={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[n],this.initAnchor(n),t.stopPropagation()}},onMouseMove:function(t){this.touches.length&&(this.processMove(t,[{fake:!0,clientX:t.clientX,clientY:t.clientY}]),t.preventDefault&&t.cancelable&&t.preventDefault(),t.stopPropagation())},onMouseUp:function(){this.processEnd()},initAnchor:function(t){var n=this.$refs.container.getBoundingClientRect(),o=n.left,i=n.top;this.anchor={x:t.clientX-o,y:t.clientY-i}},processMove:function(t,n){var o=Se(n);if(this.touches.length){var i=this.$refs.container.getBoundingClientRect(),s=i.left,r=i.top;this.touches.length===1&&o.length===1&&this.$emit("move",new ht({left:o[0].clientX-(s+this.anchor.x),top:o[0].clientY-(r+this.anchor.y)}))}},processEnd:function(){this.touches.length&&this.$emit("move-end"),this.touches=[]}},emits:["move","move-end"]};qt.render=function(t,n,o,i,s,r){return e.openBlock(),e.createBlock("div",{ref:"container",onTouchstart:n[1]||(n[1]=function(){return r.onTouchStart&&r.onTouchStart.apply(r,arguments)}),onMousedown:n[2]||(n[2]=function(){return r.onMouseDown&&r.onMouseDown.apply(r,arguments)})},[e.renderSlot(t.$slots,"default")],544)};function Ze(t){var n,o;return{rotate:t.rotate||0,flip:{horizontal:((n=t?.flip)===null||n===void 0?void 0:n.horizontal)||!1,vertical:((o=t?.flip)===null||o===void 0?void 0:o.vertical)||!1}}}function sr(t){return new Promise((function(n,o){try{if(t)if(/^data:/i.test(t))n((function(a){a=a.replace(/^data:([^;]+);base64,/gim,"");for(var h=atob(a),d=h.length,u=new ArrayBuffer(d),m=new Uint8Array(u),f=0;f<d;f++)m[f]=h.charCodeAt(f);return u})(t));else if(/^blob:/i.test(t)){var i=new FileReader;i.onload=function(a){n(a.target.result)},r=t,l=function(a){i.readAsArrayBuffer(a)},(c=new XMLHttpRequest).open("GET",r,!0),c.responseType="blob",c.onload=function(){this.status!=200&&this.status!==0||l(this.response)},c.send()}else{var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===4&&(s.status===200||s.status===0?n(s.response):o("Warning: could not load an image to parse its orientation"),s=null)},s.onprogress=function(){s.getResponseHeader("content-type")!=="image/jpeg"&&s.abort()},s.withCredentials=!1,s.open("GET",t,!0),s.responseType="arraybuffer",s.send(null)}else o("Error: the image is empty")}catch(a){o(a)}var r,l,c}))}function Yt(t){var n=t.rotate,o=t.flip,i=t.scaleX,s=t.scaleY,r="";return r+=" rotate("+n+"deg) ",r+=" scaleX("+i*(o.horizontal?-1:1)+") ",r+=" scaleY("+s*(o.vertical?-1:1)+") "}function ar(t){try{var n,o=new DataView(t),i=void 0,s=void 0,r=void 0,l=void 0;if(o.getUint8(0)===255&&o.getUint8(1)===216)for(var c=o.byteLength,a=2;a+1<c;){if(o.getUint8(a)===255&&o.getUint8(a+1)===225){r=a;break}a++}if(r&&(i=r+10,(function(f,v,p){var _,g="";for(_=v,p+=v;_<p;_++)g+=String.fromCharCode(f.getUint8(_));return g})(o,r+4,4)==="Exif")){var h=o.getUint16(i);if(((s=h===18761)||h===19789)&&o.getUint16(i+2,s)===42){var d=o.getUint32(i+4,s);d>=8&&(l=i+d)}}if(l){for(var u=o.getUint16(l,s),m=0;m<u;m++)if(a=l+12*m+2,o.getUint16(a,s)===274){a+=8,n=o.getUint16(a,s),o.setUint16(a,1,s);break}}return n}catch{return null}}function Bt(t,n){var o=n.getBoundingClientRect(),i=o.left,s=o.top,r={left:0,top:0},l=0;return t.forEach((function(c){r.left+=(c.clientX-i)/t.length,r.top+=(c.clientY-s)/t.length})),t.forEach((function(c){l+=Ft({x:r.left,y:r.top},{x:c.clientX-i,y:c.clientY-s})})),{centerMass:r,spread:l,count:t.length}}var Kt={props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0},eventsFilter:{type:Function,required:!1}},beforeMount:function(){window.addEventListener("mouseup",this.onMouseUp,{passive:!1}),window.addEventListener("mousemove",this.onMouseMove,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd,{passive:!1})},beforeUnmount:function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},created:function(){this.transforming=!1,this.debouncedProcessEnd=ot(this.processEnd),this.touches=[]},methods:{processMove:function(t,n){if(this.touches.length){if(this.touches.length===1&&n.length===1)this.$emit("move",new $e({left:this.touches[0].clientX-n[0].clientX,top:this.touches[0].clientY-n[0].clientY}));else if(this.touches.length>1&&this.touchResize){var o=Bt(n,this.$refs.container),i=this.oldGeometricProperties;i.count===o.count&&i.count>1&&this.$emit("resize",new $e({left:i.centerMass.left-o.centerMass.left,top:i.centerMass.top-o.centerMass.top},{factor:i.spread/o.spread,center:o.centerMass})),this.oldGeometricProperties=o}this.touches=n}},processEnd:function(){this.transforming&&(this.transforming=!1,this.$emit("transform-end"))},processStart:function(){this.transforming=!0,this.debouncedProcessEnd.clear()},processEvent:function(t){return this.eventsFilter?this.eventsFilter(t,this.transforming)!==!1:(t.preventDefault(),t.stopPropagation(),!0)},onTouchStart:function(t){if(t.cancelable&&(this.touchMove||this.touchResize&&t.touches.length>1)&&this.processEvent(t)){var n=this.$refs.container,o=n.getBoundingClientRect(),i=o.left,s=o.top,r=o.bottom,l=o.right;this.touches=Se(t.touches).filter((function(c){return c.clientX>i&&c.clientX<l&&c.clientY>s&&c.clientY<r})),this.oldGeometricProperties=Bt(this.touches,n)}},onTouchEnd:function(t){t.touches.length===0&&(this.touches=[],this.processEnd())},onTouchMove:function(t){var n=this;if(this.touches.length){var o=Se(t.touches).filter((function(i){return!i.identifier||n.touches.find((function(s){return s.identifier===i.identifier}))}));this.processEvent(t)&&(this.processMove(t,o),this.processStart())}},onMouseDown:function(t){if(this.mouseMove&&"buttons"in t&&t.buttons===1&&this.processEvent(t)){var n={fake:!0,clientX:t.clientX,clientY:t.clientY};this.touches=[n],this.processStart()}},onMouseMove:function(t){this.touches.length&&this.processEvent(t)&&this.processMove(t,[{clientX:t.clientX,clientY:t.clientY}])},onMouseUp:function(){this.touches=[],this.processEnd()},onWheel:function(t){if(this.wheelResize&&this.processEvent(t)){var n=this.$refs.container.getBoundingClientRect(),o=n.left,i=n.top,s=1+this.wheelResize.ratio*(l=t.deltaY||t.detail||t.wheelDelta,(c=+l)==0||Lt(c)?c:c>0?1:-1),r={left:t.clientX-o,top:t.clientY-i};this.$emit("resize",new $e({},{factor:s,center:r})),this.touches.length||this.debouncedProcessEnd()}var l,c}},emits:["resize","move","transform-end"]};Kt.render=function(t,n,o,i,s,r){return e.openBlock(),e.createBlock("div",{ref:"container",onTouchstart:n[1]||(n[1]=function(){return r.onTouchStart&&r.onTouchStart.apply(r,arguments)}),onMousedown:n[2]||(n[2]=function(){return r.onMouseDown&&r.onMouseDown.apply(r,arguments)}),onWheel:n[3]||(n[3]=function(){return r.onWheel&&r.onWheel.apply(r,arguments)})},[e.renderSlot(t.$slots,"default")],544)};var at={components:{TransformableImage:Kt},props:{touchMove:{type:Boolean,required:!0},mouseMove:{type:Boolean,required:!0},touchResize:{type:Boolean,required:!0},wheelResize:{type:[Boolean,Object],required:!0}},emits:["resize","move"]};at.render=function(t,n,o,i,s,r){var l=e.resolveComponent("transformable-image");return e.openBlock(),e.createBlock(l,{"touch-move":o.touchMove,"touch-resize":o.touchResize,"mouse-move":o.mouseMove,"wheel-resize":o.wheelResize,onMove:n[1]||(n[1]=function(c){return t.$emit("move",c)}),onResize:n[2]||(n[2]=function(c){return t.$emit("resize",c)})},{default:e.withCtx((function(){return[e.renderSlot(t.$slots,"default")]})),_:3},8,["touch-move","touch-resize","mouse-move","wheel-resize"])};var Le=ce("vue-preview"),Gt={props:{coordinates:{type:Object},transitions:{type:Object},image:{type:Object,default:function(){return{}}},imageClass:{type:String},width:{type:Number},height:{type:Number},fill:{type:Boolean}},data:function(){return{calculatedImageSize:{width:0,height:0},calculatedSize:{width:0,height:0}}},computed:{classes:function(){return{root:Le({fill:this.fill}),wrapper:Le("wrapper"),imageWrapper:Le("image-wrapper"),image:K(Le("image"),this.imageClass)}},style:function(){if(this.fill)return{};var t={};return this.width&&(t.width="".concat(this.size.width,"px")),this.height&&(t.height="".concat(this.size.height,"px")),this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},wrapperStyle:function(){var t={width:"".concat(this.size.width,"px"),height:"".concat(this.size.height,"px"),left:"calc(50% - ".concat(this.size.width/2,"px)"),top:"calc(50% - ".concat(this.size.height/2,"px)")};return this.transitions&&this.transitions.enabled&&(t.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),t},imageStyle:function(){if(this.coordinates&&this.image){var t=this.coordinates.width/this.size.width,n=H(H({rotate:0,flip:{horizontal:!1,vertical:!1}},this.image.transforms),{},{scaleX:1/t,scaleY:1/t}),o=this.imageSize.width,i=this.imageSize.height,s=jt({width:o,height:i},n.rotate),r={width:"".concat(o,"px"),height:"".concat(i,"px"),left:"0px",top:"0px"},l={rotate:{left:(o-s.width)*n.scaleX/2,top:(i-s.height)*n.scaleY/2},scale:{left:(1-n.scaleX)*o/2,top:(1-n.scaleY)*i/2}};return r.transform=`translate(
				`.concat(-this.coordinates.left/t-l.rotate.left-l.scale.left,"px,").concat(-this.coordinates.top/t-l.rotate.top-l.scale.top,"px) ")+Yt(n),this.transitions&&this.transitions.enabled&&(r.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),r}return{}},size:function(){return{width:this.width||this.calculatedSize.width,height:this.height||this.calculatedSize.height}},imageSize:function(){return{width:this.image.width||this.calculatedImageSize.width,height:this.image.height||this.calculatedImageSize.height}}},watch:{image:function(t){(t.width||t.height)&&this.onChangeImage()}},mounted:function(){var t=this;this.onChangeImage(),this.$refs.image.addEventListener("load",(function(){t.refreshImage()})),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)},methods:{refreshImage:function(){var t=this.$refs.image;this.calculatedImageSize.height=t.naturalHeight,this.calculatedImageSize.width=t.naturalWidth},refresh:function(){var t=this.$refs.root;this.width||(this.calculatedSize.width=t.clientWidth),this.height||(this.calculatedSize.height=t.clientHeight)},onChangeImage:function(){var t=this.$refs.image;t&&t.complete&&this.refreshImage(),this.refresh()}}};Gt.render=function(t,n,o,i,s,r){return e.openBlock(),e.createBlock("div",{ref:"root",class:r.classes.root,style:r.style},[e.createVNode("div",{ref:"wrapper",class:r.classes.wrapper,style:r.wrapperStyle},[e.withDirectives(e.createVNode("img",{ref:"image",src:o.image&&o.image.src,class:r.classes.image,style:r.imageStyle},null,14,["src"]),[[e.vShow,o.image&&o.image.src]])],6)],6)};var Xt={components:{Preview:Gt},inheritAttrs:!1};Xt.render=function(t,n,o,i,s,r){var l=e.resolveComponent("preview");return e.openBlock(),e.createBlock(l,e.mergeProps(t.$attrs,{fill:!0}),null,16)};var Je=ce("vue-rectangle-stencil"),Qt={name:"RectangleStencil",components:{StencilPreview:Xt,BoundingBox:Ut,DraggableArea:qt},props:{image:{type:Object},coordinates:{type:Object},stencilCoordinates:{type:Object},handlers:{type:Object},handlersComponent:{type:[Object,String],default:function(){return ft}},lines:{type:Object},linesComponent:{type:[Object,String],default:function(){return pt}},aspectRatio:{type:[Number,String]},minAspectRatio:{type:[Number,String]},maxAspectRatio:{type:[Number,String]},movable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},transitions:{type:Object},movingClass:{type:String},resizingClass:{type:String},previewClass:{type:String},boundingBoxClass:{type:String},linesClasses:{type:Object,default:function(){return{}}},linesWrappersClasses:{type:Object,default:function(){return{}}},handlersClasses:{type:Object,default:function(){return{}}},handlersWrappersClasses:{type:Object,default:function(){return{}}}},data:function(){return{moving:!1,resizing:!1}},computed:{classes:function(){return{stencil:K(Je({movable:this.movable,moving:this.moving,resizing:this.resizing}),this.moving&&this.movingClass,this.resizing&&this.resizingClass),preview:K(Je("preview"),this.previewClass),boundingBox:K(Je("bounding-box"),this.boundingBoxClass)}},style:function(){var t=this.stencilCoordinates,n=t.height,o=t.width,i=t.left,s=t.top,r={width:"".concat(o,"px"),height:"".concat(n,"px"),transform:"translate(".concat(i,"px, ").concat(s,"px)")};return this.transitions&&this.transitions.enabled&&(r.transition="".concat(this.transitions.time,"ms ").concat(this.transitions.timingFunction)),r}},methods:{onMove:function(t){this.$emit("move",t),this.moving=!0},onMoveEnd:function(){this.$emit("move-end"),this.moving=!1},onResize:function(t){this.$emit("resize",t),this.resizing=!0},onResizeEnd:function(){this.$emit("resize-end"),this.resizing=!1},aspectRatios:function(){return{minimum:this.aspectRatio||this.minAspectRatio,maximum:this.aspectRatio||this.maxAspectRatio}}},emits:["resize","resize-end","move","move-end"]};Qt.render=function(t,n,o,i,s,r){var l=e.resolveComponent("stencil-preview"),c=e.resolveComponent("draggable-area"),a=e.resolveComponent("bounding-box");return e.openBlock(),e.createBlock("div",{class:r.classes.stencil,style:r.style},[e.createVNode(a,{width:o.stencilCoordinates.width,height:o.stencilCoordinates.height,transitions:o.transitions,class:r.classes.boundingBox,handlers:o.handlers,"handlers-component":o.handlersComponent,"handlers-classes":o.handlersClasses,"handlers-wrappers-classes":o.handlersWrappersClasses,lines:o.lines,"lines-component":o.linesComponent,"lines-classes":o.linesClasses,"lines-wrappers-classes":o.linesWrappersClasses,resizable:o.resizable,onResize:r.onResize,onResizeEnd:r.onResizeEnd},{default:e.withCtx((function(){return[e.createVNode(c,{movable:o.movable,onMove:r.onMove,onMoveEnd:r.onMoveEnd},{default:e.withCtx((function(){return[e.createVNode(l,{image:o.image,coordinates:o.coordinates,width:o.stencilCoordinates.width,height:o.stencilCoordinates.height,class:r.classes.preview,transitions:o.transitions},null,8,["image","coordinates","width","height","class","transitions"])]})),_:1},8,["movable","onMove","onMoveEnd"])]})),_:1},8,["width","height","transitions","class","handlers","handlers-component","handlers-classes","handlers-wrappers-classes","lines","lines-component","lines-classes","lines-wrappers-classes","resizable","onResize","onResizeEnd"])],6)};var lr=["transitions"],pe=ce("vue-advanced-cropper"),Zt={name:"Cropper",components:{BackgroundWrapper:at},props:{src:{type:String,default:null},stencilComponent:{type:[Object,String],default:function(){return Qt}},backgroundWrapperComponent:{type:[Object,String],default:function(){return at}},stencilProps:{type:Object,default:function(){return{}}},autoZoom:{type:Boolean,default:!1},imageClass:{type:String},boundariesClass:{type:String},backgroundClass:{type:String},foregroundClass:{type:String},minWidth:{type:[Number,String]},minHeight:{type:[Number,String]},maxWidth:{type:[Number,String]},maxHeight:{type:[Number,String]},debounce:{type:[Boolean,Number],default:500},transitions:{type:Boolean,default:!0},checkOrientation:{type:Boolean,default:!0},canvas:{type:[Object,Boolean],default:!0},crossOrigin:{type:[Boolean,String],default:void 0},transitionTime:{type:Number,default:300},imageRestriction:{type:String,default:"fit-area",validator:function(t){return Hi.indexOf(t)!==-1}},roundResult:{type:Boolean,default:!0},defaultSize:{type:[Function,Object]},defaultPosition:{type:[Function,Object]},defaultVisibleArea:{type:[Function,Object]},defaultTransforms:{type:[Function,Object]},defaultBoundaries:{type:[Function,String],validator:function(t){return!(typeof t=="string"&&t!=="fill"&&t!=="fit")}},priority:{type:String,default:"coordinates"},stencilSize:{type:[Object,Function]},resizeImage:{type:[Boolean,Object],default:!0},moveImage:{type:[Boolean,Object],default:!0},autoZoomAlgorithm:{type:Function},resizeAlgorithm:{type:Function,default:function(t){var n=t.event,o=t.coordinates,i=t.aspectRatio,s=t.positionRestrictions,r=t.sizeRestrictions,l=B(B({},o),{right:o.left+o.width,bottom:o.top+o.height}),c=n.params||{},a=B({},n.directions),h=c.allowedDirections||{left:!0,right:!0,bottom:!0,top:!0};r.widthFrozen&&(a.left=0,a.right=0),r.heightFrozen&&(a.top=0,a.bottom=0),de.forEach((function(N){h[N]||(a[N]=0)}));var d=ue(l,a=Ct({coordinates:l,directions:a,sizeRestrictions:r,positionRestrictions:s})).width,u=ue(l,a).height,m=c.preserveRatio?P(l):Xe(d/u,i);if(m){var f=c.respectDirection;if(f||(f=l.width>=l.height||m===1?"width":"height"),f==="width"){var v=d/m-l.height;if(h.top&&h.bottom){var p=a.top,_=a.bottom;a.bottom=Ie(v,_,p),a.top=Ie(v,p,_)}else h.bottom?a.bottom=v:h.top?a.top=v:h.right?a.right=0:h.left&&(a.left=0)}else if(f==="height"){var g=l.width-u*m;if(h.left&&h.right){var k=a.left,S=a.right;a.left=-Ie(g,k,S),a.right=-Ie(g,S,k)}else h.left?a.left=-g:h.right?a.right=-g:h.top?a.top=0:h.bottom&&(a.bottom=0)}a=Ct({directions:a,coordinates:l,sizeRestrictions:r,positionRestrictions:s,preserveRatio:!0,compensate:c.compensate})}return d=ue(l,a).width,u=ue(l,a).height,(m=c.preserveRatio?P(l):Xe(d/u,i))&&Math.abs(m-d/u)>.001&&de.forEach((function(N){h[N]||(a[N]=0)})),st({event:new ht({left:-a.left,top:-a.top}),coordinates:{width:o.width+a.right+a.left,height:o.height+a.top+a.bottom,left:o.left,top:o.top},positionRestrictions:s})}},moveAlgorithm:{type:Function,default:st},initStretcher:{type:Function,default:function(t){var n=t.stretcher,o=t.imageSize,i=P(o);n.style.width=o.width+"px",n.style.height=n.clientWidth/i+"px",n.style.width=n.clientWidth+"px"}},fitCoordinates:{type:Function,default:function(t){var n=t.visibleArea,o=t.coordinates,i=t.aspectRatio,s=t.sizeRestrictions,r=t.positionRestrictions,l=B(B({},o),ve({width:o.width,height:o.height,aspectRatio:i,sizeRestrictions:{maxWidth:n.width,maxHeight:n.height,minHeight:Math.min(n.height,s.minHeight),minWidth:Math.min(n.width,s.minWidth)}}));return l=ee(l=re(l,Be(J(o),J(l))),je(he(n),r))}},fitVisibleArea:{type:Function,default:function(t){var n=t.visibleArea,o=t.boundaries,i=t.getAreaRestrictions,s=t.coordinates,r=B({},n);r.height=r.width/P(o),r.top+=(n.height-r.height)/2,(s.height-r.height>0||s.width-r.width>0)&&(r=le(r,Math.max(s.height/r.height,s.width/r.width)));var l=Pe(Ne(s,he(r=le(r,Oe(r,i({visibleArea:r,type:"resize"}))))));return r.width<s.width&&(l.left=0),r.height<s.height&&(l.top=0),r=ee(r=re(r,l),i({visibleArea:r,type:"move"}))}},areaRestrictionsAlgorithm:{type:Function,default:function(t){var n=t.visibleArea,o=t.boundaries,i=t.imageSize,s=t.imageRestriction,r=t.type,l={};return s==="fill-area"?l={left:0,top:0,right:i.width,bottom:i.height}:s==="fit-area"&&(P(o)>P(i)?(l={top:0,bottom:i.height},n&&r==="move"&&(n.width>i.width?(l.left=-(n.width-i.width)/2,l.right=i.width-l.left):(l.left=0,l.right=i.width))):(l={left:0,right:i.width},n&&r==="move"&&(n.height>i.height?(l.top=-(n.height-i.height)/2,l.bottom=i.height-l.top):(l.top=0,l.bottom=i.height)))),l}},sizeRestrictionsAlgorithm:{type:Function,default:function(t){return{minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight}}},positionRestrictionsAlgorithm:{type:Function,default:function(t){var n=t.imageSize,o={};return t.imageRestriction!=="none"&&(o={left:0,top:0,right:n.width,bottom:n.height}),o}}},data:function(){return{transitionsActive:!1,imageLoaded:!1,imageAttributes:{width:null,height:null,crossOrigin:null,src:null},defaultImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},appliedImageTransforms:{rotate:0,flip:{horizontal:!1,vertical:!1}},boundaries:{width:0,height:0},visibleArea:null,coordinates:H({},yt)}},computed:{image:function(){return{src:this.imageAttributes.src,width:this.imageAttributes.width,height:this.imageAttributes.height,transforms:this.imageTransforms}},imageTransforms:function(){return{rotate:this.appliedImageTransforms.rotate,flip:{horizontal:this.appliedImageTransforms.flip.horizontal,vertical:this.appliedImageTransforms.flip.vertical},translateX:this.visibleArea?this.visibleArea.left/this.coefficient:0,translateY:this.visibleArea?this.visibleArea.top/this.coefficient:0,scaleX:1/this.coefficient,scaleY:1/this.coefficient}},imageSize:function(){var t=(function(n){return n*Math.PI/180})(this.imageTransforms.rotate);return{width:Math.abs(this.imageAttributes.width*Math.cos(t))+Math.abs(this.imageAttributes.height*Math.sin(t)),height:Math.abs(this.imageAttributes.width*Math.sin(t))+Math.abs(this.imageAttributes.height*Math.cos(t))}},initialized:function(){return!!(this.visibleArea&&this.imageLoaded)},settings:function(){var t=it(this.resizeImage,{touch:!0,wheel:{ratio:.1},adjustStencil:!0},{touch:!1,wheel:!1,adjustStencil:!1});return{moveImage:it(this.moveImage,{touch:!0,mouse:!0},{touch:!1,mouse:!1}),resizeImage:t}},coefficient:function(){return this.visibleArea?this.visibleArea.width/this.boundaries.width:0},areaRestrictions:function(){return this.imageLoaded?this.areaRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction,boundaries:this.boundaries}):{}},transitionsOptions:function(){return{enabled:this.transitionsActive,timingFunction:"ease-in-out",time:350}},sizeRestrictions:function(){if(this.boundaries.width&&this.boundaries.height&&this.imageSize.width&&this.imageSize.height){var t=this.sizeRestrictionsAlgorithm({imageSize:this.imageSize,minWidth:X(this.minWidth)?0:Re(this.minWidth),minHeight:X(this.minHeight)?0:Re(this.minHeight),maxWidth:X(this.maxWidth)?1/0:Re(this.maxWidth),maxHeight:X(this.maxHeight)?1/0:Re(this.maxHeight)});if(t=(function(i){var s=i.areaRestrictions,r=i.sizeRestrictions,l=i.boundaries,c=i.positionRestrictions,a=B(B({},r),{minWidth:r.minWidth!==void 0?r.minWidth:0,minHeight:r.minHeight!==void 0?r.minHeight:0,maxWidth:r.maxWidth!==void 0?r.maxWidth:1/0,maxHeight:r.maxHeight!==void 0?r.maxHeight:1/0});c.left!==void 0&&c.right!==void 0&&(a.maxWidth=Math.min(a.maxWidth,c.right-c.left)),c.bottom!==void 0&&c.top!==void 0&&(a.maxHeight=Math.min(a.maxHeight,c.bottom-c.top));var h=rt(s),d=Ot(l,h);return h.width<1/0&&(!a.maxWidth||a.maxWidth>d.width)&&(a.maxWidth=Math.min(a.maxWidth,d.width)),h.height<1/0&&(!a.maxHeight||a.maxHeight>d.height)&&(a.maxHeight=Math.min(a.maxHeight,d.height)),a.minWidth>a.maxWidth&&(a.minWidth=a.maxWidth,a.widthFrozen=!0),a.minHeight>a.maxHeight&&(a.minHeight=a.maxHeight,a.heightFrozen=!0),a})({sizeRestrictions:t,areaRestrictions:this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}),imageSize:this.imageSize,boundaries:this.boundaries,positionRestrictions:this.positionRestrictions,imageRestriction:this.imageRestriction,visibleArea:this.visibleArea,stencilSize:this.getStencilSize()}),this.visibleArea&&this.stencilSize){var n=this.getStencilSize(),o=rt(this.getAreaRestrictions({visibleArea:this.visibleArea,type:"resize"}));t.maxWidth=Math.min(t.maxWidth,o.width*n.width/this.boundaries.width),t.maxHeight=Math.min(t.maxHeight,o.height*n.height/this.boundaries.height),t.maxWidth<t.minWidth&&(t.minWidth=t.maxWidth),t.maxHeight<t.minHeight&&(t.minHeight=t.maxHeight)}return t}return{minWidth:0,minHeight:0,maxWidth:0,maxHeight:0}},positionRestrictions:function(){return this.positionRestrictionsAlgorithm({imageSize:this.imageSize,imageRestriction:this.imageRestriction})},classes:function(){return{cropper:pe(),image:K(pe("image"),this.imageClass),stencil:pe("stencil"),boundaries:K(pe("boundaries"),this.boundariesClass),stretcher:K(pe("stretcher")),background:K(pe("background"),this.backgroundClass),foreground:K(pe("foreground"),this.foregroundClass),imageWrapper:K(pe("image-wrapper")),cropperWrapper:K(pe("cropper-wrapper"))}},stencilCoordinates:function(){if(this.initialized){var t=this.coordinates,n=t.width,o=t.height,i=t.left,s=t.top;return{width:n/this.coefficient,height:o/this.coefficient,left:(i-this.visibleArea.left)/this.coefficient,top:(s-this.visibleArea.top)/this.coefficient}}return this.defaultCoordinates()},boundariesStyle:function(){var t={width:this.boundaries.width?"".concat(Math.round(this.boundaries.width),"px"):"auto",height:this.boundaries.height?"".concat(Math.round(this.boundaries.height),"px"):"auto",transition:"opacity ".concat(this.transitionTime,"ms"),pointerEvents:this.imageLoaded?"all":"none"};return this.imageLoaded||(t.opacity="0"),t},imageStyle:function(){var t=this.imageAttributes.width>this.imageAttributes.height?{width:Math.min(1024,this.imageAttributes.width),height:Math.min(1024,this.imageAttributes.width)/(this.imageAttributes.width/this.imageAttributes.height)}:{height:Math.min(1024,this.imageAttributes.height),width:Math.min(1024,this.imageAttributes.height)*(this.imageAttributes.width/this.imageAttributes.height)},n={left:(t.width-this.imageSize.width)/(2*this.coefficient),top:(t.height-this.imageSize.height)/(2*this.coefficient)},o={left:(1-1/this.coefficient)*t.width/2,top:(1-1/this.coefficient)*t.height/2},i=H(H({},this.imageTransforms),{},{scaleX:this.imageTransforms.scaleX*(this.imageAttributes.width/t.width),scaleY:this.imageTransforms.scaleY*(this.imageAttributes.height/t.height)}),s={width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),left:"0px",top:"0px",transform:"translate(".concat(-n.left-o.left-this.imageTransforms.translateX,"px, ").concat(-n.top-o.top-this.imageTransforms.translateY,"px)")+Yt(i)};return this.transitionsOptions.enabled&&(s.transition="".concat(this.transitionsOptions.time,"ms ").concat(this.transitionsOptions.timingFunction)),s}},watch:{src:function(){this.onChangeImage()},stencilComponent:function(){var t=this;this.$nextTick((function(){t.resetCoordinates(),t.runAutoZoom("setCoordinates"),t.onChange()}))},minWidth:function(){this.onPropsChange()},maxWidth:function(){this.onPropsChange()},minHeight:function(){this.onPropsChange()},maxHeight:function(){this.onPropsChange()},imageRestriction:function(){this.reset()},stencilProps:function(t,n){["aspectRatio","minAspectRatio","maxAspectRatio"].find((function(o){return t[o]!==n[o]}))&&this.$nextTick(this.onPropsChange)}},created:function(){this.debouncedUpdate=ot(this.update,this.debounce),this.debouncedDisableTransitions=ot(this.disableTransitions,this.transitionsOptions.time),this.awaiting=!1},mounted:function(){this.$refs.image.addEventListener("load",this.onSuccessLoadImage),this.$refs.image.addEventListener("error",this.onFailLoadImage),this.onChangeImage(),window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)},unmounted:function(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh),this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.debouncedUpdate.clear(),this.debouncedDisableTransitions.clear()},methods:{getResult:function(){var t=this.initialized?this.prepareResult(H({},this.coordinates)):this.defaultCoordinates(),n={rotate:this.imageTransforms.rotate%360,flip:H({},this.imageTransforms.flip)};if(this.src&&this.imageLoaded){var o=this;return{image:this.image,coordinates:t,visibleArea:this.visibleArea?H({},this.visibleArea):null,imageTransforms:n,get canvas(){return o.canvas?o.getCanvas():void 0}}}return{image:this.image,coordinates:t,visibleArea:this.visibleArea?H({},this.visibleArea):null,canvas:void 0,imageTransforms:n}},zoom:function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.transitions,s=i===void 0||i;this.onManipulateImage(new $e({},{factor:1/t,center:n}),{normalize:!1,transitions:s})},move:function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.transitions,s=i===void 0||i;this.onManipulateImage(new $e({left:t||0,top:n||0}),{normalize:!1,transitions:s})},setCoordinates:function(t){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=o.autoZoom,s=i===void 0||i,r=o.transitions,l=r===void 0||r;this.$nextTick((function(){n.imageLoaded?(n.transitionsActive||(l&&n.enableTransitions(),n.coordinates=n.applyTransform(t),s&&n.runAutoZoom("setCoordinates"),l&&n.debouncedDisableTransitions()),n.onChange()):n.delayedTransforms=t}))},refresh:function(){var t=this,n=this.$refs.image;if(this.src&&n)return this.initialized?this.updateVisibleArea().then((function(){t.onChange()})):this.resetVisibleArea().then((function(){t.onChange()}))},reset:function(){var t=this;return this.resetVisibleArea().then((function(){t.onChange(!1)}))},awaitRender:function(t){var n=this;this.awaiting||(this.awaiting=!0,this.$nextTick((function(){t(),n.awaiting=!1})))},prepareResult:function(t){return this.roundResult?(function(n){var o=n.coordinates,i=n.sizeRestrictions,s=n.positionRestrictions,r={width:Math.round(o.width),height:Math.round(o.height),left:Math.round(o.left),top:Math.round(o.top)};return r.width>i.maxWidth?r.width=Math.floor(o.width):r.width<i.minWidth&&(r.width=Math.ceil(o.width)),r.height>i.maxHeight?r.height=Math.floor(o.height):r.height<i.minHeight&&(r.height=Math.ceil(o.height)),ee(r,s)})(H(H({},this.getPublicProperties()),{},{positionRestrictions:Te(this.positionRestrictions,this.visibleArea),coordinates:t})):t},processAutoZoom:function(t,n,o,i){var s=this.autoZoomAlgorithm;s||(s=this.stencilSize?ji:this.autoZoom?Wi:Ui);var r=s({event:{type:t,params:i},visibleArea:n,coordinates:o,boundaries:this.boundaries,aspectRatio:this.getAspectRatio(),positionRestrictions:this.positionRestrictions,getAreaRestrictions:this.getAreaRestrictions,sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize()});return H(H({},r),{},{changed:!Et(r.visibleArea,n)||!Et(r.coordinates,o)})},runAutoZoom:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.transitions,i=o!==void 0&&o,s=Ai(n,lr),r=this.processAutoZoom(t,this.visibleArea,this.coordinates,s),l=r.visibleArea,c=r.coordinates,a=r.changed;i&&a&&this.enableTransitions(),this.visibleArea=l,this.coordinates=c,i&&a&&this.debouncedDisableTransitions()},normalizeEvent:function(t){return(function(n){var o=n.event,i=n.visibleArea,s=n.coefficient;if(o.type==="manipulateImage")return B(B({},o),{move:{left:o.move&&o.move.left?s*o.move.left:0,top:o.move&&o.move.top?s*o.move.top:0},scale:{factor:o.scale&&o.scale.factor?o.scale.factor:1,center:o.scale&&o.scale.center?{left:o.scale.center.left*s+i.left,top:o.scale.center.top*s+i.top}:null}});if(o.type==="resize"){var r=B(B({},o),{directions:B({},o.directions)});return de.forEach((function(c){r.directions[c]*=s})),r}if(o.type==="move"){var l=B(B({},o),{directions:B({},o.directions)});return Fi.forEach((function(c){l.directions[c]*=s})),l}return o})(H(H({},this.getPublicProperties()),{},{event:t}))},getCanvas:function(){if(this.$refs.canvas){var t=this.$refs.canvas,n=this.$refs.image,o=this.imageTransforms.rotate!==0||this.imageTransforms.flip.horizontal||this.imageTransforms.flip.vertical?(function(c,a,h){var d=h.rotate,u=h.flip,m={width:a.naturalWidth,height:a.naturalHeight},f=jt(m,d),v=c.getContext("2d");c.height=f.height,c.width=f.width,v.save();var p=ke(J(B({left:0,top:0},m)),d);return v.translate(-(p.left-f.width/2),-(p.top-f.height/2)),v.rotate(d*Math.PI/180),v.translate(u.horizontal?m.width:0,u.vertical?m.height:0),v.scale(u.horizontal?-1:1,u.vertical?-1:1),v.drawImage(a,0,0,m.width,m.height),v.restore(),c})(this.$refs.sourceCanvas,n,this.imageTransforms):n,i=H({minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,maxArea:this.maxCanvasSize,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",fillColor:"transparent"},this.canvas),s=function(c){return c.find((function(a){return h=a,!Number.isNaN(parseFloat(h))&&isFinite(h);var h}))},r=ve({sizeRestrictions:{minWidth:s([i.width,i.minWidth])||0,minHeight:s([i.height,i.minHeight])||0,maxWidth:s([i.width,i.maxWidth])||1/0,maxHeight:s([i.height,i.maxHeight])||1/0},width:this.coordinates.width,height:this.coordinates.height,aspectRatio:{minimum:this.coordinates.width/this.coordinates.height,maximum:this.coordinates.width/this.coordinates.height}});if(i.maxArea&&r.width*r.height>i.maxArea){var l=Math.sqrt(i.maxArea/(r.width*r.height));r={width:Math.round(l*r.width),height:Math.round(l*r.height)}}return(function(c,a,h,d,u){c.width=d?d.width:h.width,c.height=d?d.height:h.height;var m=c.getContext("2d");m.clearRect(0,0,c.width,c.height),u&&(u.imageSmoothingEnabled&&(m.imageSmoothingEnabled=u.imageSmoothingEnabled),u.imageSmoothingQuality&&(m.imageSmoothingQuality=u.imageSmoothingQuality),u.fillColor&&(m.fillStyle=u.fillColor,m.fillRect(0,0,c.width,c.height),m.save()));var f=h.left<0?-h.left:0,v=h.top<0?-h.top:0;m.drawImage(a,h.left+f,h.top+v,h.width,h.height,f*(c.width/h.width),v*(c.height/h.height),c.width,c.height)})(t,o,this.coordinates,r,i),t}},update:function(){this.$emit("change",this.getResult())},applyTransform:function(t){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],o=this.visibleArea&&n?Pi(this.sizeRestrictions,this.visibleArea):this.sizeRestrictions,i=this.visibleArea&&n?Te(this.positionRestrictions,this.visibleArea):this.positionRestrictions;return Oi({transform:t,coordinates:this.coordinates,imageSize:this.imageSize,sizeRestrictions:o,positionRestrictions:i,aspectRatio:this.getAspectRatio(),visibleArea:this.visibleArea})},resetCoordinates:function(){var t=this;if(this.$refs.image){this.$refs.cropper,this.$refs.image;var n=this.defaultSize;n||(n=this.stencilSize?Ki:Yi);var o=this.sizeRestrictions;o.minWidth,o.minHeight,o.maxWidth,o.maxHeight;var i=Ce(n)?n({boundaries:this.boundaries,imageSize:this.imageSize,aspectRatio:this.getAspectRatio(),sizeRestrictions:this.sizeRestrictions,stencilSize:this.getStencilSize(),visibleArea:this.visibleArea}):n,s=this.defaultPosition||qi,r=[i,function(l){var c=l.coordinates;return H({},Ce(s)?s({coordinates:c,imageSize:t.imageSize,visibleArea:t.visibleArea}):t.defaultPosition)}];this.delayedTransforms&&r.push.apply(r,Se(Array.isArray(this.delayedTransforms)?this.delayedTransforms:[this.delayedTransforms])),this.coordinates=this.applyTransform(r,!0),this.delayedTransforms=null}},clearImage:function(){var t=this;this.imageLoaded=!1,setTimeout((function(){var n=t.$refs.stretcher;n&&(n.style.height="auto",n.style.width="auto"),t.coordinates=t.defaultCoordinates(),t.boundaries={width:0,height:0}}),this.transitionTime)},enableTransitions:function(){this.transitions&&(this.transitionsActive=!0)},disableTransitions:function(){this.transitionsActive=!1},updateBoundaries:function(){var t=this,n=this.$refs.stretcher,o=this.$refs.cropper;return this.initStretcher({cropper:o,stretcher:n,imageSize:this.imageSize}),this.$nextTick().then((function(){var i={cropper:o,imageSize:t.imageSize};if(Ce(t.defaultBoundaries)?t.boundaries=t.defaultBoundaries(i):t.defaultBoundaries==="fit"?t.boundaries=(function(s){var r=s.cropper,l=s.imageSize,c=r.clientHeight,a=r.clientWidth,h=c,d=l.width*c/l.height;return d>a&&(d=a,h=l.height*a/l.width),{width:d,height:h}})(i):t.boundaries=(function(s){var r=s.cropper;return{width:r.clientWidth,height:r.clientHeight}})(i),!t.boundaries.width||!t.boundaries.height)throw new Error("It's impossible to fit the cropper in the current container")}))},resetVisibleArea:function(){var t=this;return this.appliedImageTransforms=H(H({},this.defaultImageTransforms),{},{flip:H({},this.defaultImageTransforms.flip)}),this.updateBoundaries().then((function(){t.priority!=="visible-area"&&(t.visibleArea=null,t.resetCoordinates());var n,o,i,s,r,l,c=t.defaultVisibleArea||Gi;t.visibleArea=Ce(c)?c({imageSize:t.imageSize,boundaries:t.boundaries,coordinates:t.priority!=="visible-area"?t.coordinates:null,getAreaRestrictions:t.getAreaRestrictions,stencilSize:t.getStencilSize()}):t.defaultVisibleArea,t.visibleArea=(n={visibleArea:t.visibleArea,boundaries:t.boundaries,getAreaRestrictions:t.getAreaRestrictions},o=n.visibleArea,i=n.boundaries,s=n.getAreaRestrictions,r=B({},o),l=P(i),r.width/r.height!==l&&(r.height=r.width/l),ee(r,s({visibleArea:r,type:"move"}))),t.priority==="visible-area"?t.resetCoordinates():t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("resetVisibleArea")})).catch((function(){t.visibleArea=null}))},updateVisibleArea:function(){var t=this;return this.updateBoundaries().then((function(){t.visibleArea=t.fitVisibleArea({imageSize:t.imageSize,boundaries:t.boundaries,visibleArea:t.visibleArea,coordinates:t.coordinates,getAreaRestrictions:t.getAreaRestrictions}),t.coordinates=t.fitCoordinates({visibleArea:t.visibleArea,coordinates:t.coordinates,aspectRatio:t.getAspectRatio(),positionRestrictions:t.positionRestrictions,sizeRestrictions:t.sizeRestrictions}),t.runAutoZoom("updateVisibleArea")})).catch((function(){t.visibleArea=null}))},onChange:function(){var t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];t&&this.debounce?this.debouncedUpdate():this.update()},onChangeImage:function(){var t,n=this;if(this.imageLoaded=!1,this.delayedTransforms=null,this.src){if((function(s){if(bt(s))return!1;var r=window.location,l=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(s)||[],c={protocol:l[1]||"",host:l[2]||"",port:l[3]||""},a=function(h){return h.port||((h.protocol||r.protocol)==="http"?80:433)};return!(!c.protocol&&!c.host&&!c.port||c.protocol&&c.protocol==r.protocol&&c.host&&c.host==r.host&&c.host&&a(c)==a(r))})(this.src)){var o=X(this.crossOrigin)?this.canvas:this.crossOrigin;o===!0&&(o="anonymous"),this.imageAttributes.crossOrigin=o||null}if(this.checkOrientation){var i=(t=this.src,new Promise((function(s){sr(t).then((function(r){var l=ar(r);s(r?{source:t,arrayBuffer:r,orientation:l}:{source:t,arrayBuffer:null,orientation:null})})).catch((function(r){console.warn(r),s({source:t,arrayBuffer:null,orientation:null})}))})));setTimeout((function(){i.then(n.onParseImage)}),this.transitionTime)}else setTimeout((function(){n.onParseImage({source:n.src})}),this.transitionTime)}else this.clearImage()},onFailLoadImage:function(){this.imageAttributes.src&&(this.clearImage(),this.$emit("error"))},onSuccessLoadImage:function(){var t=this,n=this.$refs.image;n&&!this.imageLoaded&&(this.imageAttributes.height=n.naturalHeight,this.imageAttributes.width=n.naturalWidth,this.imageLoaded=!0,this.resetVisibleArea().then((function(){t.$emit("ready"),t.onChange(!1)})))},onParseImage:function(t){var n=this,o=t.source,i=t.arrayBuffer,s=t.orientation;this.imageAttributes.revoke&&this.imageAttributes.src&&URL.revokeObjectURL(this.imageAttributes.src),this.imageAttributes.revoke=!1,i&&s&&s>1?It(o)||!bt(o)?(this.imageAttributes.src=URL.createObjectURL(new Blob([i])),this.imageAttributes.revoke=!0):this.imageAttributes.src=(function(r){for(var l=[],c=new Uint8Array(r);c.length>0;){var a=c.subarray(0,8192);l.push(String.fromCharCode.apply(null,Array.from?Array.from(a):a.slice())),c=c.subarray(8192)}return"data:image/jpeg;base64,"+btoa(l.join(""))})(i):this.imageAttributes.src=o,Ce(this.defaultTransforms)?this.appliedImageTransforms=Ze(this.defaultTransforms()):He(this.defaultTransforms)?this.appliedImageTransforms=Ze(this.defaultTransforms):this.appliedImageTransforms=(function(r){var l=Ze({});if(r)switch(r){case 2:l.flip.horizontal=!0;break;case 3:l.rotate=-180;break;case 4:l.flip.vertical=!0;break;case 5:l.rotate=90,l.flip.vertical=!0;break;case 6:l.rotate=90;break;case 7:l.rotate=90,l.flip.horizontal=!0;break;case 8:l.rotate=-90}return l})(s),this.defaultImageTransforms=H(H({},this.appliedImageTransforms),{},{flip:H({},this.appliedImageTransforms.flip)}),this.$nextTick((function(){var r=n.$refs.image;r&&r.complete&&((function(l){return!!l.naturalWidth})(r)?n.onSuccessLoadImage():n.onFailLoadImage())}))},onResizeEnd:function(){this.runAutoZoom("resize",{transitions:!0})},onMoveEnd:function(){this.runAutoZoom("move",{transitions:!0})},onMove:function(t){var n=this;this.transitionsOptions.enabled||this.awaitRender((function(){n.coordinates=n.moveAlgorithm(H(H({},n.getPublicProperties()),{},{positionRestrictions:Te(n.positionRestrictions,n.visibleArea),coordinates:n.coordinates,event:n.normalizeEvent(t)})),n.onChange()}))},onResize:function(t){var n=this;this.transitionsOptions.enabled||this.stencilSize&&!this.autoZoom||this.awaitRender((function(){var o=n.sizeRestrictions,i=Math.min(n.coordinates.width,n.coordinates.height,20*n.coefficient);n.coordinates=n.resizeAlgorithm(H(H({},n.getPublicProperties()),{},{positionRestrictions:Te(n.positionRestrictions,n.visibleArea),sizeRestrictions:{maxWidth:Math.min(o.maxWidth,n.visibleArea.width),maxHeight:Math.min(o.maxHeight,n.visibleArea.height),minWidth:Math.max(o.minWidth,i),minHeight:Math.max(o.minHeight,i)},event:n.normalizeEvent(t)})),n.onChange(),n.ticking=!1}))},onManipulateImage:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.transitionsOptions.enabled){var o=n.transitions,i=o!==void 0&&o,s=n.normalize,r=s===void 0||s;i&&this.enableTransitions();var l=Xi(H(H({},this.getPublicProperties()),{},{event:r?this.normalizeEvent(t):t,getAreaRestrictions:this.getAreaRestrictions,imageRestriction:this.imageRestriction,adjustStencil:!this.stencilSize&&this.settings.resizeImage.adjustStencil})),c=l.visibleArea,a=l.coordinates;this.visibleArea=c,this.coordinates=a,this.runAutoZoom("manipulateImage"),this.onChange(),i&&this.debouncedDisableTransitions()}},onPropsChange:function(){this.coordinates=this.applyTransform(this.coordinates,!0),this.onChange(!1)},getAreaRestrictions:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.visibleArea,o=t.type,i=o===void 0?"move":o;return this.areaRestrictionsAlgorithm({boundaries:this.boundaries,imageSize:this.imageSize,imageRestriction:this.imageRestriction,visibleArea:n,type:i})},getAspectRatio:function(t){var n,o,i=this.stencilProps,s=i.aspectRatio,r=i.minAspectRatio,l=i.maxAspectRatio;if(this.$refs.stencil&&this.$refs.stencil.aspectRatios){var c=this.$refs.stencil.aspectRatios();n=c.minimum,o=c.maximum}if(X(n)&&(n=X(s)?r:s),X(o)&&(o=X(s)?l:s),!t&&(X(n)||X(o))){var a=this.getStencilSize(),h=a?P(a):null;X(n)&&(n=kt(h)?h:void 0),X(o)&&(o=kt(h)?h:void 0)}return{minimum:n,maximum:o}},getStencilSize:function(){if(this.stencilSize)return t={currentStencilSize:{width:this.stencilCoordinates.width,height:this.stencilCoordinates.height},stencilSize:this.stencilSize,boundaries:this.boundaries,coefficient:this.coefficient,coordinates:this.coordinates,aspectRatio:this.getAspectRatio(!0)},n=t.boundaries,o=t.stencilSize,i=t.aspectRatio,Xe(P(s=Ce(o)?o({boundaries:n,aspectRatio:i}):o),i)&&(s=ve({sizeRestrictions:{maxWidth:n.width,maxHeight:n.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:i.minimum,maximum:i.maximum}})),(s.width>n.width||s.height>n.height)&&(s=ve({sizeRestrictions:{maxWidth:n.width,maxHeight:n.height,minWidth:0,minHeight:0},width:s.width,height:s.height,aspectRatio:{minimum:P(s),maximum:P(s)}})),s;var t,n,o,i,s},getPublicProperties:function(){return{coefficient:this.coefficient,visibleArea:this.visibleArea,coordinates:this.coordinates,boundaries:this.boundaries,sizeRestrictions:this.sizeRestrictions,positionRestrictions:this.positionRestrictions,aspectRatio:this.getAspectRatio(),imageRestriction:this.imageRestriction}},defaultCoordinates:function(){return H({},yt)},flip:function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.transitions,s=i===void 0||i;if(!this.transitionsActive){s&&this.enableTransitions();var r=H({},this.imageTransforms.flip),l=Zi({flip:{horizontal:t?!r.horizontal:r.horizontal,vertical:n?!r.vertical:r.vertical},previousFlip:r,rotate:this.imageTransforms.rotate,visibleArea:this.visibleArea,coordinates:this.coordinates,imageSize:this.imageSize,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),c=l.visibleArea,a=l.coordinates;t&&(this.appliedImageTransforms.flip.horizontal=!this.appliedImageTransforms.flip.horizontal),n&&(this.appliedImageTransforms.flip.vertical=!this.appliedImageTransforms.flip.vertical),this.visibleArea=c,this.coordinates=a,this.onChange(),s&&this.debouncedDisableTransitions()}},rotate:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.transitions,i=o===void 0||o;if(!this.transitionsActive){i&&this.enableTransitions();var s=H({},this.imageSize);this.appliedImageTransforms.rotate+=t;var r=Qi({visibleArea:this.visibleArea,coordinates:this.coordinates,previousImageSize:s,imageSize:this.imageSize,angle:t,positionRestrictions:this.positionRestrictions,sizeRestrictions:this.sizeRestrictions,getAreaRestrictions:this.getAreaRestrictions,aspectRatio:this.getAspectRatio()}),l=r.visibleArea,c=r.coordinates,a=this.processAutoZoom("rotateImage",l,c);l=a.visibleArea,c=a.coordinates,this.visibleArea=l,this.coordinates=c,this.onChange(),i&&this.debouncedDisableTransitions()}}},emits:["change","error","ready"]},cr={key:0,ref:"canvas",style:{display:"none"}},ur={key:1,ref:"sourceCanvas",style:{display:"none"}};Zt.render=function(t,n,o,i,s,r){return e.openBlock(),e.createBlock("div",{ref:"cropper",class:r.classes.cropper},[e.createVNode("div",{ref:"stretcher",class:r.classes.stretcher},null,2),e.createVNode("div",{class:r.classes.boundaries,style:r.boundariesStyle},[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.backgroundWrapperComponent),{class:r.classes.cropperWrapper,"wheel-resize":r.settings.resizeImage.wheel,"touch-resize":r.settings.resizeImage.touch,"touch-move":r.settings.moveImage.touch,"mouse-move":r.settings.moveImage.mouse,onMove:r.onManipulateImage,onResize:r.onManipulateImage},{default:e.withCtx((function(){return[e.createVNode("div",{class:r.classes.background,style:r.boundariesStyle},null,6),e.createVNode("div",{class:r.classes.imageWrapper},[e.createVNode("img",{ref:"image",crossorigin:s.imageAttributes.crossOrigin,src:s.imageAttributes.src,class:r.classes.image,style:r.imageStyle,onMousedown:n[1]||(n[1]=e.withModifiers((function(){}),["prevent"]))},null,46,["crossorigin","src"])],2),e.createVNode("div",{class:r.classes.foreground,style:r.boundariesStyle},null,6),e.withDirectives((e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.stencilComponent),e.mergeProps({ref:"stencil",image:r.image,coordinates:s.coordinates,"stencil-coordinates":r.stencilCoordinates,transitions:r.transitionsOptions},o.stencilProps,{onResize:r.onResize,onResizeEnd:r.onResizeEnd,onMove:r.onMove,onMoveEnd:r.onMoveEnd}),null,16,["image","coordinates","stencil-coordinates","transitions","onResize","onResizeEnd","onMove","onMoveEnd"])),[[e.vShow,s.imageLoaded]]),o.canvas?(e.openBlock(),e.createBlock("canvas",cr,null,512)):e.createCommentVNode("",!0),o.canvas?(e.openBlock(),e.createBlock("canvas",ur,null,512)):e.createCommentVNode("",!0)]})),_:1},8,["class","wheel-resize","touch-resize","touch-move","mouse-move","onMove","onResize"]))],6)],2)};const dr={class:"vuefinder__image-preview"},hr={class:"vuefinder__image-preview__header"},mr=["title"],fr={class:"vuefinder__image-preview__actions"},pr={class:"vuefinder__image-preview__image-container h-[50vh] w-full"},vr=["src"],gr=e.defineComponent({name:"ImagePreview",__name:"Image",emits:["success"],setup(t,{emit:n}){const o=n,i=e.inject("ServiceContainer"),{t:s}=i.i18n,r=e.ref(!1),l=e.ref(""),c=e.ref(!1),a=e.ref(i.requester.getPreviewUrl(i.modal.data.storage,i.modal.data.item)),h=e.useTemplateRef("cropperRef"),d=async()=>{r.value=!r.value},u=async()=>{const f=h.value?.getResult({size:{width:795,height:341},fillColor:"#ffffff"})?.canvas;f&&f.toBlob(v=>{if(!v)return;l.value="",c.value=!1;const p=new FormData;p.set("file",v),i.requester.send({url:"",method:"post",params:{q:"upload",storage:i.modal.data.storage,adapter:i.modal.data.storage,path:i.modal.data.item.path},body:p}).then(()=>{l.value=s("Updated."),d(),o("success")}).catch(_=>{const g=_?.message??"Error";l.value=s(g),c.value=!0})})};return e.onMounted(()=>{o("success")}),(m,f)=>(e.openBlock(),e.createElementBlock("div",dr,[e.createElementVNode("div",hr,[e.createElementVNode("h3",{class:"vuefinder__image-preview__title",id:"modal-title",title:e.unref(i).modal.data.item.path},e.toDisplayString(e.unref(i).modal.data.item.basename),9,mr),e.createElementVNode("div",fr,[r.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:u,class:"vuefinder__image-preview__crop-button"},e.toDisplayString(e.unref(s)("Crop")),1)):e.createCommentVNode("",!0),e.unref(i).features.includes(e.unref(W).EDIT)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"vuefinder__image-preview__edit-button",onClick:f[0]||(f[0]=v=>d())},e.toDisplayString(r.value?e.unref(s)("Cancel"):e.unref(s)("Edit")),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",pr,[r.value?(e.openBlock(),e.createBlock(e.unref(Zt),{key:1,ref_key:"cropperRef",ref:h,class:"w-full h-full",crossorigin:"anonymous",src:a.value,"stencil-props":{aspectRatio:795/341},"auto-zoom":!0,priority:"image",transitions:!0},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:0,style:{width:"100%",height:"100%"},src:e.unref(i).requester.getPreviewUrl(e.unref(i).modal.data.storage,e.unref(i).modal.data.item),class:"vuefinder__image-preview__image w-full h-full"},null,8,vr))]),l.value.length?(e.openBlock(),e.createBlock(e.unref(l),{key:0,onHidden:f[1]||(f[1]=v=>l.value=""),error:c.value},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.value),1)]),_:1},8,["error"])):e.createCommentVNode("",!0)]))}}),_r={class:"vuefinder__default-preview"},wr={class:"vuefinder__default-preview__header"},br=["title"],kr=e.defineComponent({__name:"Default",emits:["success"],setup(t,{emit:n}){const o=e.inject("ServiceContainer"),i=n;return e.onMounted(()=>{i("success")}),(s,r)=>(e.openBlock(),e.createElementBlock("div",_r,[e.createElementVNode("div",wr,[e.createElementVNode("h3",{class:"vuefinder__default-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,br)]),r[0]||(r[0]=e.createElementVNode("div",null,null,-1))]))}}),yr={class:"vuefinder__video-preview"},Er=["title"],Sr={class:"vuefinder__video-preview__video",preload:"metadata",controls:""},xr=["src"],Cr=e.defineComponent({__name:"Video",emits:["success"],setup(t,{emit:n}){const o=e.inject("ServiceContainer"),i=n,s=()=>o.requester.getPreviewUrl(o.modal.data.storage,o.modal.data.item);return e.onMounted(()=>{i("success")}),(r,l)=>(e.openBlock(),e.createElementBlock("div",yr,[e.createElementVNode("h3",{class:"vuefinder__video-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,Er),e.createElementVNode("div",null,[e.createElementVNode("video",Sr,[e.createElementVNode("source",{src:s(),type:"video/mp4"},null,8,xr),l[0]||(l[0]=e.createTextVNode(" Your browser does not support the video tag. ",-1))])])]))}}),Br={class:"vuefinder__audio-preview"},Vr=["title"],Nr={class:"vuefinder__audio-preview__audio",controls:""},Mr=["src"],$r=e.defineComponent({__name:"Audio",emits:["success"],setup(t,{emit:n}){const o=n,i=e.inject("ServiceContainer"),s=()=>i.requester.getPreviewUrl(i.modal.data.storage,i.modal.data.item);return e.onMounted(()=>{o("success")}),(r,l)=>(e.openBlock(),e.createElementBlock("div",Br,[e.createElementVNode("h3",{class:"vuefinder__audio-preview__title",id:"modal-title",title:e.unref(i).modal.data.item.path},e.toDisplayString(e.unref(i).modal.data.item.basename),9,Vr),e.createElementVNode("div",null,[e.createElementVNode("audio",Nr,[e.createElementVNode("source",{src:s(),type:"audio/mpeg"},null,8,Mr),l[0]||(l[0]=e.createTextVNode(" Your browser does not support the audio element. ",-1))])])]))}}),Ar={class:"vuefinder__pdf-preview"},Dr=["title"],zr=["data"],Rr=["src"],Tr=e.defineComponent({__name:"Pdf",emits:["success"],setup(t,{emit:n}){const o=e.inject("ServiceContainer"),i=n,s=()=>o.requester.getPreviewUrl(o.modal.data.storage,o.modal.data.item);return e.onMounted(()=>{i("success")}),(r,l)=>(e.openBlock(),e.createElementBlock("div",Ar,[e.createElementVNode("h3",{class:"vuefinder__pdf-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,Dr),e.createElementVNode("div",null,[e.createElementVNode("object",{class:"vuefinder__pdf-preview__object",data:s(),type:"application/pdf",width:"100%",height:"100%"},[e.createElementVNode("iframe",{class:"vuefinder__pdf-preview__iframe",src:s(),width:"100%",height:"100%"}," Your browser does not support PDFs ",8,Rr)],8,zr)])]))}});function Ir(t,n=null){return new Date(t*1e3).toLocaleString(n??navigator.language??"en-US")}const Lr={class:"vuefinder__preview-modal__content"},Fr={key:0},Hr={class:"vuefinder__preview-modal__loading"},Pr={key:0,class:"vuefinder__preview-modal__loading-indicator"},Or={class:"vuefinder__preview-modal__details"},jr={class:"font-bold"},Wr={class:"font-bold pl-2"},Ur={key:0,class:"vuefinder__preview-modal__note"},qr=["download","href"],Jt=e.defineComponent({__name:"ModalPreview",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=e.ref(!1),s=l=>(n.modal.data.item.mime_type??"").startsWith(l),r=n.features.includes(W.PREVIEW);return r||(i.value=!0),(l,c)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:c[6]||(c[6]=a=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Close")),1),e.unref(n).features.includes(e.unref(W).DOWNLOAD)?(e.openBlock(),e.createElementBlock("a",{key:0,target:"_blank",class:"vf-btn vf-btn-primary",download:e.unref(n).requester.getDownloadUrl(e.unref(n).modal.data.storage,e.unref(n).modal.data.item),href:e.unref(n).requester.getDownloadUrl(e.unref(n).modal.data.storage,e.unref(n).modal.data.item)},e.toDisplayString(e.unref(o)("Download")),9,qr)):e.createCommentVNode("",!0)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createElementVNode("div",Lr,[e.unref(r)?(e.openBlock(),e.createElementBlock("div",Fr,[s("text")?(e.openBlock(),e.createBlock($i,{key:0,onSuccess:c[0]||(c[0]=a=>i.value=!0)})):s("image")?(e.openBlock(),e.createBlock(gr,{key:1,onSuccess:c[1]||(c[1]=a=>i.value=!0)})):s("video")?(e.openBlock(),e.createBlock(Cr,{key:2,onSuccess:c[2]||(c[2]=a=>i.value=!0)})):s("audio")?(e.openBlock(),e.createBlock($r,{key:3,onSuccess:c[3]||(c[3]=a=>i.value=!0)})):s("application/pdf")?(e.openBlock(),e.createBlock(Tr,{key:4,onSuccess:c[4]||(c[4]=a=>i.value=!0)})):(e.openBlock(),e.createBlock(kr,{key:5,onSuccess:c[5]||(c[5]=a=>i.value=!0)}))])):e.createCommentVNode("",!0),e.createElementVNode("div",Hr,[i.value===!1?(e.openBlock(),e.createElementBlock("div",Pr,[c[7]||(c[7]=e.createElementVNode("svg",{class:"vuefinder__preview-modal__spinner",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e.createElementVNode("circle",{class:"vuefinder__preview-modal__spinner-circle",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e.createElementVNode("path",{class:"vuefinder__preview-modal__spinner-path",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(e.unref(o)("Loading")),1)])):e.createCommentVNode("",!0)])])]),e.createElementVNode("div",Or,[e.createElementVNode("div",null,[e.createElementVNode("span",jr,e.toDisplayString(e.unref(o)("File Size"))+": ",1),e.createTextVNode(e.toDisplayString(e.unref(n).filesize(e.unref(n).modal.data.item.file_size)),1)]),e.createElementVNode("div",null,[e.createElementVNode("span",Wr,e.toDisplayString(e.unref(o)("Last Modified"))+": ",1),e.createTextVNode(" "+e.toDisplayString(e.unref(Ir)(e.unref(n).modal.data.item.last_modified)),1)])]),e.unref(n).features.includes(e.unref(W).DOWNLOAD)?(e.openBlock(),e.createElementBlock("div",Ur,[e.createElementVNode("span",null,e.toDisplayString(e.unref(o)(`Download doesn't work? You can try right-click "Download" button, select "Save link as...".`)),1)])):e.createCommentVNode("",!0)]),_:1}))}}),Yr={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true",class:"h-6 w-6 stroke-blue-600 dark:stroke-blue-100",viewBox:"0 0 24 24"};function Kr(t,n){return e.openBlock(),e.createElementBlock("svg",Yr,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3"},null,-1)])])}const Gr={render:Kr},Xr={class:"vuefinder__move-modal__content"},Qr={class:"vuefinder__move-modal__description"},Zr={class:"vuefinder__move-modal__files vf-scrollbar"},Jr={key:0,class:"vuefinder__move-modal__icon vuefinder__move-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},es={key:1,class:"vuefinder__move-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},ts={class:"vuefinder__move-modal__file-name"},ns={class:"vuefinder__move-modal__target-title"},os={class:"vuefinder__move-modal__target-directory"},is={class:"vuefinder__move-modal__target-path"},rs={class:"vuefinder__move-modal__selected-items"},en=e.defineComponent({__name:"ModalTransfer",props:{q:{},title:{},body:{},successBtn:{},successText:{}},setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=R.useStore(i.path),r=t,l=e.ref(n.modal.data.items.from),c=n.modal.data.items.to,a=e.ref("");console.log(c.value.path);const h=()=>{l.value.length&&n.emitter.emit("vf-fetch",{params:{q:r.q,m:"post",storage:s.value.storage,path:s.value.path},body:{items:l.value.map(({path:d,type:u})=>({path:d,type:u})),item:c.value.path},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:r.successText})},onError:d=>{a.value=o(d.message)}})};return(d,u)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:h,class:"vf-btn vf-btn-primary"},e.toDisplayString(r.successBtn),1),e.createElementVNode("button",{type:"button",onClick:u[1]||(u[1]=m=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1),e.createElementVNode("div",rs,e.toDisplayString(e.unref(o)("%s item(s) selected.",l.value.size)),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(Gr),title:r.title},null,8,["icon","title"]),e.createElementVNode("div",Xr,[e.createElementVNode("p",Qr,e.toDisplayString(r.body),1),e.createElementVNode("div",Zr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,m=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__move-modal__file",key:m.path},[e.createElementVNode("div",null,[m.type==="dir"?(e.openBlock(),e.createElementBlock("svg",Jr,[...u[2]||(u[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",es,[...u[3]||(u[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])]))]),e.createElementVNode("div",ts,e.toDisplayString(m.path),1)]))),128))]),e.createElementVNode("h4",ns,e.toDisplayString(e.unref(o)("Target Directory")),1),e.createElementVNode("p",os,[u[4]||(u[4]=e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"vuefinder__move-modal__icon vuefinder__move-modal__icon--dir",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),e.createElementVNode("span",is,e.toDisplayString(e.unref(c).value.path),1)]),a.value.length?(e.openBlock(),e.createBlock(e.unref(a),{key:0,onHidden:u[0]||(u[0]=m=>a.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.value),1)]),_:1})):e.createCommentVNode("",!0)])])]),_:1}))}}),tn=e.defineComponent({__name:"ModalMove",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n;return(i,s)=>(e.openBlock(),e.createBlock(en,{q:"move",title:e.unref(o)("Move files"),body:e.unref(o)("Are you sure you want to move these files"),"success-btn":e.unref(o)("Yes, Move!"),"success-text":e.unref(o)("Files moved.")},null,8,["title","body","success-btn","success-text"]))}}),ss=e.defineComponent({__name:"ModalCopy",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n;return(i,s)=>(e.openBlock(),e.createBlock(en,{q:"copy",title:e.unref(o)("Copy files"),body:e.unref(o)("Are you sure you want to copy these files"),"success-btn":e.unref(o)("Yes, Copy!"),"success-text":e.unref(o)("Files copied.")},null,8,["title","body","success-btn","success-text"]))}}),se={ESCAPE:"Escape",F2:"F2",F5:"F5",DELETE:"Delete",ENTER:"Enter",BACKSLASH:"Backslash",KEY_A:"KeyA",KEY_E:"KeyE",KEY_F:"KeyF",SPACE:"Space",KEY_C:"KeyC",KEY_X:"KeyX",KEY_V:"KeyV"};function as(t){const n=t.search,o=t.fs,i=t.config,s=R.useStore(n.state),r=R.useStore(o.selectedItems),l=c=>{if(c.code===se.ESCAPE&&(t.modal.close(),t.root.focus()),!t.modal.visible&&!s.value?.searchMode){if(c.code===se.F2&&t.features.includes(W.RENAME)&&r.value.length===1&&t.modal.open(dt,{items:r.value}),c.code===se.F5&&t.emitter.emit("vf-fetch",{params:{q:"index",storage:o.path.get().storage,path:o.path.get().path}}),c.code===se.DELETE&&r.value.length===0&&t.modal.open(ut,{items:r.value}),c.ctrlKey&&c.code===se.BACKSLASH&&t.modal.open(At),c.ctrlKey&&c.code===se.KEY_F&&t.features.includes(W.SEARCH)&&(n.enterSearchMode(),c.preventDefault()),c.ctrlKey&&c.code===se.KEY_E&&(i.toggle("showTreeView"),c.preventDefault()),c.ctrlKey&&c.code===se.ENTER&&(i.toggle("fullScreen"),t.root.focus()),c.ctrlKey&&c.code===se.KEY_A&&(o.selectAll(),c.preventDefault()),c.code===se.SPACE&&r.value.length===1&&r.value[0]?.type!=="dir"&&t.modal.open(Jt,{storage:o.path.get().storage,item:r.value[0]}),c.metaKey&&c.code===se.KEY_C){if(r.value.length===0){t.emitter.emit("vf-toast-push",{type:"error",label:t.i18n.t("No items selected")});return}o.setClipboard("copy",new Set(r.value.map(a=>a.path))),t.emitter.emit("vf-toast-push",{label:r.value.length===1?t.i18n.t("Item copied to clipboard"):t.i18n.t("%s items copied to clipboard",r.value.length)}),c.preventDefault()}if(c.metaKey&&c.code===se.KEY_X){if(r.value.length===0){t.emitter.emit("vf-toast-push",{type:"error",label:t.i18n.t("No items selected")});return}o.setClipboard("cut",new Set(r.value.map(a=>a.path))),t.emitter.emit("vf-toast-push",{label:r.value.length===1?t.i18n.t("Item cut to clipboard"):t.i18n.t("%s items cut to clipboard",r.value.length)}),c.preventDefault()}if(c.metaKey&&c.code===se.KEY_V){if(o.getClipboard().items.size===0){t.emitter.emit("vf-toast-push",{type:"error",label:t.i18n.t("No items in clipboard")});return}if(o.getClipboard().path===o.path.get().path){t.emitter.emit("vf-toast-push",{type:"error",label:t.i18n.t("Cannot paste items to the same directory")});return}if(o.getClipboard().type==="cut"){t.modal.open(tn,{items:{from:o.getClipboard().items,to:o.path}}),o.clearClipboard();return}if(o.getClipboard().type==="copy"){t.modal.open(ss,{items:{from:o.getClipboard().items,to:o.path}});return}c.preventDefault()}}};e.onMounted(()=>{t.root.addEventListener("keydown",l)}),e.onBeforeUnmount(()=>{t.root.removeEventListener("keydown",l)})}const ls={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function cs(t,n){return e.openBlock(),e.createElementBlock("svg",ls,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44z"},null,-1)])])}const nn={render:cs},us={class:"vuefinder__new-folder-modal__content"},ds={class:"vuefinder__new-folder-modal__form"},hs={class:"vuefinder__new-folder-modal__description"},ms=["placeholder"],on=e.defineComponent({__name:"ModalNewFolder",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=R.useStore(i.path),r=e.ref(""),l=e.ref(""),c=()=>{r.value!==""&&n.emitter.emit("vf-fetch",{params:{q:"newfolder",m:"post",storage:s.value.storage,path:s.value.path},body:{name:r.value},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:o("%s is created.",r.value)})},onError:a=>{l.value=o(a.message)}})};return(a,h)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:c,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Create")),1),e.createElementVNode("button",{type:"button",onClick:h[2]||(h[2]=d=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(nn),title:e.unref(o)("New Folder")},null,8,["icon","title"]),e.createElementVNode("div",us,[e.createElementVNode("div",ds,[e.createElementVNode("p",hs,e.toDisplayString(e.unref(o)("Create a new folder")),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":h[0]||(h[0]=d=>r.value=d),onKeyup:e.withKeys(c,["enter"]),class:"vuefinder__new-folder-modal__input",placeholder:e.unref(o)("Folder Name"),type:"text"},null,40,ms),[[e.vModelText,r.value]]),l.value.length?(e.openBlock(),e.createBlock(e.unref(l),{key:0,onHidden:h[1]||(h[1]=d=>l.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),fs={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function ps(t,n){return e.openBlock(),e.createElementBlock("svg",fs,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9"},null,-1)])])}const rn={render:ps},vs={class:"vuefinder__new-file-modal__content"},gs={class:"vuefinder__new-file-modal__form"},_s={class:"vuefinder__new-file-modal__description"},ws=["placeholder"],bs=e.defineComponent({__name:"ModalNewFile",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=R.useStore(i.path),r=e.ref(""),l=e.ref(""),c=()=>{r.value!==""&&n.emitter.emit("vf-fetch",{params:{q:"newfile",m:"post",storage:s.value.storage,path:s.value.path},body:{name:r.value},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:o("%s is created.",r.value)})},onError:a=>{l.value=o(a.message)}})};return(a,h)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:c,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Create")),1),e.createElementVNode("button",{type:"button",onClick:h[2]||(h[2]=d=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(rn),title:e.unref(o)("New File")},null,8,["icon","title"]),e.createElementVNode("div",vs,[e.createElementVNode("div",gs,[e.createElementVNode("p",_s,e.toDisplayString(e.unref(o)("Create a new file")),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":h[0]||(h[0]=d=>r.value=d),onKeyup:e.withKeys(c,["enter"]),class:"vuefinder__new-file-modal__input",placeholder:e.unref(o)("File Name"),type:"text"},null,40,ws),[[e.vModelText,r.value]]),l.value.length?(e.openBlock(),e.createBlock(e.unref(l),{key:0,onHidden:h[1]||(h[1]=d=>l.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),Z={PENDING:0,CANCELED:1,UPLOADING:2,ERROR:3,DONE:10};function ks(){const t=e.inject("ServiceContainer"),{t:n}=t.i18n,o=t.fs,i=t.config,s=e.ref({QUEUE_ENTRY_STATUS:Z}),r=e.ref(null),l=e.ref(null),c=e.ref(null),a=e.ref(null),h=e.ref(null),d=e.ref(null),u=e.ref([]),m=e.ref(""),f=e.ref(!1),v=e.ref(!1);let p;const _=T=>u.value.findIndex(G=>G.id===T),g=(T,G)=>p.addFile({name:G||T.name,type:T.type,data:T,source:"Local"}),k=T=>T.status===Z.DONE?"text-green-600":T.status===Z.ERROR||T.status===Z.CANCELED?"text-red-600":"",S=T=>T.status===Z.DONE?"✓":T.status===Z.ERROR||T.status===Z.CANCELED?"!":"...",N=()=>a.value?.click(),O=()=>t.modal.close(),q=()=>{if(f.value||!u.value.filter(T=>T.status!==Z.DONE).length){f.value||(m.value=n("Please select file to upload first."));return}m.value="",p.retryAll(),p.upload()},$=()=>{p.cancelAll(),u.value.forEach(T=>{T.status!==Z.DONE&&(T.status=Z.CANCELED,T.statusName=n("Canceled"))}),f.value=!1},V=T=>{f.value||(p.removeFile(T.id),u.value.splice(_(T.id),1))},Y=T=>{if(!f.value)if(p.cancelAll(),T){const G=u.value.filter(C=>C.status!==Z.DONE);u.value=[],G.forEach(C=>g(C.originalFile,C.name))}else u.value=[]};return e.onMounted(()=>{p=new En({debug:t.debug,restrictions:{maxFileSize:zn(i.maxFileSize??"10mb")},locale:t.i18n.t("uppy"),onBeforeFileAdded:(C,b)=>{if(b[C.id]!=null){const I=_(C.id);u.value[I]?.status===Z.PENDING&&(m.value=p.i18n("noDuplicates",{fileName:C.name})),u.value=u.value.filter(L=>L.id!==C.id)}return u.value.push({id:C.id,name:C.name,size:t.filesize(C.size),status:Z.PENDING,statusName:n("Pending upload"),percent:null,originalFile:C.data}),!0}}),p.use(Sn,{endpoint:"WILL_BE_REPLACED_BEFORE_UPLOAD",limit:5,timeout:0}),p.on("restriction-failed",(C,b)=>{const y=u.value[_(C.id)];y&&V(y),m.value=b.message}),p.on("upload",()=>{const C=t.requester.transformRequestParams({url:"",method:"post",params:{q:"upload",storage:o.path.storage,path:o.path.path}});p.setMeta({...C.body});const b=p.getPlugin("XHRUpload");b&&(b.opts.method=C.method,b.opts.endpoint=C.url+"?"+new URLSearchParams(C.params),b.opts.headers=C.headers),delete C.headers["Content-Type"],f.value=!0,u.value.forEach(y=>{y.status!==Z.DONE&&(y.percent=null,y.status=Z.UPLOADING,y.statusName=n("Pending upload"))})}),p.on("upload-progress",(C,b)=>{const y=b.bytesTotal??1,I=Math.floor(b.bytesUploaded/y*100),L=_(C.id);L!==-1&&u.value[L]&&(u.value[L].percent=`${I}%`)}),p.on("upload-success",C=>{const b=u.value[_(C.id)];b&&(b.status=Z.DONE,b.statusName=n("Done"))}),p.on("upload-error",(C,b)=>{const y=u.value[_(C.id)];y&&(y.percent=null,y.status=Z.ERROR,y.statusName=b?.isNetworkError?n("Network Error, Unable establish connection to the server or interrupted."):b?.message||n("Unknown Error"))}),p.on("error",C=>{m.value=C.message,f.value=!1,t.emitter.emit("vf-fetch",{params:{q:"index"},noCloseModal:!0})}),p.on("complete",()=>{f.value=!1,t.emitter.emit("vf-fetch",{params:{q:"index"},noCloseModal:!0})}),a.value?.addEventListener("click",()=>l.value?.click()),h.value?.addEventListener("click",()=>c.value?.click()),d.value?.addEventListener("dragover",C=>{C.preventDefault(),v.value=!0}),d.value?.addEventListener("dragleave",C=>{C.preventDefault(),v.value=!1});const T=(C,b)=>{b.isFile&&b.file(y=>C(b,y)),b.isDirectory&&b.createReader().readEntries(y=>y.forEach(I=>T(C,I)))};d.value?.addEventListener("drop",C=>{C.preventDefault(),v.value=!1;const b=/^[/\\](.+)/,y=C.dataTransfer?.items;y&&Array.from(y).forEach(I=>{I.kind==="file"&&T((L,F)=>{const j=b.exec(L.fullPath);g(F,j?j[1]:F.name)},I.webkitGetAsEntry())})});const G=C=>{const b=C.target,y=b.files;if(y){for(const I of y)g(I);b.value=""}};l.value?.addEventListener("change",G),c.value?.addEventListener("change",G)}),{container:r,internalFileInput:l,internalFolderInput:c,pickFiles:a,pickFolders:h,dropArea:d,queue:u,message:m,uploading:f,hasFilesInDropArea:v,definitions:s,openFileSelector:N,upload:q,cancel:$,remove:V,clear:Y,close:O,getClassNameForEntry:k,getIconForEntry:S}}function lt(t,n=14){const o=`((?=([\\w\\W]{0,${n}}))([\\w\\W]{${n+1},})([\\w\\W]{8,}))`;return t.replace(new RegExp(o),"$2..$4")}const ys={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function Es(t,n){return e.openBlock(),e.createElementBlock("svg",ys,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"},null,-1)])])}const sn={render:Es},Ss={class:"vuefinder__upload-modal__content"},xs={key:0,class:"pointer-events-none"},Cs={key:1,class:"pointer-events-none"},Bs=["disabled"],Vs=["disabled"],Ns={class:"vuefinder__upload-modal__file-list vf-scrollbar"},Ms=["textContent"],$s={class:"vuefinder__upload-modal__file-info"},As={class:"vuefinder__upload-modal__file-name hidden md:block"},Ds={class:"vuefinder__upload-modal__file-name md:hidden"},zs={key:0,class:"ml-auto"},Rs=["title","disabled","onClick"],Ts={key:0,class:"py-2"},Is=["disabled"],Ls=e.defineComponent({__name:"ModalUpload",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,{container:i,internalFileInput:s,internalFolderInput:r,pickFiles:l,pickFolders:c,dropArea:a,queue:h,message:d,uploading:u,hasFilesInDropArea:m,definitions:f,openFileSelector:v,upload:p,cancel:_,remove:g,clear:k,close:S,getClassNameForEntry:N,getIconForEntry:O}=ks();return(q,$)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-primary",disabled:e.unref(u),onClick:$[4]||($[4]=e.withModifiers((...V)=>e.unref(p)&&e.unref(p)(...V),["prevent"]))},e.toDisplayString(e.unref(o)("Upload")),9,Is),e.unref(u)?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:"vf-btn vf-btn-secondary",onClick:$[5]||($[5]=e.withModifiers((...V)=>e.unref(_)&&e.unref(_)(...V),["prevent"]))},e.toDisplayString(e.unref(o)("Cancel")),1)):(e.openBlock(),e.createElementBlock("button",{key:1,type:"button",class:"vf-btn vf-btn-secondary",onClick:$[6]||($[6]=e.withModifiers((...V)=>e.unref(S)&&e.unref(S)(...V),["prevent"]))},e.toDisplayString(e.unref(o)("Close")),1))]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(sn),title:e.unref(o)("Upload Files")},null,8,["icon","title"]),e.createElementVNode("div",Ss,[e.createElementVNode("div",{class:"vuefinder__upload-modal__drop-area",ref_key:"dropArea",ref:a,onClick:$[0]||($[0]=(...V)=>e.unref(v)&&e.unref(v)(...V))},[e.unref(m)?(e.openBlock(),e.createElementBlock("div",xs,e.toDisplayString(e.unref(o)("Release to drop these files.")),1)):(e.openBlock(),e.createElementBlock("div",Cs,e.toDisplayString(e.unref(o)("Drag and drop the files/folders to here or click here.")),1))],512),e.createElementVNode("div",{ref_key:"container",ref:i,class:"vuefinder__upload-modal__buttons"},[e.createElementVNode("button",{ref_key:"pickFiles",ref:l,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Select Files")),513),e.createElementVNode("button",{ref_key:"pickFolders",ref:c,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Select Folders")),513),e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-secondary",disabled:e.unref(u),onClick:$[1]||($[1]=V=>e.unref(k)(!1))},e.toDisplayString(e.unref(o)("Clear all")),9,Bs),e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-secondary",disabled:e.unref(u),onClick:$[2]||($[2]=V=>e.unref(k)(!0))},e.toDisplayString(e.unref(o)("Clear only successful")),9,Vs)],512),e.createElementVNode("div",Ns,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(h),V=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__upload-modal__file-entry",key:V.id},[e.createElementVNode("span",{class:e.normalizeClass(["vuefinder__upload-modal__file-icon",e.unref(N)(V)])},[e.createElementVNode("span",{class:"vuefinder__upload-modal__file-icon-text",textContent:e.toDisplayString(e.unref(O)(V))},null,8,Ms)],2),e.createElementVNode("div",$s,[e.createElementVNode("div",As,e.toDisplayString(e.unref(lt)(V.name,40))+" ("+e.toDisplayString(V.size)+") ",1),e.createElementVNode("div",Ds,e.toDisplayString(e.unref(lt)(V.name,16))+" ("+e.toDisplayString(V.size)+") ",1),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__upload-modal__file-status",e.unref(N)(V)])},[e.createTextVNode(e.toDisplayString(V.statusName)+" ",1),V.status===e.unref(f).QUEUE_ENTRY_STATUS.UPLOADING?(e.openBlock(),e.createElementBlock("b",zs,e.toDisplayString(V.percent),1)):e.createCommentVNode("",!0)],2)]),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["vuefinder__upload-modal__file-remove",e.unref(u)?"disabled":""]),title:e.unref(o)("Delete"),disabled:e.unref(u),onClick:Y=>e.unref(g)(V)},[...$[7]||($[7]=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"vuefinder__upload-modal__file-remove-icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],10,Rs)]))),128)),e.unref(h).length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Ts,e.toDisplayString(e.unref(o)("No files selected!")),1))]),e.unref(d).length?(e.openBlock(),e.createBlock(Rt,{key:0,onHidden:$[3]||($[3]=V=>d.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(d)),1)]),_:1})):e.createCommentVNode("",!0)])]),e.createElementVNode("input",{ref_key:"internalFileInput",ref:s,type:"file",multiple:"",class:"hidden"},null,512),e.createElementVNode("input",{ref_key:"internalFolderInput",ref:r,type:"file",multiple:"",webkitdirectory:"",class:"hidden"},null,512)]),_:1}))}}),Fs={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Hs(t,n){return e.openBlock(),e.createElementBlock("svg",Fs,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m6 4.125 2.25 2.25m0 0 2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125"},null,-1)])])}const an={render:Hs},Ps={class:"vuefinder__unarchive-modal__content"},Os={class:"vuefinder__unarchive-modal__items"},js={key:0,class:"vuefinder__unarchive-modal__icon vuefinder__unarchive-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},Ws={key:1,class:"vuefinder__unarchive-modal__icon vuefinder__unarchive-modal__icon--file",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},Us={class:"vuefinder__unarchive-modal__item-name"},qs={class:"vuefinder__unarchive-modal__info"},ln=e.defineComponent({__name:"ModalUnarchive",setup(t){const n=e.inject("ServiceContainer"),o=n.fs,i=R.useStore(o.path),{t:s}=n.i18n,r=e.ref(n.modal.data.items[0]),l=e.ref(""),c=e.ref([]),a=()=>{n.emitter.emit("vf-fetch",{params:{q:"unarchive",m:"post",storage:i.value.storage,path:i.value.path},body:{item:r.value.path},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:s("The file unarchived.")})},onError:h=>{l.value=s(h.message)}})};return(h,d)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:a,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(s)("Unarchive")),1),e.createElementVNode("button",{type:"button",onClick:d[1]||(d[1]=u=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(s)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(an),title:e.unref(s)("Unarchive")},null,8,["icon","title"]),e.createElementVNode("div",Ps,[e.createElementVNode("div",Os,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,u=>(e.openBlock(),e.createElementBlock("p",{class:"vuefinder__unarchive-modal__item",key:u.path},[u.type==="dir"?(e.openBlock(),e.createElementBlock("svg",js,[...d[2]||(d[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",Ws,[...d[3]||(d[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",Us,e.toDisplayString(u.basename),1)]))),128)),e.createElementVNode("p",qs,e.toDisplayString(e.unref(s)("The archive will be unarchived at"))+" ("+e.toDisplayString(e.unref(o).path.path)+")",1),l.value.length?(e.openBlock(),e.createBlock(e.unref(l),{key:0,onHidden:d[0]||(d[0]=u=>l.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),Ys={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Ks(t,n){return e.openBlock(),e.createElementBlock("svg",Ys,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125"},null,-1)])])}const cn={render:Ks},Gs={class:"vuefinder__archive-modal__content"},Xs={class:"vuefinder__archive-modal__form"},Qs={class:"vuefinder__archive-modal__files vf-scrollbar"},Zs={class:"vuefinder__archive-modal__file"},Js={key:0,class:"vuefinder__archive-modal__icon vuefinder__archive-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},ea={key:1,class:"vuefinder__archive-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},ta={class:"vuefinder__archive-modal__file-name"},na=["placeholder"],un=e.defineComponent({__name:"ModalArchive",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=R.useStore(i.path),r=e.ref(""),l=e.ref(""),c=e.ref(n.modal.data.items),a=()=>{c.value.length&&n.emitter.emit("vf-fetch",{params:{q:"archive",m:"post",storage:s.value.storage,path:s.value.path},body:{items:c.value.map(({path:h,type:d})=>({path:h,type:d})),name:r.value},onSuccess:()=>{n.emitter.emit("vf-toast-push",{label:o("The file(s) archived.")})},onError:h=>{l.value=o(h.message)}})};return(h,d)=>(e.openBlock(),e.createBlock(me,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:a,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Archive")),1),e.createElementVNode("button",{type:"button",onClick:d[2]||(d[2]=u=>e.unref(n).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(ge,{icon:e.unref(cn),title:e.unref(o)("Archive the files")},null,8,["icon","title"]),e.createElementVNode("div",Gs,[e.createElementVNode("div",Xs,[e.createElementVNode("div",Qs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,u=>(e.openBlock(),e.createElementBlock("p",Zs,[u.type==="dir"?(e.openBlock(),e.createElementBlock("svg",Js,[...d[3]||(d[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",ea,[...d[4]||(d[4]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",ta,e.toDisplayString(u.basename),1)]))),256))]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":d[0]||(d[0]=u=>r.value=u),onKeyup:e.withKeys(a,["enter"]),class:"vuefinder__archive-modal__input",placeholder:e.unref(o)("Archive name. (.zip file will be created)"),type:"text"},null,40,na),[[e.vModelText,r.value]]),l.value.length?(e.openBlock(),e.createBlock(e.unref(l),{key:0,onHidden:d[1]||(d[1]=u=>l.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(l.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),oa={xmlns:"http://www.w3.org/2000/svg",fill:"none",class:"animate-spin p-0.5 h-5 w-5 text-white ml-auto",viewBox:"0 0 24 24"};function ia(t,n){return e.openBlock(),e.createElementBlock("svg",oa,[...n[0]||(n[0]=[e.createElementVNode("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25 stroke-blue-900 dark:stroke-blue-100"},null,-1),e.createElementVNode("path",{fill:"currentColor",d:"M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12zm2 5.291A7.96 7.96 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938z",class:"opacity-75"},null,-1)])])}const vt={render:ia},ra={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function sa(t,n){return e.openBlock(),e.createElementBlock("svg",ra,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])])}const aa={render:sa},la={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function ca(t,n){return e.openBlock(),e.createElementBlock("svg",la,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"},null,-1)])])}const ua={render:ca},da={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function ha(t,n){return e.openBlock(),e.createElementBlock("svg",da,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25zm0 9.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18zM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25zm0 9.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18z"},null,-1)])])}const ma={render:ha},fa={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function pa(t,n){return e.openBlock(),e.createElementBlock("svg",fa,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75"},null,-1)])])}const va={render:pa},ga={class:"vuefinder__toolbar"},_a={key:0,class:"vuefinder__toolbar__actions"},wa=["title"],ba=["title"],ka=["title"],ya=["title"],Ea=["title"],Sa=["title"],xa=["title"],Ca={key:1,class:"vuefinder__toolbar__search-results"},Ba={class:"pl-2"},Va={class:"dark:bg-gray-700 bg-gray-200 text-xs px-2 py-1 rounded"},Na={class:"vuefinder__toolbar__controls"},Ma=["title"],$a=["title"],Aa=e.defineComponent({__name:"Toolbar",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=n.config,r=n.search,l=R.useStore(s.state),c=R.useStore(r.state),a=R.useStore(i.selectedItems);e.watch(()=>l.value.fullScreen,()=>{if(l.value.fullScreen){const d=document.querySelector("body");d&&(d.style.overflow="hidden")}else{const d=document.querySelector("body");d&&(d.style.overflow="")}n.emitter.emit("vf-fullscreen-toggle")});const h=()=>{s.set("view",l.value.view==="list"?"grid":"list")};return(d,u)=>(e.openBlock(),e.createElementBlock("div",ga,[e.unref(c).query.length?(e.openBlock(),e.createElementBlock("div",Ca,[e.createElementVNode("div",Ba,[e.createTextVNode(e.toDisplayString(e.unref(o)("Search results for"))+" ",1),e.createElementVNode("span",Va,e.toDisplayString(e.unref(c).query),1)]),e.unref(s).get("loadingIndicator")==="circular"&&e.unref(i).isLoading()?(e.openBlock(),e.createBlock(e.unref(vt),{key:0})):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("div",_a,[e.unref(n).features.includes(e.unref(W).NEW_FOLDER)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mx-1.5",title:e.unref(o)("New Folder"),onClick:u[0]||(u[0]=m=>e.unref(n).modal.open(on,{items:e.unref(a)}))},[e.createVNode(e.unref(nn))],8,wa)):e.createCommentVNode("",!0),e.unref(n).features.includes(e.unref(W).NEW_FILE)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"mx-1.5",title:e.unref(o)("New File"),onClick:u[1]||(u[1]=m=>e.unref(n).modal.open(bs,{items:e.unref(a)}))},[e.createVNode(e.unref(rn))],8,ba)):e.createCommentVNode("",!0),e.unref(n).features.includes(e.unref(W).RENAME)?(e.openBlock(),e.createElementBlock("div",{key:2,class:"mx-1.5",title:e.unref(o)("Rename"),onClick:u[2]||(u[2]=m=>e.unref(a).length!==1||e.unref(n).modal.open(dt,{items:e.unref(a)}))},[e.createVNode(e.unref(zt),{class:e.normalizeClass(e.unref(a).length===1?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,ka)):e.createCommentVNode("",!0),e.unref(n).features.includes(e.unref(W).DELETE)?(e.openBlock(),e.createElementBlock("div",{key:3,class:"mx-1.5",title:e.unref(o)("Delete"),onClick:u[3]||(u[3]=m=>!e.unref(a).length||e.unref(n).modal.open(ut,{items:e.unref(a)}))},[e.createVNode(e.unref(Dt),{class:e.normalizeClass(e.unref(a).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,ya)):e.createCommentVNode("",!0),e.unref(n).features.includes(e.unref(W).UPLOAD)?(e.openBlock(),e.createElementBlock("div",{key:4,class:"mx-1.5",title:e.unref(o)("Upload"),onClick:u[4]||(u[4]=m=>e.unref(n).modal.open(Ls,{items:e.unref(a)}))},[e.createVNode(e.unref(sn))],8,Ea)):e.createCommentVNode("",!0),e.unref(n).features.includes(e.unref(W).UNARCHIVE)&&e.unref(a).length===1&&e.unref(a)[0].mime_type==="application/zip"?(e.openBlock(),e.createElementBlock("div",{key:5,class:"mx-1.5",title:e.unref(o)("Unarchive"),onClick:u[5]||(u[5]=m=>!e.unref(a).length||e.unref(n).modal.open(ln,{items:e.unref(a)}))},[e.createVNode(e.unref(an),{class:e.normalizeClass(e.unref(a).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Sa)):e.createCommentVNode("",!0),e.unref(n).features.includes(e.unref(W).ARCHIVE)?(e.openBlock(),e.createElementBlock("div",{key:6,class:"mx-1.5",title:e.unref(o)("Archive"),onClick:u[6]||(u[6]=m=>!e.unref(a).length||e.unref(n).modal.open(un,{items:e.unref(a)}))},[e.createVNode(e.unref(cn),{class:e.normalizeClass(e.unref(a).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,xa)):e.createCommentVNode("",!0)])),e.createElementVNode("div",Na,[e.unref(n).features.includes(e.unref(W).FULL_SCREEN)?(e.openBlock(),e.createElementBlock("div",{key:0,onClick:u[7]||(u[7]=m=>e.unref(s).toggle("fullScreen")),class:"mx-1.5",title:e.unref(o)("Toggle Full Screen")},[e.unref(l).fullScreen?(e.openBlock(),e.createBlock(e.unref(ua),{key:0})):(e.openBlock(),e.createBlock(e.unref(aa),{key:1}))],8,Ma)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"mx-1.5",title:e.unref(o)("Change View"),onClick:u[8]||(u[8]=m=>e.unref(c).query.length||h())},[e.unref(l).view==="grid"?(e.openBlock(),e.createBlock(e.unref(ma),{key:0,class:e.normalizeClass(["vf-toolbar-icon",e.unref(c).query.length?"vf-toolbar-icon-disabled":""])},null,8,["class"])):e.createCommentVNode("",!0),e.unref(l).view==="list"?(e.openBlock(),e.createBlock(e.unref(va),{key:1,class:e.normalizeClass(["vf-toolbar-icon",e.unref(c).query.length?"vf-toolbar-icon-disabled":""])},null,8,["class"])):e.createCommentVNode("",!0)],8,$a)])]))}}),Da=(t,n=0,o=!1)=>{let i;return(...s)=>{o&&!i&&t(...s),clearTimeout(i),i=setTimeout(()=>{t(...s)},n)}},Vt=(t,n,o)=>{const i=e.ref(t);return e.customRef((s,r)=>({get(){return s(),i.value},set:Da(l=>{i.value=l,r()},n,!1)}))},za={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-300 dark:text-neutral-200 dark:hover:bg-gray-700 cursor-pointer",viewBox:"-40 -40 580 580"};function Ra(t,n){return e.openBlock(),e.createElementBlock("svg",za,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M463.5 224h8.5c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2S461.9 48.1 455 55l-41.6 41.6c-87.6-86.5-228.7-86.2-315.8 1-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2S334.3 224 344 224z"},null,-1)])])}const Ta={render:Ra},Ia={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-0.5 rounded",viewBox:"0 0 20 20"};function La(t,n){return e.openBlock(),e.createElementBlock("svg",Ia,[...n[0]||(n[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M5.293 9.707a1 1 0 0 1 0-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L11 7.414V15a1 1 0 1 1-2 0V7.414L6.707 9.707a1 1 0 0 1-1.414 0",class:"pointer-events-none","clip-rule":"evenodd"},null,-1)])])}const Fa={render:La},Ha={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-300 dark:text-neutral-200 dark:hover:bg-gray-700 cursor-pointer",viewBox:"0 0 24 24"};function Pa(t,n){return e.openBlock(),e.createElementBlock("svg",Ha,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Oa={render:Pa},ja={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-100 dark:text-neutral-300 dark:hover:bg-gray-800 cursor-pointer",viewBox:"0 0 20 20"};function Wa(t,n){return e.openBlock(),e.createElementBlock("svg",ja,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M10.707 2.293a1 1 0 0 0-1.414 0l-7 7a1 1 0 0 0 1.414 1.414L4 10.414V17a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-6.586l.293.293a1 1 0 0 0 1.414-1.414z",class:"pointer-events-none"},null,-1)])])}const Ua={render:Wa},qa={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 m-auto stroke-gray-400 fill-gray-100 dark:stroke-gray-400 dark:fill-gray-400/20",viewBox:"0 0 20 20"};function Ya(t,n){return e.openBlock(),e.createElementBlock("svg",qa,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607"},null,-1)])])}const Ka={render:Ya},Ga={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"w-6 h-6 cursor-pointer",viewBox:"0 0 24 24"};function Xa(t,n){return e.openBlock(),e.createElementBlock("svg",Ga,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Qa={render:Xa},Za={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"text-neutral-500 fill-sky-500 stroke-sky-500 dark:fill-slate-500 dark:stroke-slate-500",viewBox:"0 0 24 24"};function Ja(t,n){return e.openBlock(),e.createElementBlock("svg",Za,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-6l-2-2H5a2 2 0 0 0-2 2"},null,-1)])])}const We={render:Ja},el={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-6 w-6 p-1 rounded text-slate-700 dark:text-neutral-300 cursor-pointer",viewBox:"0 0 24 24"};function tl(t,n){return e.openBlock(),e.createElementBlock("svg",el,[...n[0]||(n[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M9 6h11M12 12h8M15 18h5M5 6v.01M8 12v.01M11 18v.01"},null,-1)])])}const nl={render:tl},ol={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 rounded text-slate-700 hover:bg-neutral-100 dark:fill-neutral-300 dark:hover:bg-gray-800 cursor-pointer",viewBox:"0 0 448 512"};function il(t,n){return e.openBlock(),e.createElementBlock("svg",ol,[...n[0]||(n[0]=[e.createElementVNode("path",{d:"M8 256a56 56 0 1 1 112 0 56 56 0 1 1-112 0m160 0a56 56 0 1 1 112 0 56 56 0 1 1-112 0m216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112"},null,-1)])])}const rl={render:il};function sl(t){const[n,o]=al(t);if(!o||o==="/")return n+"://";const i=o.replace(/\/+$/,""),s=i.lastIndexOf("/");return s===0?n+"://":n+":/"+i.slice(0,s)}function al(t){const n=t.indexOf(":/");return n===-1?[void 0,t]:[t.slice(0,n),t.slice(n+2)||"/"]}function De(t,n=[]){const o="vfDragEnterCounter",i=t.fs,s=R.useStore(i.selectedItems);function r(d,u){d.preventDefault(),i.getDraggedItem()===u.path||!u||u.type!=="dir"||s.value.some(f=>f.path===u.path||sl(f.path)===u.path)?d.dataTransfer&&(d.dataTransfer.dropEffect="none",d.dataTransfer.effectAllowed="none"):(d.dataTransfer&&(d.dataTransfer.dropEffect="copy",d.dataTransfer.effectAllowed="all"),d.currentTarget.classList.add(...n))}function l(d){d.preventDefault();const u=d.currentTarget,m=Number(u.dataset[o]||0);u.dataset[o]=String(m+1)}function c(d){d.preventDefault();const u=d.currentTarget,f=Number(u.dataset[o]||0)-1;f<=0?(delete u.dataset[o],u.classList.remove(...n)):u.dataset[o]=String(f)}function a(d,u){if(!u)return;d.preventDefault();const m=d.currentTarget;delete m.dataset[o],m.classList.remove(...n);const f=d.dataTransfer?.getData("items")||"[]",p=JSON.parse(f).map(_=>i.sortedFiles.get().find(g=>g.path===_));i.clearDraggedItem(),t.modal.open(tn,{items:{from:p,to:u}})}function h(d){return{dragover:u=>r(u,d),dragenter:l,dragleave:c,drop:u=>a(u,d)}}return{events:h}}const ll={class:"vuefinder__breadcrumb__container"},cl=["title"],ul=["title"],dl=["title"],hl=["title"],ml={class:"vuefinder__breadcrumb__list"},fl={key:0,class:"vuefinder__breadcrumb__hidden-list"},pl={class:"relative"},vl=["title","onClick"],gl={class:"vuefinder__breadcrumb__search-mode"},_l=["placeholder"],wl=["onClick"],bl={class:"vuefinder__breadcrumb__hidden-item-content"},kl={class:"vuefinder__breadcrumb__hidden-item-text"},yl=e.defineComponent({__name:"Breadcrumb",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.search,s=n.fs,r=n.config,l=R.useStore(r.state),c=R.useStore(i.state),a=R.useStore(s.path),h=R.useStore(s.loading),d=e.computed(()=>c.value?.searchMode??!1),u=e.ref(null),m=Vt(0,100),f=e.ref(5),v=e.ref(!1),p=e.computed(()=>a.value?.breadcrumb??[]);function _(M,A){return M.length>A?[M.slice(-A),M.slice(0,-A)]:[M,[]]}const g=e.computed(()=>_(p.value,f.value)[0]),k=e.computed(()=>_(p.value,f.value)[1]);e.watch(m,()=>{if(!u.value)return;const M=u.value.children;let A=0,w=0;const E=5,U=1;f.value=E,e.nextTick(()=>{for(let Q=M.length-1;Q>=0;Q--){const _e=M[Q];if(A+_e.offsetWidth>m.value-40)break;A+=parseInt(_e.offsetWidth.toString(),10),w++}w<U&&(w=U),w>E&&(w=E),f.value=w})});const S=()=>{u.value&&(m.value=u.value.offsetWidth)},N=e.ref(null);e.onMounted(()=>{N.value=new ResizeObserver(S),u.value&&N.value.observe(u.value)}),e.onUnmounted(()=>{N.value&&N.value.disconnect()});const O=De(n,["bg-blue-200","dark:bg-slate-600"]);function q(M=null){M??=p.value.length-2;const A={basename:a.value?.storage??"local",extension:"",path:(a.value?.storage??"local")+"://",storage:a.value?.storage??"local",type:"dir",file_size:null,last_modified:null,mime_type:null,visibility:""};return p.value[M]??A}const $=()=>{L(),n.emitter.emit("vf-fetch",{params:{q:"index",storage:a.value?.storage,path:a.value?.path}})},V=()=>{i.exitSearchMode(),g.value.length>0&&!d.value&&n.emitter.emit("vf-fetch",{params:{q:"index",storage:a.value?.storage??"local",path:p.value[p.value.length-2]?.path??(a.value?.storage??"local")+"://"}})},Y=M=>{n.emitter.emit("vf-fetch",{params:{q:"index",storage:a.value?.storage,path:M.path}}),v.value=!1},T=()=>{v.value&&(v.value=!1)},G={mounted(M,A){M.clickOutsideEvent=function(w){M===w.target||M.contains(w.target)||A.value()},document.body.addEventListener("click",M.clickOutsideEvent)},beforeUnmount(M){document.body.removeEventListener("click",M.clickOutsideEvent)}},C=()=>{r.toggle("showTreeView")},b=e.ref(null),y=Vt("",400);e.watch(y,M=>{n.emitter.emit("vf-toast-clear"),i.setQuery(M)}),e.watch(d,M=>{M&&e.nextTick(()=>{b.value&&b.value.focus()})}),n.emitter.on("vf-search-exit",()=>{i.exitSearchMode()});const I=()=>{y.value===""&&i.exitSearchMode()},L=()=>{y.value="",i.exitSearchMode()},F=e.ref({x:0,y:0}),j=M=>{if(M.currentTarget instanceof HTMLElement){const{x:A,y:w,height:E}=M.currentTarget.getBoundingClientRect();F.value={x:A,y:w+E}}v.value=!v.value};return(M,A)=>(e.openBlock(),e.createElementBlock("div",ll,[e.createElementVNode("span",{title:e.unref(o)("Toggle Tree View")},[e.createVNode(e.unref(nl),{onClick:C,class:e.normalizeClass(["vuefinder__breadcrumb__toggle-tree",e.unref(l).showTreeView?"vuefinder__breadcrumb__toggle-tree--active":""])},null,8,["class"])],8,cl),e.createElementVNode("span",{title:e.unref(o)("Go up a directory")},[e.createVNode(e.unref(Fa),e.mergeProps(e.toHandlers(p.value.length&&!d.value?e.unref(O).events(q()):{}),{onClick:V,class:p.value.length&&!d.value?"vuefinder__breadcrumb__go-up--active":"vuefinder__breadcrumb__go-up--inactive"}),null,16,["class"])],8,ul),e.unref(s).isLoading()?(e.openBlock(),e.createElementBlock("span",{key:1,title:e.unref(o)("Cancel")},[e.createVNode(e.unref(Oa),{onClick:A[0]||(A[0]=w=>e.unref(n).emitter.emit("vf-fetch-abort"))})],8,hl)):(e.openBlock(),e.createElementBlock("span",{key:0,title:e.unref(o)("Refresh")},[e.createVNode(e.unref(Ta),{onClick:$})],8,dl)),e.withDirectives(e.createElementVNode("div",{class:"group vuefinder__breadcrumb__search-container",onClick:A[3]||(A[3]=(...w)=>e.unref(i).enterSearchMode&&e.unref(i).enterSearchMode(...w))},[e.createElementVNode("div",null,[e.createVNode(e.unref(Ua),e.mergeProps(e.toHandlers(e.unref(O).events(q(-1))),{onClick:A[1]||(A[1]=e.withModifiers(w=>e.unref(n).emitter.emit("vf-fetch",{params:{q:"index",storage:e.unref(a).value?.storage??"local"}}),["stop"]))}),null,16)]),e.createElementVNode("div",ml,[k.value.length?e.withDirectives((e.openBlock(),e.createElementBlock("div",fl,[A[5]||(A[5]=e.createElementVNode("div",{class:"vuefinder__breadcrumb__separator"},"/",-1)),e.createElementVNode("div",pl,[e.createElementVNode("span",{onDragenter:A[2]||(A[2]=w=>v.value=!0),onClick:j,class:"vuefinder__breadcrumb__hidden-toggle"},[e.createVNode(e.unref(rl),{class:"vuefinder__breadcrumb__hidden-toggle-icon"})],32)])])),[[G,T]]):e.createCommentVNode("",!0)]),e.createElementVNode("div",{ref_key:"breadcrumbContainer",ref:u,class:"vuefinder__breadcrumb__visible-list pointer-events-none"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,(w,E)=>(e.openBlock(),e.createElementBlock("div",{key:E},[A[6]||(A[6]=e.createElementVNode("span",{class:"vuefinder__breadcrumb__separator"},"/",-1)),e.createElementVNode("span",e.mergeProps(e.toHandlers(e.unref(O).events(w),!0),{class:"vuefinder__breadcrumb__item pointer-events-auto",title:w.basename,onClick:e.withModifiers(U=>e.unref(n).emitter.emit("vf-fetch",{params:{q:"index",storage:e.unref(a)?.storage,path:w.path}}),["stop"])}),e.toDisplayString(w.name),17,vl)]))),128))],512),e.unref(r).get("loadingIndicator")==="circular"&&e.unref(h)?(e.openBlock(),e.createBlock(e.unref(vt),{key:0})):e.createCommentVNode("",!0)],512),[[e.vShow,!d.value]]),e.withDirectives(e.createElementVNode("div",gl,[e.createElementVNode("div",null,[e.createVNode(e.unref(Ka))]),e.withDirectives(e.createElementVNode("input",{ref_key:"searchInput",ref:b,onKeydown:e.withKeys(L,["esc"]),onBlur:I,"onUpdate:modelValue":A[4]||(A[4]=w=>e.isRef(y)?y.value=w:null),placeholder:e.unref(o)("Search anything.."),class:"vuefinder__breadcrumb__search-input",type:"text"},null,40,_l),[[e.vModelText,e.unref(y)]]),e.createVNode(e.unref(Qa),{onClick:L})],512),[[e.vShow,d.value]]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.withDirectives(e.createElementVNode("div",{style:e.normalizeStyle({position:"absolute",top:F.value.y+"px",left:F.value.x+"px"}),class:"vuefinder vuefinder__breadcrumb__hidden-dropdown"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.value,(w,E)=>(e.openBlock(),e.createElementBlock("div",e.mergeProps({key:E},e.toHandlers(e.unref(O).events(w),!0),{onClick:U=>Y(w),class:"vuefinder__breadcrumb__hidden-item"}),[e.createElementVNode("div",bl,[e.createElementVNode("span",null,[e.createVNode(e.unref(We),{class:"vuefinder__breadcrumb__hidden-item-icon"})]),A[7]||(A[7]=e.createTextVNode()),e.createElementVNode("span",kl,e.toDisplayString(w.name),1)])],16,wl))),128))],4),[[e.vShow,v.value]])]))]))}});function El(t,n){const{scrollContainer:o,itemWidth:i=100,rowHeight:s,overscan:r=2,containerPadding:l=48}=n,c=t&&typeof t.get=="function"?R.useStore(t):t,a=()=>typeof s=="number"?s:s.value,h=e.ref(0),d=e.ref(6),u=e.ref(600);let m=null;const f=e.computed(()=>Math.ceil(c.value.length/d.value)),v=e.computed(()=>f.value*a()),p=e.computed(()=>{const $=a(),V=Math.max(0,Math.floor(h.value/$)-r),Y=Math.min(f.value,Math.ceil((h.value+u.value)/$)+r);return{start:V,end:Y}}),_=e.computed(()=>{const{start:$,end:V}=p.value;return Array.from({length:V-$},(Y,T)=>$+T)}),g=()=>u.value,k=()=>{if(o.value){const $=o.value.clientWidth-l;d.value=Math.max(Math.floor($/i),2)}},S=$=>{const V=$.target;h.value=V.scrollTop};e.watch(()=>c.value.length,()=>{k()});const N=($,V)=>{const Y=V*d.value;return $.slice(Y,Y+d.value)},O=($,V,Y,T,G)=>{const C=[];for(let b=V;b<=Y;b++)for(let y=T;y<=G;y++){const I=b*d.value+y;I<$.length&&$[I]&&C.push($[I])}return C},q=$=>({row:Math.floor($/d.value),col:$%d.value});return e.onMounted(async()=>{await e.nextTick(),o.value&&(u.value=o.value.clientHeight||600),k(),window.addEventListener("resize",()=>{o.value&&(u.value=o.value.clientHeight||600),k()}),o.value&&"ResizeObserver"in window&&(m=new ResizeObserver($=>{const V=$[0];V&&(u.value=Math.round(V.contentRect.height)),k()}),m.observe(o.value))}),e.onUnmounted(()=>{window.removeEventListener("resize",k),m&&(m.disconnect(),m=null)}),{scrollTop:h,itemsPerRow:d,totalRows:f,totalHeight:v,visibleRange:p,visibleRows:_,updateItemsPerRow:k,handleScroll:S,getRowItems:N,getItemsInRange:O,getItemPosition:q,getContainerHeight:g}}function Sl(t){const{getItemPosition:n,getItemsInRange:o,getKey:i,selectionObject:s,rowHeight:r,itemWidth:l}=t,c=Math.floor(Math.random()*2**32).toString(),h=e.inject("ServiceContainer").fs,d=R.useStore(h.selectedKeys),u=R.useStore(h.sortedFiles);R.useStore(h.selectedCount);const m=e.ref(new Set),f=e.ref(!1),v=e.ref(!1),p=e.ref(null),_=b=>b.map(y=>y.getAttribute("data-key")).filter(y=>!!y),g=b=>{b.selection.getSelection().forEach(y=>{b.selection.deselect(y,!0)})},k=b=>{d.value&&d.value.forEach(y=>{const I=document.querySelector(`[data-key="${y}"]`);I&&b.selection.select(I,!0)})},S=b=>{if(b.size===0)return null;const I=Array.from(b).map(A=>{const w=u.value?.findIndex(E=>i(E)===A)??-1;return n(w>=0?w:0)}),L=Math.min(...I.map(A=>A.row)),F=Math.max(...I.map(A=>A.row)),j=Math.min(...I.map(A=>A.col)),M=Math.max(...I.map(A=>A.col));return{minRow:L,maxRow:F,minCol:j,maxCol:M}},N=b=>{f.value=!1,!b.event?.metaKey&&!b.event?.ctrlKey&&(v.value=!0),b.selection.resolveSelectables(),g(b),k(b)},O=({event:b,selection:y})=>{const I=b;I&&"type"in I&&I.type==="touchend"&&I.preventDefault();const L=b;if(!L?.ctrlKey&&!L?.metaKey&&(h.clearSelection(),y.clearSelection(!0,!0)),m.value.clear(),L&&s.value){const F=s.value.getSelectables()[0]?.closest(".scroller-"+c);if(F){const j=F.getBoundingClientRect(),M=L.clientY-j.top+F.scrollTop,A=L.clientX-j.left,w=Math.floor(M/r.value),E=Math.floor(A/l);p.value={row:w,col:E}}}},q=b=>{const y=b.selection,I=_(b.store.changed.added),L=_(b.store.changed.removed);v.value=!1,f.value=!0,I.forEach(F=>{d.value&&!d.value.has(F)&&m.value.add(F),h.select(F)}),L.forEach(F=>{document.querySelector(`[data-key="${F}"]`)&&u.value?.find(M=>i(M)===F)&&m.value.delete(F),h.deselect(F)}),y.resolveSelectables(),k(b)},$=()=>{m.value.clear()},V=b=>{if(b.event&&p.value&&m.value.size>0){const I=Array.from(m.value).map(L=>{const F=u.value?.findIndex(j=>i(j)===L)??-1;return F>=0?n(F):null}).filter(L=>L!==null);if(I.length>0){const L=[...I,p.value],F={minRow:Math.min(...L.map(j=>j.row)),maxRow:Math.max(...L.map(j=>j.row)),minCol:Math.min(...L.map(j=>j.col)),maxCol:Math.max(...L.map(j=>j.col))};o(u.value||[],F.minRow,F.maxRow,F.minCol,F.maxCol).forEach(j=>{const M=i(j);document.querySelector(`[data-key="${M}"]`)||h.select(M)})}}},Y=b=>{V(b),g(b),k(b),h.setSelectedCount(d.value?.size||0),f.value=!1,p.value=null},T=()=>{s.value=new xn({selectables:[".file-item-"+c],boundaries:[".scroller-"+c],selectionContainerClass:"selection-area-container",behaviour:{overlap:"invert",intersect:"touch",startThreshold:0,triggers:[0],scrolling:{speedDivider:10,manualSpeed:750,startScrollMargins:{x:0,y:10}}},features:{touch:!0,range:!0,deselectOnBlur:!0,singleTap:{allow:!1,intersect:"native"}}}),s.value.on("beforestart",N),s.value.on("start",O),s.value.on("move",q),s.value.on("stop",Y)},G=()=>{s.value&&(s.value.destroy(),s.value=null)},C=b=>{v.value&&(s.value?.clearSelection(),$(),v.value=!1);const y=b;!m.value.size&&!v.value&&!y?.ctrlKey&&!y?.metaKey&&(h.clearSelection(),s.value?.clearSelection())};return e.onMounted(()=>{const b=y=>{!y.buttons&&f.value&&(f.value=!1)};document.addEventListener("dragleave",b),e.onUnmounted(()=>{document.removeEventListener("dragleave",b)})}),{isDragging:f,selectionStarted:v,explorerId:c,extractIds:_,cleanupSelection:g,refreshSelection:k,getSelectionRange:S,selectSelectionRange:V,initializeSelectionArea:T,destroySelectionArea:G,handleContentClick:C}}const xl={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 20 20"};function Cl(t,n){return e.openBlock(),e.createElementBlock("svg",xl,[...n[0]||(n[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 0 1 1.414 0L10 10.586l3.293-3.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 0-1.414","clip-rule":"evenodd"},null,-1)])])}const Bl={render:Cl},Vl={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 20 20"};function Nl(t,n){return e.openBlock(),e.createElementBlock("svg",Vl,[...n[0]||(n[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 0 1-1.414 0L10 9.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1 0 1.414","clip-rule":"evenodd"},null,-1)])])}const Ml={render:Nl},Fe=e.defineComponent({__name:"SortIcon",props:{direction:{}},setup(t){return(n,o)=>(e.openBlock(),e.createElementBlock("div",null,[t.direction==="asc"?(e.openBlock(),e.createBlock(e.unref(Bl),{key:0})):e.createCommentVNode("",!0),t.direction==="desc"?(e.openBlock(),e.createBlock(e.unref(Ml),{key:1})):e.createCommentVNode("",!0)]))}}),$l={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"absolute h-6 w-6 md:h-12 md:w-12 m-auto stroke-neutral-500 fill-white dark:fill-gray-700 dark:stroke-gray-600 z-10",viewBox:"0 0 24 24"};function Al(t,n){return e.openBlock(),e.createElementBlock("svg",$l,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 0 0 2-2V9.414a1 1 0 0 0-.293-.707l-5.414-5.414A1 1 0 0 0 12.586 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"},null,-1)])])}const Dl={render:Al},zl={class:"vuefinder__drag-item__container"},Rl={class:"vuefinder__drag-item__count"},Tl=e.defineComponent({__name:"DragItem",props:{count:{}},setup(t){const n=t;return(o,i)=>(e.openBlock(),e.createElementBlock("div",zl,[e.createVNode(e.unref(Dl)),e.createElementVNode("div",Rl,e.toDisplayString(n.count),1)]))}}),Il={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"text-neutral-500",viewBox:"0 0 24 24"};function Ll(t,n){return e.openBlock(),e.createElementBlock("svg",Il,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 0 0 2-2V9.414a1 1 0 0 0-.293-.707l-5.414-5.414A1 1 0 0 0 12.586 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"},null,-1)])])}const Fl={render:Ll},Hl={key:3,class:"vuefinder__item-icon__extension"},Nt=e.defineComponent({__name:"ItemIcon",props:{item:{},ext:{type:Boolean},small:{type:Boolean}},setup(t){const n=t,o=e.inject("ServiceContainer"),i=o.customIcon?.(o,n.item);return(s,r)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__item-icon",t.small?"vuefinder__item-icon--small":"vuefinder__item-icon--large"])},[e.unref(i)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).is),e.normalizeProps(e.mergeProps({key:0},e.unref(i).props||{})),null,16)):t.item.type==="dir"?(e.openBlock(),e.createBlock(e.unref(We),{key:1})):(e.openBlock(),e.createBlock(e.unref(Fl),{key:2})),!e.unref(i)&&t.ext&&t.item.type!=="dir"&&t.item.extension?(e.openBlock(),e.createElementBlock("div",Hl,e.toDisplayString(t.item.extension.substring(0,3)),1)):e.createCommentVNode("",!0)],2))}}),Pl={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-5 w-5",viewBox:"0 0 24 24"};function Ol(t,n){return e.openBlock(),e.createElementBlock("svg",Pl,[...n[0]||(n[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"m15 4.5-4 4L7 10l-1.5 1.5 7 7L14 17l1.5-4 4-4M9 15l-4.5 4.5M14.5 4 20 9.5"},null,-1)])])}const dn={render:Ol},jl=["data-key","data-row","data-col","draggable"],Wl={key:0},Ul={class:"vuefinder__explorer__item-grid-content"},ql=["data-src","alt"],Yl={class:"vuefinder__explorer__item-title"},Kl={key:1,class:"vuefinder__explorer__item-list-content"},Gl={class:"vuefinder__explorer__item-list-name"},Xl={class:"vuefinder__explorer__item-list-icon"},Ql={class:"vuefinder__explorer__item-name"},Zl={key:0,class:"vuefinder__explorer__item-path"},Jl={key:1,class:"vuefinder__explorer__item-size"},ec={key:0},tc={key:2,class:"vuefinder__explorer__item-date"},nc=e.defineComponent({__name:"FileItem",props:{item:{},view:{},compact:{type:Boolean},showThumbnails:{type:Boolean},isSelected:{type:Boolean},isDragging:{type:Boolean},rowIndex:{},colIndex:{},showPath:{type:Boolean},explorerId:{}},emits:["click","dblclick","contextmenu","dragstart","dragend"],setup(t,{emit:n}){const o=t,i=n,s=e.inject("ServiceContainer"),r=s.fs,l=s.config,c=e.computed(()=>["file-item-"+o.explorerId,o.view==="grid"?"vf-explorer-item-grid":"vf-explorer-item-list",o.isSelected?"vf-explorer-selected":""]),a=e.computed(()=>({opacity:o.isDragging||r.isCut(o.item.path)?.5:""}));let h=null;const d=e.ref(null);let u=!1;const m=()=>{h&&clearTimeout(h),f.value=!0},f=e.ref(!0),v=p=>{if(f.value=!1,h&&(p.preventDefault(),clearTimeout(h)),!u)u=!0,i("click",p),d.value=setTimeout(()=>u=!1,300);else return u=!1,i("dblclick",p),h&&clearTimeout(h),!1;if(p.currentTarget&&p.currentTarget instanceof HTMLElement){const _=p.currentTarget.getBoundingClientRect();p.preventDefault(),h=setTimeout(()=>{let S=_.y+_.height;S+146>window.innerHeight-10&&(S=_.y-146),S<10&&(S=10);const N=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2,buttons:0,clientX:_.x,clientY:S});p.target?.dispatchEvent(N)},300)}};return(p,_)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(c.value),style:e.normalizeStyle(a.value),"data-key":t.item.path,"data-row":t.rowIndex,"data-col":t.colIndex,draggable:f.value,onTouchstart:_[1]||(_[1]=g=>v(g)),onTouchend:_[2]||(_[2]=g=>m()),onClick:_[3]||(_[3]=g=>i("click",g)),onDblclick:_[4]||(_[4]=g=>i("dblclick",g)),onContextmenu:_[5]||(_[5]=e.withModifiers(g=>i("contextmenu",g),["prevent","stop"])),onDragstart:_[6]||(_[6]=g=>i("dragstart",g)),onDragend:_[7]||(_[7]=g=>i("dragend",g))},[t.view==="grid"?(e.openBlock(),e.createElementBlock("div",Wl,[e.createElementVNode("div",Ul,[(t.item.mime_type??"").startsWith("image")&&t.showThumbnails?(e.openBlock(),e.createElementBlock("img",{key:0,onTouchstart:_[0]||(_[0]=g=>g.preventDefault()),src:"data:image/png;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"vuefinder__explorer__item-thumbnail lazy","data-src":e.unref(s).requester.getPreviewUrl(t.item.storage,t.item),alt:t.item.basename},null,40,ql)):(e.openBlock(),e.createBlock(Nt,{key:1,item:t.item,ext:!0},null,8,["item"]))]),e.createElementVNode("span",Yl,e.toDisplayString(e.unref(lt)(t.item.basename)),1)])):(e.openBlock(),e.createElementBlock("div",Kl,[e.createElementVNode("div",Gl,[e.createElementVNode("div",Xl,[e.createVNode(Nt,{item:t.item,small:t.compact},null,8,["item","small"])]),e.createElementVNode("span",Ql,e.toDisplayString(t.item.basename),1)]),t.showPath?(e.openBlock(),e.createElementBlock("div",Zl,e.toDisplayString(t.item.path),1)):e.createCommentVNode("",!0),t.showPath?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Jl,[t.item.file_size?(e.openBlock(),e.createElementBlock("div",ec,e.toDisplayString(e.unref(s).filesize(t.item.file_size)),1)):e.createCommentVNode("",!0)])),!t.showPath&&t.item.last_modified?(e.openBlock(),e.createElementBlock("div",tc,e.toDisplayString(new Date(t.item.last_modified*1e3).toLocaleString()),1)):e.createCommentVNode("",!0)])),e.unref(l).get("pinnedFolders").find(g=>g.path===t.item.path)?(e.openBlock(),e.createBlock(e.unref(dn),{key:2,class:"vuefinder__item--pinned"})):e.createCommentVNode("",!0)],46,jl))}}),oc=["data-row"],et=e.defineComponent({__name:"FileRow",props:{rowIndex:{},rowHeight:{},view:{},itemsPerRow:{},items:{},compact:{type:Boolean},showThumbnails:{type:Boolean},showPath:{type:Boolean},isDraggingItem:{type:Function},isSelected:{type:Function},dragNDropEvents:{type:Function},explorerId:{}},emits:["click","dblclick","contextmenu","dragstart","dragend"],setup(t,{emit:n}){const o=t,i=n,s=e.computed(()=>[o.view==="grid"?"vf-explorer-item-grid-row":"vf-explorer-item-list-row","pointer-events-none"]),r=e.computed(()=>({position:"absolute",top:0,left:0,width:"100%",height:`${o.rowHeight}px`,transform:`translateY(${o.rowIndex*o.rowHeight}px)`})),l=e.computed(()=>o.view==="grid"?{gridTemplateColumns:`repeat(${o.itemsPerRow||1}, 1fr)`}:{gridTemplateColumns:"1fr"});return(c,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(s.value),"data-row":t.rowIndex,style:e.normalizeStyle(r.value)},[e.createElementVNode("div",{class:e.normalizeClass(["grid justify-self-start",{"w-full":t.view==="list"}]),style:e.normalizeStyle(l.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.items,(h,d)=>(e.openBlock(),e.createBlock(nc,e.mergeProps({key:h.path,item:h,view:t.view,compact:t.compact,"show-thumbnails":t.showThumbnails,"show-path":t.showPath,"is-selected":t.isSelected(h.path),"is-dragging":t.isDraggingItem(h.path),"row-index":t.rowIndex,"col-index":d},e.toHandlers(t.dragNDropEvents(h)),{onClick:a[0]||(a[0]=u=>i("click",u)),onDblclick:a[1]||(a[1]=u=>i("dblclick",u)),onContextmenu:a[2]||(a[2]=u=>i("contextmenu",u)),onDragstart:a[3]||(a[3]=u=>i("dragstart",u)),onDragend:a[4]||(a[4]=u=>i("dragend",u)),explorerId:t.explorerId}),null,16,["item","view","compact","show-thumbnails","show-path","is-selected","is-dragging","row-index","col-index","explorerId"]))),128))],6)],14,oc))}}),ic=["onClick"],rc=e.defineComponent({__name:"Toast",setup(t){const n=e.inject("ServiceContainer"),{getStore:o}=n.storage,i=e.ref(o("full-screen",!1)),s=e.ref([]),r=a=>a==="error"?"text-red-400 border-red-400 dark:text-red-300 dark:border-red-300":"text-lime-600 border-lime-600 dark:text-lime-300 dark:border-lime-1300",l=a=>{s.value.splice(a,1)},c=a=>{let h=s.value.findIndex(d=>d.id===a);h!==-1&&l(h)};return n.emitter.on("vf-toast-clear",()=>{s.value=[]}),n.emitter.on("vf-toast-push",a=>{let h=new Date().getTime().toString(36).concat(performance.now().toString(),Math.random().toString()).replace(/\./g,"");a.id=h,s.value.push(a),setTimeout(()=>{c(h)},5e3)}),(a,h)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__toast",i.value.value?"vuefinder__toast--fixed":"vuefinder__toast--absolute"])},[e.createVNode(e.TransitionGroup,{name:"vuefinder__toast-item","enter-active-class":"vuefinder__toast-item--enter-active","leave-active-class":"vuefinder__toast-item--leave-active","leave-to-class":"vuefinder__toast-item--leave-to"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(d,u)=>(e.openBlock(),e.createElementBlock("div",{key:u,onClick:m=>l(u),class:e.normalizeClass(["vuefinder__toast__message",r(d.type)])},e.toDisplayString(d.label),11,ic))),128))]),_:1})],2))}}),sc={class:"vuefinder__explorer__container"},ac={ref:"customScrollBar",class:"vuefinder__explorer__scrollbar"},lc={key:0,class:"vuefinder__explorer__header"},cc={key:0,class:"vuefinder__linear-loader"},uc={key:1,class:"vuefinder__circular-loader"},dc=e.defineComponent({__name:"Explorer",setup(t){const n=e.inject("ServiceContainer"),o=De(n,["bg-blue-200","dark:bg-slate-600"]),i=e.useTemplateRef("dragImage"),s=e.shallowRef(null),r=e.useTemplateRef("scrollContainer"),l=e.useTemplateRef("scrollContent"),c=n.search,a=n.fs,h=n.config,d=R.useStore(h.state),u=R.useStore(c.state),m=R.useStore(a.sortedFiles),f=R.useStore(a.selectedKeys),v=R.useStore(a.loading),p=x=>f.value?.has(x)??!1;let _=null;const g=e.ref(null),k=e.useTemplateRef("customScrollBar"),S=e.useTemplateRef("customScrollBarContainer"),N=e.computed(()=>{const x=d.value.view,D=d.value.compactListView;return x==="grid"&&!(u.value.searchMode&&u.value.query.length)?88:D?24:50}),{t:O}=n.i18n,{itemsPerRow:q,totalHeight:$,visibleRows:V,handleScroll:Y,getRowItems:T,getItemsInRange:G,getItemPosition:C,updateItemsPerRow:b}=El(e.computed(()=>m.value??[]),{scrollContainer:r,itemWidth:104,rowHeight:N,overscan:2,containerPadding:0}),{explorerId:y,isDragging:I,initializeSelectionArea:L,destroySelectionArea:F,handleContentClick:j}=Sl({getItemPosition:C,getItemsInRange:G,getKey:x=>x.path,selectionObject:s,rowHeight:N,itemWidth:104}),M=e.ref(null),A=x=>{if(!x||!M.value)return!1;const D=f.value?.has(M.value)??!1;return I.value&&(D?f.value?.has(x)??!1:x===M.value)};e.watch(()=>h.get("view"),x=>{x==="list"?q.value=1:b()},{immediate:!0}),e.watch(q,x=>{h.get("view")==="list"&&x!==1&&(q.value=1)});const w=x=>m.value?.[x];e.onMounted(()=>{if(L(),s.value&&s.value.on("beforestart",({event:x})=>{const D=x?.target===l.value;if(!x?.metaKey&&!x?.ctrlKey&&!x?.altKey&&!D)return!1}),r.value&&(_=new Cn({elements_selector:".lazy",container:r.value})),e.watch(()=>u.value.query,x=>{const D=a.path.get().storage,z=a.path.get().path;!D||!z||(x?n.emitter.emit("vf-fetch",{params:{q:"search",storage:D,path:z,filter:x},onSuccess:oe=>{oe.files.length||n.emitter.emit("vf-toast-push",{label:O("No search result found.")})}}):n.emitter.emit("vf-fetch",{params:{q:"index",storage:D,path:z}}))}),S.value){const x=ct.OverlayScrollbars(S.value,{scrollbars:{theme:"vf-scrollbars-theme"}},{initialized:D=>{g.value=D},scroll:D=>{const{scrollOffsetElement:z}=D.elements();r.value&&r.value.scrollTo({top:z.scrollTop,left:0})}});g.value=x}r.value&&r.value.addEventListener("scroll",()=>{const x=g.value;if(!x)return;const{scrollOffsetElement:D}=x.elements();D.scrollTo({top:r.value.scrollTop,left:0})})}),e.onUpdated(()=>{if(_&&_.update(),g.value&&k.value&&r.value){const D=r.value.scrollHeight>r.value.clientHeight,z=k.value;z.style.display=D?"block":"none",z.style.height=`${$.value}px`}}),e.onUnmounted(()=>{F(),_&&(_.destroy(),_=null),g.value&&(g.value.destroy(),g.value=null)});const E=x=>{const D=x.target?.closest(".file-item-"+y),z=x;if(!z?.ctrlKey&&!z?.metaKey&&(a.clearSelection(),s.value?.clearSelection(!0,!0)),D){const oe=String(D.getAttribute("data-key"));s.value?.resolveSelectables(),a.toggleSelect(oe)}a.setSelectedCount(f.value?.size||0)},U=x=>{const D=n.contextMenuItems.find(z=>z.show(n,{searchQuery:"",items:[x],target:x}));D&&D.action(n,[x])},Q=x=>{const D=x.target?.closest(".file-item-"+y),z=D?String(D.getAttribute("data-key")):null;if(!z)return;const oe=m.value?.find(Ue=>Ue.path===z);oe&&U(oe)},_e=()=>{const x=f.value;return m.value?.filter(D=>x?.has(D.path))||[]},ye=x=>{x.preventDefault();const D=x.target?.closest(".file-item-"+y);if(D){const z=String(D.getAttribute("data-key")),oe=m.value?.find(Ue=>Ue.path===z);f.value?.has(z)||(a.clearSelection(),a.select(z)),n.emitter.emit("vf-contextmenu-show",{event:x,items:_e(),target:oe})}},fe=x=>{x.preventDefault(),n.emitter.emit("vf-contextmenu-show",{event:x,items:_e()})},Ee=x=>{if(x.altKey||x.ctrlKey||x.metaKey)return x.preventDefault(),!1;I.value=!0;const D=x.target?.closest(".file-item-"+y);if(M.value=D?String(D.dataset.key):null,x.dataTransfer&&M.value){x.dataTransfer.setDragImage(i.value,0,15),x.dataTransfer.effectAllowed="all",x.dataTransfer.dropEffect="copy";const z=f.value?.has(M.value)?Array.from(f.value):[M.value];x.dataTransfer.setData("items",JSON.stringify(z)),a.setDraggedItem(M.value)}},we=()=>{M.value=null};return(x,D)=>(e.openBlock(),e.createElementBlock("div",sc,[e.createElementVNode("div",{ref:"customScrollBarContainer",class:e.normalizeClass(["vuefinder__explorer__scrollbar-container",[{"grid-view":e.unref(d).view==="grid"},{"search-active":e.unref(u).hasQuery}]])},[e.createElementVNode("div",ac,null,512)],2),e.unref(d).view==="list"||e.unref(u).query.length?(e.openBlock(),e.createElementBlock("div",lc,[e.createElementVNode("div",{onClick:D[0]||(D[0]=z=>e.unref(a).toggleSort("basename")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--name vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(O)("Name"))+" ",1),e.withDirectives(e.createVNode(Fe,{direction:e.unref(a).sort.order},null,8,["direction"]),[[e.vShow,e.unref(a).sort.active&&e.unref(a).sort.column==="basename"]])]),e.unref(u).query.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,onClick:D[1]||(D[1]=z=>e.unref(a).toggleSort("file_size")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--size vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(O)("Size"))+" ",1),e.withDirectives(e.createVNode(Fe,{direction:e.unref(a).sort.order},null,8,["direction"]),[[e.vShow,e.unref(a).sort.active&&e.unref(a).sort.column==="file_size"]])])),e.unref(u).query.length?(e.openBlock(),e.createElementBlock("div",{key:1,onClick:D[2]||(D[2]=z=>e.unref(a).toggleSort("path")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--path vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(O)("Filepath"))+" ",1),e.withDirectives(e.createVNode(Fe,{direction:e.unref(a).sort.order},null,8,["direction"]),[[e.vShow,e.unref(a).sort.active&&e.unref(a).sort.column==="path"]])])):e.createCommentVNode("",!0),e.unref(u).query.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:2,onClick:D[3]||(D[3]=z=>e.unref(a).toggleSort("last_modified")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--date vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(O)("Date"))+" ",1),e.withDirectives(e.createVNode(Fe,{direction:e.unref(a).sort.order},null,8,["direction"]),[[e.vShow,e.unref(a).sort.active&&e.unref(a).sort.column==="last_modified"]])]))])):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContainer",ref:r,class:e.normalizeClass(["vuefinder__explorer__selector-area","scroller-"+e.unref(y)]),onScroll:D[5]||(D[5]=(...z)=>e.unref(Y)&&e.unref(Y)(...z))},[e.unref(h).get("loadingIndicator")==="linear"&&e.unref(v)?(e.openBlock(),e.createElementBlock("div",cc)):e.createCommentVNode("",!0),e.unref(h).get("loadingIndicator")==="circular"&&e.unref(v)?(e.openBlock(),e.createElementBlock("div",uc)):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContent",ref:l,class:"scrollContent min-h-full",style:e.normalizeStyle({height:`${e.unref($)}px`,position:"relative",width:"100%"}),onContextmenu:e.withModifiers(fe,["self","prevent"]),onClick:D[4]||(D[4]=e.withModifiers((...z)=>e.unref(j)&&e.unref(j)(...z),["self"]))},[e.createElementVNode("div",{ref_key:"dragImage",ref:i,class:"vuefinder__explorer__drag-item"},[e.createVNode(Tl,{count:M.value&&e.unref(f)?.has(M.value)?e.unref(f)?.size:1},null,8,["count"])],512),e.unref(u).query.length?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(V),z=>(e.openBlock(),e.createBlock(et,{key:z,"row-index":z,"row-height":N.value,view:"list",items:w(z)?[w(z)]:[],compact:e.unref(d).compactListView,"show-path":!0,"is-dragging-item":A,"is-selected":p,"drag-n-drop-events":oe=>e.unref(o).events(oe),explorerId:e.unref(y),onClick:E,onDblclick:Q,onContextmenu:ye,onDragstart:Ee,onDragend:we},null,8,["row-index","row-height","items","compact","drag-n-drop-events","explorerId"]))),128)):e.unref(d).view==="grid"?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(V),z=>(e.openBlock(),e.createBlock(et,{key:z,"row-index":z,"row-height":N.value,view:"grid","items-per-row":e.unref(q),items:e.unref(T)(e.unref(m),z),"show-thumbnails":e.unref(d).showThumbnails,"is-dragging-item":A,"is-selected":p,"drag-n-drop-events":oe=>e.unref(o).events(oe),explorerId:e.unref(y),onClick:E,onDblclick:Q,onContextmenu:ye,onDragstart:Ee,onDragend:we},null,8,["row-index","row-height","items-per-row","items","show-thumbnails","drag-n-drop-events","explorerId"]))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(e.unref(V),z=>(e.openBlock(),e.createBlock(et,{key:z,"row-index":z,"row-height":N.value,view:"list",items:w(z)?[w(z)]:[],compact:e.unref(d).compactListView,"is-dragging-item":A,"is-selected":p,"drag-n-drop-events":oe=>e.unref(o).events(oe),explorerId:e.unref(y),onClick:E,onDblclick:Q,onContextmenu:ye,onDragstart:Ee,onDragend:we},null,8,["row-index","row-height","items","compact","drag-n-drop-events","explorerId"]))),128))],36)],34),e.createVNode(rc)]))}}),hc=["href","download"],mc=["onClick"],fc=e.defineComponent({__name:"ContextMenu",setup(t){const n=e.inject("ServiceContainer"),o=n.search,i=R.useStore(o.state),s=e.ref(null),r=e.ref([]),l=e.reactive({active:!1,items:[],positions:{left:"0px",top:"0px"}});n.emitter.on("vf-context-selected",d=>{r.value=d});const c=d=>d.link(n,r.value),a=d=>{n.emitter.emit("vf-contextmenu-hide"),d.action(n,r.value)};n.emitter.on("vf-contextmenu-show",({event:d,items:u,target:m=null})=>{if(l.items=n.contextMenuItems.filter(f=>f.show(n,{searchQuery:i.query,items:u,target:m})),i.query)if(m)n.emitter.emit("vf-context-selected",[m]);else return;else!m&&!i.query?n.emitter.emit("vf-context-selected",[]):u.length>1&&u.some(f=>f.path===m.path)?n.emitter.emit("vf-context-selected",u):n.emitter.emit("vf-context-selected",[m]);h(d)}),n.emitter.on("vf-contextmenu-hide",()=>{l.active=!1});const h=d=>{const u=n.root,m=n.root.getBoundingClientRect(),f=u.getBoundingClientRect();let v=d.clientX-m.left,p=d.clientY-m.top;l.active=!0,e.nextTick(()=>{const _=s.value?.getBoundingClientRect();let g=_?.height??0,k=_?.width??0;v=f.right-d.pageX+window.scrollX<k?v-k:v,p=f.bottom-d.pageY+window.scrollY<g?p-g:p,l.positions={left:String(v)+"px",top:String(p)+"px"}})};return(d,u)=>e.withDirectives((e.openBlock(),e.createElementBlock("ul",{ref_key:"contextmenu",ref:s,class:e.normalizeClass([l.active?"vuefinder__context-menu--active":"vuefinder__context-menu--inactive","vuefinder__context-menu"]),style:e.normalizeStyle(l.positions)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.items,m=>(e.openBlock(),e.createElementBlock("li",{class:"vuefinder__context-menu__item",key:m.title},[m.link?(e.openBlock(),e.createElementBlock("a",{key:0,class:"vuefinder__context-menu__link",target:"_blank",href:c(m),download:c(m),onClick:u[0]||(u[0]=f=>e.unref(n).emitter.emit("vf-contextmenu-hide"))},[e.createElementVNode("span",null,e.toDisplayString(m.title(e.unref(n).i18n)),1)],8,hc)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"vuefinder__context-menu__action",onClick:f=>a(m)},[e.createElementVNode("span",null,e.toDisplayString(m.title(e.unref(n).i18n)),1)],8,mc))]))),128))],6)),[[e.vShow,l.active]])}}),pc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"h-5 w-5",viewBox:"0 0 24 24"};function vc(t,n){return e.openBlock(),e.createElementBlock("svg",pc,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"},null,-1)])])}const hn={render:vc},gc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2",class:"h-5 w-5 stroke-slate-500 cursor-pointer",viewBox:"0 0 24 24"};function _c(t,n){return e.openBlock(),e.createElementBlock("svg",gc,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0"},null,-1)])])}const wc={render:_c},bc={class:"vuefinder__status-bar__wrapper"},kc={class:"vuefinder__status-bar__storage"},yc=["title"],Ec={class:"vuefinder__status-bar__storage-icon"},Sc=["value"],xc=["value"],Cc={class:"vuefinder__status-bar__info"},Bc={key:0},Vc={class:"vuefinder__status-bar__selected-count"},Nc={class:"vuefinder__status-bar__actions"},Mc=["disabled"],$c=["title"],Ac=e.defineComponent({__name:"Statusbar",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,i=n.fs,s=n.search,r=R.useStore(s.state),l=R.useStore(i.sortedFiles),c=R.useStore(i.path),a=R.useStore(i.selectedCount),h=R.useStore(i.storages),d=m=>{const f=m.target.value;n.emitter.emit("vf-search-exit"),n.emitter.emit("vf-fetch",{params:{q:"index",storage:f}})},u=e.computed(()=>{const m=n.selectButton.multiple?a.value>0:a.value===1;return n.selectButton.active&&m});return(m,f)=>(e.openBlock(),e.createElementBlock("div",bc,[e.createElementVNode("div",kc,[e.createElementVNode("div",{class:"vuefinder__status-bar__storage-container",title:e.unref(o)("Storage")},[e.createElementVNode("div",Ec,[e.createVNode(e.unref(hn))]),e.createElementVNode("select",{name:"vuefinder-media-selector",value:e.unref(c)?.storage,onChange:d,class:"vuefinder__status-bar__storage-select",tabindex:"-1"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(h),v=>(e.openBlock(),e.createElementBlock("option",{value:v,key:v},e.toDisplayString(v),9,xc))),128))],40,Sc)],8,yc),e.createElementVNode("div",Cc,[e.unref(r).hasQuery?(e.openBlock(),e.createElementBlock("span",Bc,e.toDisplayString(e.unref(l).value.length)+" items found. ",1)):e.createCommentVNode("",!0),e.createElementVNode("span",Vc,e.toDisplayString(e.unref(a)>0?`${e.unref(a)} item(s) selected.`:""),1)])]),e.createElementVNode("div",Nc,[e.unref(n).selectButton.active?(e.openBlock(),e.createElementBlock("button",{key:0,class:e.normalizeClass(["vf-btn vf-btn-primary vf-btn-small",{disabled:!u.value}]),disabled:!u.value,onClick:f[0]||(f[0]=v=>e.unref(n).selectButton.click(e.unref(i).selectedItems,v))},e.toDisplayString(e.unref(o)("Select")),11,Mc)):e.createCommentVNode("",!0),e.createElementVNode("span",{class:"vuefinder__status-bar__about",title:e.unref(o)("About"),onClick:f[1]||(f[1]=v=>e.unref(n).modal.open(At))},[e.createVNode(e.unref(wc))],8,$c)])]))}}),Dc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"text-neutral-500 fill-sky-500 stroke-gray-100/50 dark:stroke-slate-700/50 dark:fill-slate-500",viewBox:"0 0 24 24"};function zc(t,n){return e.openBlock(),e.createElementBlock("svg",Dc,[...n[0]||(n[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776q.168-.026.344-.026h15.812q.176 0 .344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"},null,-1)])])}const mn={render:zc},Rc={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 24 24"};function Tc(t,n){return e.openBlock(),e.createElementBlock("svg",Rc,[...n[0]||(n[0]=[e.createElementVNode("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2m3.6 5.2a1 1 0 0 0-1.4.2L12 10.333 9.8 7.4a1 1 0 1 0-1.6 1.2l2.55 3.4-2.55 3.4a1 1 0 1 0 1.6 1.2l2.2-2.933 2.2 2.933a1 1 0 0 0 1.6-1.2L13.25 12l2.55-3.4a1 1 0 0 0-.2-1.4"},null,-1)])])}const Ic={render:Tc},Lc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"};function Fc(t,n){return e.openBlock(),e.createElementBlock("svg",Lc,[...n[0]||(n[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M15 12H9M12 9v6"},null,-1)])])}const fn={render:Fc},Hc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"};function Pc(t,n){return e.openBlock(),e.createElementBlock("svg",Hc,[...n[0]||(n[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M9 12h6"},null,-1)])])}const pn={render:Pc};function vn(t,n){const o=t.findIndex(i=>i.path===n.path);o>-1?t[o]=n:t.push(n)}const Oc={class:"vuefinder__folder-loader-indicator"},jc={key:1,class:"vuefinder__folder-loader-indicator--icon"},gn=e.defineComponent({__name:"FolderLoaderIndicator",props:e.mergeModels({storage:{},path:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const n=t,o=e.inject("ServiceContainer"),{t:i}=o.i18n,s=e.useModel(t,"modelValue"),r=e.ref(!1);e.watch(()=>s.value,()=>l()?.folders.length||c());function l(){return o.treeViewData.find(a=>a.path===n.path)}const c=()=>{r.value=!0,o.requester.send({url:"",method:"get",params:{q:"subfolders",storage:n.storage,path:n.path}}).then(a=>{vn(o.treeViewData,{path:n.path,type:"dir",...a})}).catch(a=>{}).finally(()=>{r.value=!1})};return(a,h)=>(e.openBlock(),e.createElementBlock("div",Oc,[r.value?(e.openBlock(),e.createBlock(e.unref(vt),{key:0,class:"vuefinder__folder-loader-indicator--loading"})):(e.openBlock(),e.createElementBlock("div",jc,[s.value&&l()?.folders.length?(e.openBlock(),e.createBlock(e.unref(pn),{key:0,class:"vuefinder__folder-loader-indicator--minus"})):e.createCommentVNode("",!0),s.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(fn),{key:1,class:"vuefinder__folder-loader-indicator--plus"}))]))]))}}),Wc=["onClick"],Uc=["title","onDblclick","onClick"],qc={class:"vuefinder__treesubfolderlist__item-icon"},Yc={class:"vuefinder__treesubfolderlist__subfolder"},Kc=e.defineComponent({__name:"TreeSubfolderList",props:{storage:{},path:{}},setup(t){const n=e.inject("ServiceContainer"),o=n.fs,i=De(n,["bg-blue-200","dark:bg-slate-600"]),s=e.ref({}),r=R.useStore(o.path),l=t,c=e.ref(null);e.onMounted(()=>{l.path===l.storage+"://"&&c.value&&ct.OverlayScrollbars(c.value,{scrollbars:{theme:"vf-theme-dark dark:vf-theme-light"}})});const a=e.computed(()=>n.treeViewData.find(h=>h.path===l.path)?.folders||[]);return(h,d)=>{const u=e.resolveComponent("TreeSubfolderList",!0);return e.openBlock(),e.createElementBlock("ul",{ref_key:"parentSubfolderList",ref:c,class:"vuefinder__treesubfolderlist__container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,m=>(e.openBlock(),e.createElementBlock("li",{key:m.path,class:"vuefinder__treesubfolderlist__item"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(i).events({...m,type:"dir"}),!0),{class:"vuefinder__treesubfolderlist__item-content"}),[e.createElementVNode("div",{class:"vuefinder__treesubfolderlist__item-toggle",onClick:f=>s.value[m.path]=!s.value[m.path]},[e.createVNode(gn,{storage:t.storage,path:m.path,modelValue:s.value[m.path],"onUpdate:modelValue":f=>s.value[m.path]=f},null,8,["storage","path","modelValue","onUpdate:modelValue"])],8,Wc),e.createElementVNode("div",{class:"vuefinder__treesubfolderlist__item-link",title:m.path,onDblclick:f=>s.value[m.path]=!s.value[m.path],onClick:f=>e.unref(n).emitter.emit("vf-fetch",{params:{q:"index",storage:l.storage,path:m.path}})},[e.createElementVNode("div",qc,[e.unref(r)?.path===m.path?(e.openBlock(),e.createBlock(e.unref(mn),{key:0})):(e.openBlock(),e.createBlock(e.unref(We),{key:1}))]),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__treesubfolderlist__item-text",{"vuefinder__treesubfolderlist__item-text--active":e.unref(r)?.path===m.path}])},e.toDisplayString(m.basename),3)],40,Uc)],16),e.createElementVNode("div",Yc,[e.withDirectives(e.createVNode(u,{storage:l.storage,path:m.path},null,8,["storage","path"]),[[e.vShow,s.value[m.path]]])])]))),128))],512)}}}),Gc=e.defineComponent({__name:"TreeStorageItem",props:{storage:{}},setup(t){const n=e.inject("ServiceContainer"),o=n.fs,i=e.ref(!1),s=t,r=De(n,["bg-blue-200","dark:bg-slate-600"]),l=R.useStore(o.path),c=e.computed(()=>s.storage===l.value?.storage),a={storage:s.storage,path:s.storage+"://",type:"dir",basename:s.storage,extension:"",file_size:null,last_modified:null,mime_type:null,visibility:"public"};function h(d){d===l.value?.storage?i.value=!i.value:(n.emitter.emit("vf-search-exit"),n.emitter.emit("vf-fetch",{params:{q:"index",storage:d}}))}return(d,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{onClick:u[2]||(u[2]=m=>h(t.storage)),class:"vuefinder__treestorageitem__header"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(r).events(a),!0),{class:["vuefinder__treestorageitem__info",c.value?"vuefinder__treestorageitem__info--active":""]}),[e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__treestorageitem__icon",c.value?"vuefinder__treestorageitem__icon--active":""])},[e.createVNode(e.unref(hn))],2),e.createElementVNode("div",null,e.toDisplayString(t.storage),1)],16),e.createElementVNode("div",{class:"vuefinder__treestorageitem__loader",onClick:u[1]||(u[1]=e.withModifiers(m=>i.value=!i.value,["stop"]))},[e.createVNode(gn,{storage:t.storage,path:t.storage+"://",modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=m=>i.value=m)},null,8,["storage","path","modelValue"])])]),e.withDirectives(e.createVNode(Kc,{storage:t.storage,path:t.storage+"://",class:"vuefinder__treestorageitem__subfolder"},null,8,["storage","path"]),[[e.vShow,i.value]])],64))}}),Xc={class:"vuefinder__folder-indicator"},Qc={class:"vuefinder__folder-indicator--icon"},Zc=e.defineComponent({__name:"FolderIndicator",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(t){const n=e.useModel(t,"modelValue");return(o,i)=>(e.openBlock(),e.createElementBlock("div",Xc,[e.createElementVNode("div",Qc,[n.value?(e.openBlock(),e.createBlock(e.unref(pn),{key:0,class:"vuefinder__folder-indicator--minus"})):e.createCommentVNode("",!0),n.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(fn),{key:1,class:"vuefinder__folder-indicator--plus"}))])]))}}),Jc={class:"vuefinder__treeview__header"},eu={class:"vuefinder__treeview__pinned-label"},tu={class:"vuefinder__treeview__pin-text text-nowrap"},nu={key:0,class:"vuefinder__treeview__pinned-list"},ou=["onClick"],iu=["title"],ru=["onClick"],su={key:0},au={class:"vuefinder__treeview__no-pinned"},lu=e.defineComponent({__name:"TreeView",setup(t){const n=e.inject("ServiceContainer"),{t:o}=n.i18n,{getStore:i,setStore:s}=n.storage,r=n.fs,l=n.config,c=R.useStore(l.state),a=R.useStore(r.sortedFiles),h=R.useStore(r.path),d=De(n,["bg-blue-200","dark:bg-slate-600"]),u=e.ref(190),m=e.ref(i("pinned-folders-opened",!0));e.watch(m,_=>s("pinned-folders-opened",_));const f=_=>{l.set("pinnedFolders",l.get("pinnedFolders").filter(g=>g.path!==_.path))},v=_=>{const g=_.clientX,k=_.target.parentElement;if(!k)return;const S=k.getBoundingClientRect().width;k.classList.remove("transition-[width]"),k.classList.add("transition-none");const N=q=>{u.value=S+q.clientX-g,u.value<50&&(u.value=0,l.set("showTreeView",!1)),u.value>50&&l.set("showTreeView",!0)},O=()=>{const q=k.getBoundingClientRect();u.value=q.width,k.classList.add("transition-[width]"),k.classList.remove("transition-none"),window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",O)};window.addEventListener("mousemove",N),window.addEventListener("mouseup",O)},p=e.ref(null);return e.onMounted(()=>{p.value&&ct.OverlayScrollbars(p.value,{overflow:{x:"hidden"},scrollbars:{theme:"vf-theme-dark dark:vf-theme-light"}})}),e.watch(a,_=>{const g=_.filter(k=>k.type==="dir");vn(n.treeViewData,{path:h.value?.path||"",folders:g.map(k=>({storage:k.storage,path:k.path,basename:k.basename,type:"dir"}))})}),(_,g)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{onClick:g[0]||(g[0]=k=>e.unref(l).toggle("showTreeView")),class:e.normalizeClass(["vuefinder__treeview__overlay",e.unref(c).showTreeView?"vuefinder__treeview__backdrop":"hidden"])},null,2),e.createElementVNode("div",{style:e.normalizeStyle(e.unref(c).showTreeView?"min-width:100px;max-width:75%; width: "+u.value+"px":"width: 0"),class:"vuefinder__treeview__container"},[e.createElementVNode("div",{ref_key:"treeViewScrollElement",ref:p,class:"vuefinder__treeview__scroll"},[e.createElementVNode("div",Jc,[e.createElementVNode("div",{onClick:g[2]||(g[2]=k=>m.value=!m.value),class:"vuefinder__treeview__pinned-toggle"},[e.createElementVNode("div",eu,[e.createVNode(e.unref(dn),{class:"vuefinder__treeview__pin-icon"}),e.createElementVNode("div",tu,e.toDisplayString(e.unref(o)("Pinned Folders")),1)]),e.createVNode(Zc,{modelValue:m.value,"onUpdate:modelValue":g[1]||(g[1]=k=>m.value=k)},null,8,["modelValue"])]),m.value?(e.openBlock(),e.createElementBlock("ul",nu,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c).pinnedFolders,k=>(e.openBlock(),e.createElementBlock("li",{key:k.path,class:"vuefinder__treeview__pinned-item"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(d).events(k),!0),{class:"vuefinder__treeview__pinned-folder",onClick:S=>e.unref(n).emitter.emit("vf-fetch",{params:{q:"index",storage:k.storage,path:k.path}})}),[e.unref(h)?.path!==k.path?(e.openBlock(),e.createBlock(e.unref(We),{key:0,class:"vuefinder__treeview__folder-icon"})):e.createCommentVNode("",!0),e.unref(h)?.path===k.path?(e.openBlock(),e.createBlock(e.unref(mn),{key:1,class:"vuefinder__treeview__open-folder-icon"})):e.createCommentVNode("",!0),e.createElementVNode("div",{title:k.path,class:e.normalizeClass(["vuefinder__treeview__folder-name",{"vuefinder__treeview__folder-name--active":e.unref(h)?.path===k.path}])},e.toDisplayString(k.basename),11,iu)],16,ou),e.createElementVNode("div",{class:"vuefinder__treeview__remove-folder",onClick:S=>f(k)},[e.createVNode(e.unref(Ic),{class:"vuefinder__treeview__remove-icon"})],8,ru)]))),128)),e.unref(c).pinnedFolders.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("li",su,[e.createElementVNode("div",au,e.toDisplayString(e.unref(o)("No folders pinned")),1)]))])):e.createCommentVNode("",!0)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r).storages.get(),k=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__treeview__storage",key:k},[e.createVNode(Gc,{storage:k},null,8,["storage"])]))),128))],512),e.createElementVNode("div",{onMousedown:v,class:"vuefinder__treeview__resize-handle"},null,32)],4)],64))}}),ie={newfolder:"newfolder",selectAll:"selectAll",pinFolder:"pinFolder",unpinFolder:"unpinFolder",delete:"delete",refresh:"refresh",preview:"preview",open:"open",openDir:"openDir",download:"download",download_archive:"download_archive",archive:"archive",unarchive:"unarchive",rename:"rename",move:"move"};function cu(t){return t.items.length>1&&t.items.some(n=>n.path===t.target?.path)?"many":t.target?"one":"none"}function te(t){const n=Object.assign({needsSearchQuery:!1},t);return(o,i)=>!(n.needsSearchQuery!==!!i.searchQuery||n.target!==void 0&&n.target!==cu(i)||n.targetType!==void 0&&n.targetType!==i.target?.type||n.mimeType!==void 0&&n.mimeType!==i.target?.mime_type||n.feature!==void 0&&!o.features.includes(n.feature))}function tt(...t){return(n,o)=>t.some(i=>i(n,o))}function Me(...t){return(n,o)=>t.every(i=>i(n,o))}const _n=[{id:ie.openDir,title:({t})=>t("Open containing folder"),action:(t,n)=>{t.emitter.emit("vf-search-exit"),t.emitter.emit("vf-fetch",{params:{q:"index",storage:n[0]?.storage,path:n[0]?.path}})},show:te({target:"one",needsSearchQuery:!0})},{id:ie.refresh,title:({t})=>t("Refresh"),action:t=>{const n=t.fs;t.emitter.emit("vf-fetch",{params:{q:"index",storage:n.path.get().storage,path:n.path.get().path}})},show:tt(te({target:"none"}),te({target:"many"}))},{id:ie.selectAll,title:({t})=>t("Select All"),action:t=>{t.fs.selectAll()},show:te({target:"none"})},{id:ie.newfolder,title:({t})=>t("New Folder"),action:t=>t.modal.open(on),show:te({target:"none",feature:W.NEW_FOLDER})},{id:ie.open,title:({t})=>t("Open"),action:(t,n)=>{t.emitter.emit("vf-search-exit"),n[0]&&t.emitter.emit("vf-fetch",{params:{q:"index",storage:n[0].storage,path:n[0].path}})},show:te({target:"one",targetType:"dir"})},{id:ie.pinFolder,title:({t})=>t("Pin Folder"),action:(t,n)=>{const o=t.config,i=o.get("pinnedFolders"),s=i.concat(n.filter(r=>i.findIndex(l=>l.path===r.path)===-1));o.set("pinnedFolders",s)},show:Me(te({target:"one",targetType:"dir"}),(t,n)=>t.config.get("pinnedFolders").findIndex(s=>s.path===n.target?.path)===-1)},{id:ie.unpinFolder,title:({t})=>t("Unpin Folder"),action:(t,n)=>{const o=t.config,i=o.get("pinnedFolders");o.set("pinnedFolders",i.filter(s=>!n.find(r=>r.path===s.path)))},show:Me(te({target:"one",targetType:"dir"}),(t,n)=>t.config.get("pinnedFolders").findIndex(s=>s.path===n.target?.path)!==-1)},{id:ie.preview,title:({t})=>t("Preview"),action:(t,n)=>t.modal.open(Jt,{storage:n[0]?.storage,item:n[0]}),show:Me(te({target:"one",feature:W.PREVIEW}),(t,n)=>n.target?.type!=="dir")},{id:ie.download,link:(t,n)=>t.requester.getDownloadUrl(n[0]?.storage,n[0]),title:({t})=>t("Download"),action:()=>{},show:Me(te({target:"one",feature:W.DOWNLOAD}),(t,n)=>n.target?.type!=="dir")},{id:ie.rename,title:({t})=>t("Rename"),action:(t,n)=>t.modal.open(dt,{items:n}),show:te({target:"one",feature:W.RENAME})},{id:ie.archive,title:({t})=>t("Archive"),action:(t,n)=>t.modal.open(un,{items:n}),show:tt(te({target:"many",feature:W.ARCHIVE}),Me(te({target:"one",feature:W.ARCHIVE}),(t,n)=>n.target?.mime_type!=="application/zip"))},{id:ie.unarchive,title:({t})=>t("Unarchive"),action:(t,n)=>t.modal.open(ln,{items:n}),show:te({target:"one",feature:W.UNARCHIVE,mimeType:"application/zip"})},{id:ie.delete,title:({t})=>t("Delete"),action:(t,n)=>{t.modal.open(ut,{items:n})},show:tt(te({feature:W.DELETE,target:"one"}),te({feature:W.DELETE,target:"many"}))}],uu={class:"vuefinder",ref:"root",tabindex:"0"},du={class:"vuefinder__main__content"},wn=e.defineComponent({__name:"VueFinder",props:{id:{default:"vf"},request:{},persist:{type:Boolean,default:!1},path:{default:""},features:{type:[Boolean,Array],default:!0},debug:{type:Boolean,default:!1},theme:{default:"system"},locale:{default:void 0},maxHeight:{default:"600px"},maxFileSize:{default:"10mb"},fullScreen:{type:Boolean,default:!1},showTreeView:{type:Boolean,default:!1},pinnedFolders:{default:()=>[]},showThumbnails:{type:Boolean,default:!0},selectButton:{default:()=>({active:!1,multiple:!1,click:()=>{}})},loadingIndicator:{default:"linear"},contextMenuItems:{default:()=>_n},onError:{},onSelect:{},"onUpdate:path":{},icon:{}},emits:["select","update:path"],setup(t,{emit:n}){const o=n,i=t,s=Pn(i,e.inject("VueFinderOptions"));e.provide("ServiceContainer",s);const r=s.config,l=s.fs,c=R.useStore(r.state),a=R.useStore(l.selectedItems);as(s);let h=null;s.emitter.on("vf-fetch-abort",()=>{h&&h.abort(),l.setLoading(!1)}),s.emitter.on("vf-fetch",({params:u,body:m=null,onSuccess:f=null,onError:v=null,noCloseModal:p=!1})=>{["index","search"].includes(u.q)&&(h&&h.abort(),l.setLoading(!0)),u.adapter=u.storage,h=new AbortController;const _=h.signal;s.requester.send({url:"",method:u.m||"get",params:u,body:m,abortSignal:_}).then(g=>{l.setPath(g.dirname),r.get("persist")&&r.set("path",g.dirname),p||s.modal.close(),l.setFiles(g.files),l.clearSelection(),l.setSelectedCount(0),l.setStorages(g.storages),f&&f(g)}).catch(g=>{console.error(g),v?v(g):g&&typeof g=="object"&&"message"in g&&s.emitter.emit("vf-toast-push",{label:g.message,type:"error"})}).finally(()=>{["index","search"].includes(u.q)&&l.setLoading(!1)})});function d(u){let m={};u&&u.includes("://")&&(m={storage:u.split("://")[0],path:u}),s.emitter.emit("vf-fetch",{params:{q:"index",storage:l.path.get().storage,...m},onError:i.onError??(f=>{f&&typeof f=="object"&&"message"in f&&s.emitter.emit("vf-toast-push",{label:f.message,type:"error"})})})}return e.onMounted(()=>{e.watch(()=>i.path,m=>{d(m)});const u=r.get("persist")?r.get("path"):i.path;l.setPath(u),d(u),s.emitter.on("vf-select",m=>{s.selectedItems=m,o("select",m)}),e.watch(()=>l.path.get().path,m=>{o("update:path",m)}),e.watch(a,m=>{o("select",m)})}),(u,m)=>(e.openBlock(),e.createElementBlock("div",uu,[e.createElementVNode("div",{class:e.normalizeClass(e.unref(s).theme.actualValue)},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(c).fullScreen?"vuefinder__main__fixed":"vuefinder__main__relative","vuefinder__main__container"]),style:e.normalizeStyle(e.unref(c).fullScreen?"":"max-height: "+t.maxHeight),onMousedown:m[0]||(m[0]=f=>e.unref(s).emitter.emit("vf-contextmenu-hide")),onTouchstart:m[1]||(m[1]=f=>e.unref(s).emitter.emit("vf-contextmenu-hide"))},[e.createVNode(Aa),e.createVNode(yl),e.createElementVNode("div",du,[e.createVNode(lu),e.createVNode(dc)]),e.createVNode(Ac)],38),e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[e.unref(s).modal.visible?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(s).modal.type),{key:0})):e.createCommentVNode("",!0)]),_:1}),e.createVNode(fc)],2)],512))}}),bn={install(t,n={}){n.i18n=n.i18n??{};let[o]=Object.keys(n.i18n);n.locale=n.locale??o??"en",t.provide("VueFinderOptions",n),t.component("VueFinder",wn)}};exports.ContextMenuIds=ie;exports.VueFinder=wn;exports.VueFinderPlugin=bn;exports.contextMenuItems=_n;exports.default=bn;
