"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),A=require("@nanostores/vue"),Je=require("mitt"),Ze=require("@nanostores/persistent"),W=require("nanostores"),et=require("cropperjs"),tt=require("@uppy/core"),nt=require("@uppy/xhr-upload"),ot=require("@viselect/vanilla"),rt=require("vanilla-lazyload"),ge=require("overlayscrollbars"),fe=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");class lt{config;constructor(t){this.config=Object.assign({baseUrl:"",headers:{},params:{},body:{},xsrfHeaderName:"X-CSRF-Token",fetchParams:{}},t)}customFetch=async(...t)=>{let[o,l]=t;this.config.fetchRequestInterceptor&&(l=this.config.fetchRequestInterceptor(l));let r=await fetch(o,l);return this.config.fetchResponseInterceptor&&(r=await this.config.fetchResponseInterceptor(r)),r};transformRequestParams(t){const o=this.config,l={};fe!=null&&fe!==""&&o.xsrfHeaderName&&(l[o.xsrfHeaderName]=fe);const r=Object.assign({},o.headers,l,t.headers),m=Object.assign({},o.params,t.params),c=o.baseUrl+t.url,d=t.method;let i;if(d!=="get")if(t.body instanceof FormData){const s=t.body;o.body!=null&&Object.entries(this.config.body).forEach(([a,f])=>{s.append(a,String(f))}),i=s}else{const s=Object.assign({},t.body??{});o.body!=null&&Object.assign(s,this.config.body),i=s}const u={url:c,method:d,headers:r,params:m,body:i};if(o.transformRequest!=null){const s=o.transformRequest({url:c,method:d,headers:r,params:m,body:i??null});s.url!=null&&(u.url=s.url),s.method!=null&&(u.method=s.method),s.params!=null&&(u.params=s.params),s.headers!=null&&(u.headers=s.headers),s.body!=null&&(u.body=s.body)}return u}getDownloadUrl(t,o){if(o.url!=null)return o.url;const l=this.transformRequestParams({url:"",method:"get",params:{q:"download",storage:t,adapter:t,path:o.path}});return l.url+"?"+new URLSearchParams(l.params).toString()}getPreviewUrl(t,o){if(o.url!=null)return o.url;const l=this.transformRequestParams({url:"",method:"get",params:{q:"preview",storage:t,adapter:t,path:o.path}});return l.url+"?"+new URLSearchParams(l.params).toString()}async send(t){const o=this.transformRequestParams(t),l=t.responseType||"json",r={method:t.method,headers:o.headers,signal:t.abortSignal},m=o.url+"?"+new URLSearchParams(o.params);if(o.method!=="get"&&o.body!=null){let d;o.body instanceof FormData?d=t.body:(d=JSON.stringify(o.body),r.headers["Content-Type"]="application/json"),r.body=d}this.config.fetchParams&&Object.assign(r,this.config.fetchParams);const c=await this.customFetch(m,r);if(c.ok)return await c[l]();throw await c.json()}}function at(n){const t={baseUrl:"",headers:{},params:{},body:{},xsrfHeaderName:"X-CSRF-Token",fetchParams:{}};return typeof n=="string"?Object.assign(t,{baseUrl:n}):Object.assign(t,n),new lt(t)}function st(n){let t=localStorage.getItem(n+"_storage");const o=e.reactive(JSON.parse(t??"{}"));e.watch(o,l);function l(){Object.keys(o).length?localStorage.setItem(n+"_storage",JSON.stringify(o)):localStorage.removeItem(n+"_storage")}function r(i,u){o[i]=u}function m(i){delete o[i]}function c(){Object.keys(o).forEach(i=>m(i))}return{getStore:(i,u=null)=>i in o?o[i]:u,setStore:r,removeStore:m,clearStore:c}}async function it(n,t){const o=t[n];return typeof o=="function"?(await o()).default:o}function ct(n,t,o,l){const{getStore:r,setStore:m}=n,c=e.ref({}),d=e.ref(r("locale",t)),i=(a,f=t)=>{it(a,l).then(v=>{c.value=v,m("locale",a),d.value=a,m("translations",v),Object.values(l).length>1&&(o.emit("vf-toast-push",{label:"The language is set to "+a}),o.emit("vf-language-saved"))}).catch(()=>{f?(o.emit("vf-toast-push",{label:"The selected locale is not yet supported!",type:"error"}),i(f,null)):o.emit("vf-toast-push",{label:"Locale cannot be loaded!",type:"error"})})};e.watch(d,a=>{i(a)}),!r("locale")&&!Object.keys(l).length?i(t):c.value=r("translations");const u=(a,...f)=>f.length?u(a=a.replace("%s",String(f.shift())),...f):a;function s(a,...f){return c.value&&Object.prototype.hasOwnProperty.call(c.value,a)?u(c.value[a]||a,...f):u(a,...f)}return e.reactive({t:s,locale:d})}const H={EDIT:"edit",NEW_FILE:"newfile",NEW_FOLDER:"newfolder",PREVIEW:"preview",ARCHIVE:"archive",UNARCHIVE:"unarchive",SEARCH:"search",RENAME:"rename",UPLOAD:"upload",DELETE:"delete",FULL_SCREEN:"fullscreen",DOWNLOAD:"download",LANGUAGE:"language"},dt=Object.values(H),ut="3.0.0-dev";function Ne(n,t,o,l,r){return t=Math,o=t.log,l=1024,r=o(n)/o(l)|0,(n/t.pow(l,r)).toFixed(0)+" "+(r?"KMGTPEZY"[--r]+"iB":"B")}function Se(n,t,o,l,r){return t=Math,o=t.log,l=1e3,r=o(n)/o(l)|0,(n/t.pow(l,r)).toFixed(0)+" "+(r?"KMGTPEZY"[--r]+"B":"B")}function mt(n){if(typeof n=="number")return n;const t={k:1,m:2,g:3,t:4},l=/(\d+(?:\.\d+)?)\s?(k|m|g|t)?b?/i.exec(n);if(!l)return 0;const r=parseFloat(l[1]||"0"),m=(l[2]||"").toLowerCase(),c=t[m]??0;return Math.round(r*Math.pow(1024,c))}const re={SYSTEM:"system",LIGHT:"light",DARK:"dark"};function ft(n,t){const o=e.ref(re.SYSTEM),l=e.ref(re.LIGHT);o.value=n.getStore("theme",t??re.SYSTEM);const r=window.matchMedia("(prefers-color-scheme: dark)"),m=c=>{o.value===re.DARK||o.value===re.SYSTEM&&c.matches?l.value=re.DARK:l.value=re.LIGHT};return m(r),r.addEventListener("change",m),{value:o,actualValue:l,set(c){o.value=c,c!==re.SYSTEM?n.setStore("theme",c):n.removeStore("theme"),m(r)}}}function vt(){const n=e.shallowRef(null),t=e.ref(!1),o=e.ref();return{visible:t,type:n,data:o,open:(m,c=null)=>{document.querySelector("body").style.overflow="hidden",t.value=!0,n.value=m,o.value=c},close:()=>{document.querySelector("body").style.overflow="",t.value=!1,n.value=null}}}const ve={view:"grid",fullScreen:!1,showTreeView:!1,compactListView:!0,metricUnits:!1,showThumbnails:!0,persist:!1,path:"",loadingIndicator:"circular",maxFileSize:null,pinnedFolders:[],customIcon:void 0,selectButton:!1},_t=n=>{const t=`vuefinder_config_${n}`,o=Ze.persistentAtom(t,ve,{encode:JSON.stringify,decode:JSON.parse}),l=(u={})=>{const s=o.get(),a={...ve,...u,...s};o.set(a)},r=u=>o.get()[u],m=()=>o.get(),c=(u,s)=>{const a=o.get();typeof u=="object"&&u!==null?o.set({...a,...u}):o.set({...a,[u]:s})};return{state:o,init:l,get:r,set:c,toggle:u=>{const s=o.get();c(u,!s[u])},all:m,reset:()=>{o.set({...ve})}}};function pt(n,t){if(typeof n=="string"&&typeof t=="string")return n.toLowerCase().localeCompare(t.toLowerCase());const o=Number(n)||0,l=Number(t)||0;return o===l?0:o<l?-1:1}const ht=()=>{const n=W.atom(""),t=W.atom([]),o=W.atom([]),l=W.atom({active:!1,column:"",order:""}),r=W.atom(new Set),m=W.atom({type:"copy",path:"",items:new Set}),c=W.atom(null),d=W.atom(0),i=W.atom(!1),u=W.computed([n],_=>{const y=(_||"local://").trim(),P=y.indexOf("://"),K=P>=0?y.slice(0,P):"",le=(P>=0?y.slice(P+3):y).split("/").filter(Boolean);let ee="";const ae=le.map(oe=>(ee=ee?`${ee}/${oe}`:oe,{basename:oe,name:oe,path:K?`${K}://${ee}`:ee,type:"dir"}));return{storage:K,breadcrumb:ae,path:y}}),s=W.computed([o,l],(_,y)=>{const{active:P,column:K,order:ne}=y;if(!P||!K)return _;const le=ne==="asc"?1:-1;return _.slice().sort((ee,ae)=>pt(ee[K],ae[K])*le)}),a=W.computed([o,r],(_,y)=>y.size===0?[]:_.filter(P=>y.has(P.path))),f=_=>{n.set(_)},v=_=>{o.set(_??[])},b=_=>{t.set(_??[])},g=(_,y)=>{l.set({active:!0,column:_,order:y})},k=_=>{const y=l.get();y.active&&y.column===_?l.set({active:y.order==="asc",column:_,order:"desc"}):l.set({active:!0,column:_,order:"asc"})},h=()=>{l.set({active:!1,column:"",order:""})},w=_=>{const y=new Set(r.get());y.add(_),r.set(y),d.set(y.size)},N=_=>{const y=new Set(r.get());y.delete(_),r.set(y),d.set(y.size)},M=_=>{const y=new Set(r.get());y.has(_)?y.delete(_):y.add(_),r.set(y),d.set(y.size)},z=()=>{const _=new Set(o.get().map(y=>y.path));r.set(_),d.set(_.size)},j=()=>{r.set(new Set),d.set(0)},C=_=>{const y=new Set(_??[]);r.set(y),d.set(y.size)},B=_=>{d.set(_)},U=_=>{i.set(!!_)},F=()=>i.get(),O=(_,y)=>{const P=o.get().filter(K=>y.has(K.path));m.set({type:_,path:u.get().path,items:new Set(P)})},S=_=>W.computed([m],y=>y.type==="cut"&&Array.from(y.items).some(P=>P.path===_)),p=_=>W.computed([m],y=>y.type==="copy"&&Array.from(y.items).some(P=>P.path===_));return{files:o,storages:t,currentPath:n,sort:l,selectedKeys:r,selectedCount:d,loading:i,draggedItem:c,clipboardItems:m,path:u,sortedFiles:s,selectedItems:a,setPath:f,setFiles:v,setStorages:b,setSort:g,toggleSort:k,clearSort:h,select:w,deselect:N,toggleSelect:M,selectAll:z,clearSelection:j,setSelection:C,setSelectedCount:B,setLoading:U,isLoading:F,setClipboard:O,createIsCut:S,createIsCopied:p,isCut:_=>{const y=S(_);return A.useStore(y).value??!1},isCopied:_=>{const y=p(_);return A.useStore(y).value??!1},clearClipboard:()=>{m.set({type:"copy",path:"",items:new Set})},getClipboard:()=>m.get(),setDraggedItem:_=>{c.set(_)},getDraggedItem:()=>c.get(),clearDraggedItem:()=>{c.set(null)}}},ye={query:"",searchMode:!1},gt=()=>{const n=W.atom(ye),t=W.computed(n,u=>u.query.length>0);return{state:n,hasQuery:t,setQuery:u=>{const s=n.get();n.set({...s,query:u??""})},enterSearchMode:()=>{const u=n.get();n.set({...u,searchMode:!0})},exitSearchMode:()=>{n.set({query:"",searchMode:!1})},get:u=>n.get()[u],set:(u,s)=>{const a=n.get();typeof u=="object"&&u!==null?n.set({...a,...u}):n.set({...a,[u]:s})},all:()=>n.get(),reset:()=>{n.set({...ye})}}},kt=(n,t)=>{const o=st(n.id),l=Je(),r=ft(o,n.theme),m=t.i18n,c=n.locale??t.locale,d=_t(n.id),i=ht(),u=gt(),s=a=>Array.isArray(a)?a:dt;return e.reactive({version:ut,config:d,fs:i,search:u,root:e.useTemplateRef("root"),debug:n.debug,emitter:l,storage:o,i18n:ct(o,c,l,m),modal:vt(),requester:at(n.request),features:s(n.features),treeViewData:[],theme:r,filesize:d.get("metricUnits")?Se:Ne,contextMenuItems:n.contextMenuItems,customIcon:n.icon,selectButton:n.selectButton})},wt={class:"vuefinder__modal-layout__container"},Et={class:"vuefinder__modal-layout__content"},yt={class:"vuefinder__modal-layout__footer"},Z=e.defineComponent({__name:"ModalLayout",setup(n){const t=e.ref(null),o=e.inject("ServiceContainer");return e.onMounted(()=>{const l=document.querySelector(".v-f-modal input");l&&l.focus(),e.nextTick(()=>{if(document.querySelector(".v-f-modal input")&&window.innerWidth<768&&t.value){const r=t.value.getBoundingClientRect().bottom+16;window.scrollTo({top:r,left:0,behavior:"smooth"})}})}),(l,r)=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__modal-layout","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",onKeyup:r[1]||(r[1]=e.withKeys(m=>e.unref(o).modal.close(),["esc"])),tabindex:"0"},[r[2]||(r[2]=e.createElementVNode("div",{class:"vuefinder__modal-layout__overlay"},null,-1)),e.createElementVNode("div",wt,[e.createElementVNode("div",{class:"vuefinder__modal-layout__wrapper",onMousedown:r[0]||(r[0]=e.withModifiers(m=>e.unref(o).modal.close(),["self"]))},[e.createElementVNode("div",{ref_key:"modalBody",ref:t,class:"vuefinder__modal-layout__body"},[e.createElementVNode("div",Et,[e.renderSlot(l.$slots,"default")]),e.createElementVNode("div",yt,[e.renderSlot(l.$slots,"buttons")])],512)],32)])],32))}}),bt={class:"vuefinder__modal-header"},Vt={class:"vuefinder__modal-header__icon-container"},Nt={class:"vuefinder__modal-header__title",id:"modal-title"},te=e.defineComponent({__name:"ModalHeader",props:{title:{},icon:{}},setup(n){return(t,o)=>(e.openBlock(),e.createElementBlock("div",bt,[e.createElementVNode("div",Vt,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.icon),{class:"vuefinder__modal-header__icon"}))]),e.createElementVNode("h3",Nt,e.toDisplayString(n.title),1)]))}}),St={props:{on:{type:String,required:!0}},setup(n,{emit:t,slots:o}){const l=e.inject("ServiceContainer"),r=e.ref(!1),{t:m}=l.i18n;let c=null;const d=()=>{clearTimeout(c),r.value=!0,c=setTimeout(()=>{r.value=!1},2e3)};return e.onMounted(()=>{l.emitter.on(n.on,d)}),e.onUnmounted(()=>{clearTimeout(c)}),{shown:r,t:m}}},Bt=(n,t)=>{const o=n.__vccOpts||n;for(const[l,r]of t)o[l]=r;return o},xt={key:1};function Ct(n,t,o,l,r,m){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__action-message",{"vuefinder__action-message--hidden":!l.shown}])},[n.$slots.default?e.renderSlot(n.$slots,"default",{key:0}):(e.openBlock(),e.createElementBlock("span",xt,e.toDisplayString(l.t("Saved.")),1))],2)}const se=Bt(St,[["render",Ct]]),$t={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"h-6 w-6 stroke-blue-600 dark:stroke-blue-100",viewBox:"0 0 24 24"};function Dt(n,t){return e.openBlock(),e.createElementBlock("svg",$t,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87q.11.06.22.127c.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a8 8 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a7 7 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a7 7 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a7 7 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124q.108-.066.22-.128c.332-.183.582-.495.644-.869z"},null,-1),e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0"},null,-1)])])}const Tt={render:Dt},Mt={class:"vuefinder__about-modal__content"},At={class:"vuefinder__about-modal__main"},Ft={class:"vuefinder__about-modal__tabs","aria-label":"Tabs"},It=["onClick","aria-current"],Lt={key:0,class:"vuefinder__about-modal__tab-content"},Rt={class:"vuefinder__about-modal__description"},zt={href:"https://vuefinder.ozdemir.be",class:"vuefinder__about-modal__link",target:"_blank"},qt={href:"https://github.com/n1crack/vuefinder",class:"vuefinder__about-modal__link",target:"_blank"},Ht={key:1,class:"vuefinder__about-modal__tab-content"},Pt={class:"vuefinder__about-modal__description"},jt={class:"vuefinder__about-modal__settings"},Ut={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},Ot={class:"vuefinder__about-modal__setting-input"},Kt=["checked"],Gt={class:"vuefinder__about-modal__setting-label"},Yt={for:"metric_unit",class:"vuefinder__about-modal__label"},Wt={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},Qt={class:"vuefinder__about-modal__setting-input"},Xt=["checked"],Jt={class:"vuefinder__about-modal__setting-label"},Zt={for:"large_icons",class:"vuefinder__about-modal__label"},en={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},tn={class:"vuefinder__about-modal__setting-input"},nn=["checked"],on={class:"vuefinder__about-modal__setting-label"},rn={for:"persist_path",class:"vuefinder__about-modal__label"},ln={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},an={class:"vuefinder__about-modal__setting-input"},sn=["checked"],cn={class:"vuefinder__about-modal__setting-label"},dn={for:"show_thumbnails",class:"vuefinder__about-modal__label"},un={class:"vuefinder__about-modal__setting vuefinder__about-modal__setting--flex"},mn={class:"vuefinder__about-modal__setting-input"},fn={for:"theme",class:"vuefinder__about-modal__label"},vn={class:"vuefinder__about-modal__setting-label"},_n=["label"],pn=["value"],hn={key:0,class:"vuefinder__about-modal__setting"},gn={class:"vuefinder__about-modal__setting-input"},kn={for:"language",class:"vuefinder__about-modal__label"},wn={class:"vuefinder__about-modal__setting-label"},En=["label"],yn=["value"],bn={key:2,class:"vuefinder__about-modal__tab-content"},Vn={class:"vuefinder__about-modal__shortcuts"},Nn={class:"vuefinder__about-modal__shortcut"},Sn={class:"vuefinder__about-modal__shortcut"},Bn={class:"vuefinder__about-modal__shortcut"},xn={class:"vuefinder__about-modal__shortcut"},Cn={class:"vuefinder__about-modal__shortcut"},$n={class:"vuefinder__about-modal__shortcut"},Dn={class:"vuefinder__about-modal__shortcut"},Tn={class:"vuefinder__about-modal__shortcut"},Mn={class:"vuefinder__about-modal__shortcut"},An={class:"vuefinder__about-modal__shortcut"},Fn={key:3,class:"vuefinder__about-modal__tab-content"},In={class:"vuefinder__about-modal__description"},Be=e.defineComponent({__name:"ModalAbout",setup(n){const t=e.inject("ServiceContainer"),o=t.config,{clearStore:l}=t.storage,{t:r}=t.i18n,m={ABOUT:"about",SETTINGS:"settings",SHORTCUTS:"shortcuts",RESET:"reset"},c=e.computed(()=>[{name:r("About"),key:m.ABOUT,current:!1},{name:r("Settings"),key:m.SETTINGS,current:!1},{name:r("Shortcuts"),key:m.SHORTCUTS,current:!1},{name:r("Reset"),key:m.RESET,current:!1}]),d=e.ref("about"),i=async()=>{o.reset(),l(),location.reload()},u=w=>{t.theme.set(w),t.emitter.emit("vf-theme-saved")},s=()=>{o.toggle("metricUnits"),t.filesize=o.get("metricUnits")?Se:Ne,t.emitter.emit("vf-metric-units-saved")},a=()=>{o.toggle("compactListView"),t.emitter.emit("vf-compact-view-saved")},f=()=>{o.toggle("showThumbnails"),t.emitter.emit("vf-show-thumbnails-saved")},v=()=>{o.toggle("persist"),t.emitter.emit("vf-persist-path-saved")},{i18n:b}=e.inject("VueFinderOptions"),k=Object.fromEntries(Object.entries({ar:"Arabic (العربيّة)",en:"English",fr:"French (Français)",de:"German (Deutsch)",fa:"Persian (فارسی)",he:"Hebrew (עִברִית)",hi:"Hindi (हिंदी)",pl:"Polish (Polski)",ru:"Russian (Pусский)",sv:"Swedish (Svenska)",tr:"Turkish (Türkçe)",nl:"Dutch (Nederlands)",zhCN:"Simplified Chinese (简体中文)",zhTW:"Traditional Chinese (繁體中文)"}).filter(([w])=>Object.keys(b).includes(w))),h=e.computed(()=>({system:r("System"),light:r("Light"),dark:r("Dark")}));return(w,N)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:N[3]||(N[3]=M=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(r)("Close")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",Mt,[e.createVNode(te,{icon:e.unref(Tt),title:"Vuefinder "+e.unref(t).version},null,8,["icon","title"]),e.createElementVNode("div",At,[e.createElementVNode("div",null,[e.createElementVNode("div",null,[e.createElementVNode("nav",Ft,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,M=>(e.openBlock(),e.createElementBlock("button",{key:M.name,onClick:z=>d.value=M.key,class:e.normalizeClass([M.key===d.value?"vuefinder__about-modal__tab--active":"vuefinder__about-modal__tab--inactive","vuefinder__about-modal__tab"]),"aria-current":M.current?"page":void 0},e.toDisplayString(M.name),11,It))),128))])])]),d.value===m.ABOUT?(e.openBlock(),e.createElementBlock("div",Lt,[e.createElementVNode("div",Rt,e.toDisplayString(e.unref(r)("Vuefinder is a simple, lightweight, and fast file manager library for Vue.js applications")),1),e.createElementVNode("a",zt,e.toDisplayString(e.unref(r)("Project home")),1),e.createElementVNode("a",qt,e.toDisplayString(e.unref(r)("Follow on GitHub")),1)])):e.createCommentVNode("",!0),d.value===m.SETTINGS?(e.openBlock(),e.createElementBlock("div",Ht,[e.createElementVNode("div",Pt,e.toDisplayString(e.unref(r)("Customize your experience with the following settings")),1),e.createElementVNode("div",jt,[e.createElementVNode("fieldset",null,[e.createElementVNode("div",Ut,[e.createElementVNode("div",Ot,[e.createElementVNode("input",{id:"metric_unit",name:"metric_unit",type:"checkbox",checked:e.unref(o).get("metricUnits"),onChange:s,class:"vuefinder__about-modal__checkbox"},null,40,Kt)]),e.createElementVNode("div",Gt,[e.createElementVNode("label",Yt,[e.createTextVNode(e.toDisplayString(e.unref(r)("Use Metric Units"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-metric-units-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(r)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",Wt,[e.createElementVNode("div",Qt,[e.createElementVNode("input",{id:"large_icons",name:"large_icons",type:"checkbox",checked:e.unref(o).get("compactListView"),onChange:a,class:"vuefinder__about-modal__checkbox"},null,40,Xt)]),e.createElementVNode("div",Jt,[e.createElementVNode("label",Zt,[e.createTextVNode(e.toDisplayString(e.unref(r)("Compact list view"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-compact-view-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(r)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",en,[e.createElementVNode("div",tn,[e.createElementVNode("input",{id:"persist_path",name:"persist_path",type:"checkbox",checked:e.unref(o).get("persist"),onChange:v,class:"vuefinder__about-modal__checkbox"},null,40,nn)]),e.createElementVNode("div",on,[e.createElementVNode("label",rn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Persist path on reload"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-persist-path-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(r)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",ln,[e.createElementVNode("div",an,[e.createElementVNode("input",{id:"show_thumbnails",name:"show_thumbnails",type:"checkbox",checked:e.unref(o).get("showThumbnails"),onChange:f,class:"vuefinder__about-modal__checkbox"},null,40,sn)]),e.createElementVNode("div",cn,[e.createElementVNode("label",dn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Show thumbnails"))+" ",1),e.createVNode(se,{class:"ms-3",on:"vf-show-thumbnails-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(r)("Saved.")),1)]),_:1})])])]),e.createElementVNode("div",un,[e.createElementVNode("div",mn,[e.createElementVNode("label",fn,e.toDisplayString(e.unref(r)("Theme")),1)]),e.createElementVNode("div",vn,[e.withDirectives(e.createElementVNode("select",{id:"theme","onUpdate:modelValue":N[0]||(N[0]=M=>e.unref(t).theme.value=M),onChange:N[1]||(N[1]=M=>u(M.target?.value||"")),class:"vuefinder__about-modal__select"},[e.createElementVNode("optgroup",{label:e.unref(r)("Theme")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(M,z)=>(e.openBlock(),e.createElementBlock("option",{value:z},e.toDisplayString(M),9,pn))),256))],8,_n)],544),[[e.vModelSelect,e.unref(t).theme.value]]),e.createVNode(se,{class:"ms-3",on:"vf-theme-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(r)("Saved.")),1)]),_:1})])]),e.unref(t).features.includes(e.unref(H).LANGUAGE)&&Object.keys(e.unref(k)).length>1?(e.openBlock(),e.createElementBlock("div",hn,[e.createElementVNode("div",gn,[e.createElementVNode("label",kn,e.toDisplayString(e.unref(r)("Language")),1)]),e.createElementVNode("div",wn,[e.withDirectives(e.createElementVNode("select",{id:"language","onUpdate:modelValue":N[2]||(N[2]=M=>e.unref(t).i18n.locale=M),class:"vuefinder__about-modal__select"},[e.createElementVNode("optgroup",{label:e.unref(r)("Language")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(k),(M,z)=>(e.openBlock(),e.createElementBlock("option",{value:z},e.toDisplayString(M),9,yn))),256))],8,En)],512),[[e.vModelSelect,e.unref(t).i18n.locale]]),e.createVNode(se,{class:"ms-3",on:"vf-language-saved"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(r)("Saved.")),1)]),_:1})])])):e.createCommentVNode("",!0)])])])):e.createCommentVNode("",!0),d.value===m.SHORTCUTS?(e.openBlock(),e.createElementBlock("div",bn,[e.createElementVNode("div",Vn,[e.createElementVNode("div",Nn,[e.createElementVNode("div",null,e.toDisplayString(e.unref(r)("Rename")),1),N[4]||(N[4]=e.createElementVNode("kbd",null,"F2",-1))]),e.createElementVNode("div",Sn,[e.createElementVNode("div",null,e.toDisplayString(e.unref(r)("Refresh")),1),N[5]||(N[5]=e.createElementVNode("kbd",null,"F5",-1))]),e.createElementVNode("div",Bn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Delete"))+" ",1),N[6]||(N[6]=e.createElementVNode("kbd",null,"Del",-1))]),e.createElementVNode("div",xn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Escape"))+" ",1),N[7]||(N[7]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Esc")],-1))]),e.createElementVNode("div",Cn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Select All"))+" ",1),N[8]||(N[8]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"A")],-1))]),e.createElementVNode("div",$n,[e.createTextVNode(e.toDisplayString(e.unref(r)("Search"))+" ",1),N[9]||(N[9]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"F")],-1))]),e.createElementVNode("div",Dn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Toggle Sidebar"))+" ",1),N[10]||(N[10]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"E")],-1))]),e.createElementVNode("div",Tn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Open Settings"))+" ",1),N[11]||(N[11]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,",")],-1))]),e.createElementVNode("div",Mn,[e.createTextVNode(e.toDisplayString(e.unref(r)("Toggle Full Screen"))+" ",1),N[12]||(N[12]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Ctrl"),e.createTextVNode(" + "),e.createElementVNode("kbd",null,"Enter")],-1))]),e.createElementVNode("div",An,[e.createTextVNode(e.toDisplayString(e.unref(r)("Preview"))+" ",1),N[13]||(N[13]=e.createElementVNode("div",null,[e.createElementVNode("kbd",null,"Space")],-1))])])])):e.createCommentVNode("",!0),d.value===m.RESET?(e.openBlock(),e.createElementBlock("div",Fn,[e.createElementVNode("div",In,e.toDisplayString(e.unref(r)("Reset all settings to default")),1),e.createElementVNode("button",{onClick:i,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(r)("Reset Settings")),1)])):e.createCommentVNode("",!0)])])]),_:1}))}}),Ln={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Rn(n,t){return e.openBlock(),e.createElementBlock("svg",Ln,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21q.512.078 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48 48 0 0 0-3.478-.397m-12 .562q.51-.089 1.022-.165m0 0a48 48 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a52 52 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a49 49 0 0 0-7.5 0"},null,-1)])])}const xe={render:Rn},zn={class:"vuefinder__delete-modal__content"},qn={class:"vuefinder__delete-modal__form"},Hn={class:"vuefinder__delete-modal__description"},Pn={class:"vuefinder__delete-modal__files vf-scrollbar"},jn={class:"vuefinder__delete-modal__file"},Un={key:0,class:"vuefinder__delete-modal__icon vuefinder__delete-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},On={key:1,class:"vuefinder__delete-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},Kn={class:"vuefinder__delete-modal__file-name"},Gn={class:"vuefinder__delete-modal__warning"},ke=e.defineComponent({__name:"ModalDelete",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=A.useStore(l.path),m=e.ref(t.modal.data.items),c=e.ref(""),d=()=>{m.value.length&&t.emitter.emit("vf-fetch",{params:{q:"delete",m:"post",storage:r.value.storage,path:r.value.path},body:{items:m.value.map(({path:i,type:u})=>({path:i,type:u}))},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("Files deleted.")})},onError:i=>{c.value=o(i.message)}})};return(i,u)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:d,class:"vf-btn vf-btn-danger"},e.toDisplayString(e.unref(o)("Yes, Delete!")),1),e.createElementVNode("button",{type:"button",onClick:u[1]||(u[1]=s=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1),e.createElementVNode("div",Gn,e.toDisplayString(e.unref(o)("This action cannot be undone.")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(xe),title:e.unref(o)("Delete files")},null,8,["icon","title"]),e.createElementVNode("div",zn,[e.createElementVNode("div",qn,[e.createElementVNode("p",Hn,e.toDisplayString(e.unref(o)("Are you sure you want to delete these files?")),1),e.createElementVNode("div",Pn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value,s=>(e.openBlock(),e.createElementBlock("p",jn,[s.type==="dir"?(e.openBlock(),e.createElementBlock("svg",Un,[...u[2]||(u[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",On,[...u[3]||(u[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",Kn,e.toDisplayString(s.basename),1)]))),256))]),c.value.length?(e.openBlock(),e.createBlock(e.unref(c),{key:0,onHidden:u[0]||(u[0]=s=>c.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),Yn={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Wn(n,t){return e.openBlock(),e.createElementBlock("svg",Yn,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"},null,-1)])])}const Ce={render:Wn},Qn={class:"vuefinder__rename-modal__content"},Xn={class:"vuefinder__rename-modal__item"},Jn={class:"vuefinder__rename-modal__item-info"},Zn={key:0,class:"vuefinder__rename-modal__icon vuefinder__rename-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},eo={key:1,class:"vuefinder__rename-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},to={class:"vuefinder__rename-modal__item-name"},we=e.defineComponent({__name:"ModalRename",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=A.useStore(l.path),m=e.ref(t.modal.data.items[0]),c=e.ref(t.modal.data.items[0].basename),d=e.ref(""),i=()=>{c.value!=""&&t.emitter.emit("vf-fetch",{params:{q:"rename",m:"post",storage:r.value.storage,path:r.value.path},body:{item:m.value.path,name:c.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("%s is renamed.",c.value)})},onError:u=>{d.value=o(u.message)}})};return(u,s)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:i,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Rename")),1),e.createElementVNode("button",{type:"button",onClick:s[2]||(s[2]=a=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(Ce),title:e.unref(o)("Rename")},null,8,["icon","title"]),e.createElementVNode("div",Qn,[e.createElementVNode("div",Xn,[e.createElementVNode("p",Jn,[m.value.type==="dir"?(e.openBlock(),e.createElementBlock("svg",Zn,[...s[3]||(s[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",eo,[...s[4]||(s[4]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",to,e.toDisplayString(m.value.basename),1)]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>c.value=a),onKeyup:e.withKeys(i,["enter"]),class:"vuefinder__rename-modal__input",placeholder:"Name",type:"text"},null,544),[[e.vModelText,c.value]]),d.value.length?(e.openBlock(),e.createBlock(e.unref(d),{key:0,onHidden:s[1]||(s[1]=a=>d.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(d.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),no=["title"],$e=e.defineComponent({__name:"Message",props:{error:{type:Boolean}},emits:["hidden"],setup(n,{emit:t}){const o=t,l=e.inject("ServiceContainer"),{t:r}=l.i18n,m=e.ref(!1),c=e.ref(null),d=e.ref(c.value?.innerHTML);e.watch(d,()=>m.value=!1);const i=()=>{o("hidden"),m.value=!0};return(u,s)=>(e.openBlock(),e.createElementBlock("div",null,[m.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"strMessage",ref:c,class:e.normalizeClass(["vuefinder__message",n.error?"vuefinder__message--error":"vuefinder__message--success"])},[e.renderSlot(u.$slots,"default"),e.createElementVNode("div",{class:"vuefinder__message__close",onClick:i,title:e.unref(r)("Close")},[...s[0]||(s[0]=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"vuefinder__message__icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,no)],2))]))}}),oo={class:"vuefinder__text-preview"},ro={class:"vuefinder__text-preview__header"},lo=["title"],ao={class:"vuefinder__text-preview__actions"},so={key:0,class:"vuefinder__text-preview__content"},io={key:1},co=e.defineComponent({__name:"Text",emits:["success"],setup(n,{emit:t}){const o=t,l=e.ref(""),r=e.ref(""),m=e.ref(null),c=e.ref(!1),d=e.ref(""),i=e.ref(!1),u=e.inject("ServiceContainer"),{t:s}=u.i18n;e.onMounted(()=>{u.requester.send({url:"",method:"get",params:{q:"preview",storage:u.modal.data.storage,adapter:u.modal.data.storage,path:u.modal.data.item.path},responseType:"text"}).then(v=>{l.value=v,o("success")})});const a=()=>{c.value=!c.value,r.value=l.value},f=()=>{d.value="",i.value=!1,u.requester.send({url:"",method:"post",params:{q:"save",storage:u.modal.data.storage,adapter:u.modal.data.storage,path:u.modal.data.item.path},body:{content:r.value},responseType:"text"}).then(v=>{d.value=s("Updated."),l.value=v,o("success"),c.value=!c.value}).catch(v=>{d.value=s(v.message),i.value=!0})};return(v,b)=>(e.openBlock(),e.createElementBlock("div",oo,[e.createElementVNode("div",ro,[e.createElementVNode("div",{class:"vuefinder__text-preview__title",id:"modal-title",title:e.unref(u).modal.data.item.path},e.toDisplayString(e.unref(u).modal.data.item.basename),9,lo),e.createElementVNode("div",ao,[c.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:f,class:"vuefinder__text-preview__save-button"},e.toDisplayString(e.unref(s)("Save")),1)):e.createCommentVNode("",!0),e.unref(u).features.includes(e.unref(H).EDIT)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"vuefinder__text-preview__edit-button",onClick:b[0]||(b[0]=g=>a())},e.toDisplayString(c.value?e.unref(s)("Cancel"):e.unref(s)("Edit")),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",null,[c.value?(e.openBlock(),e.createElementBlock("div",io,[e.withDirectives(e.createElementVNode("textarea",{ref_key:"editInput",ref:m,"onUpdate:modelValue":b[1]||(b[1]=g=>r.value=g),class:"vuefinder__text-preview__textarea",name:"text",cols:"30",rows:"10"},null,512),[[e.vModelText,r.value]])])):(e.openBlock(),e.createElementBlock("pre",so,e.toDisplayString(l.value),1)),d.value.length?(e.openBlock(),e.createBlock($e,{key:2,onHidden:b[2]||(b[2]=g=>d.value=""),error:i.value},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(d.value),1)]),_:1},8,["error"])):e.createCommentVNode("",!0)])]))}}),uo=["src"],mo=e.defineComponent({__name:"CropperCanvas",props:{src:{},class:{}},setup(n,{expose:t}){const o=n,l=e.ref(null),r=e.ref(null),m=async()=>{if(!l.value)return;await e.nextTick();const d=new Image;d.crossOrigin="anonymous",d.src=o.src,await new Promise((u,s)=>{d.onload=()=>u(),d.onerror=()=>s(new Error("Image load failed"))});const i=l.value.getContext("2d");i&&(l.value.width=d.naturalWidth||d.width,l.value.height=d.naturalHeight||d.height,i.drawImage(d,0,0),r.value=new et(l.value,{}))};return e.onMounted(()=>{m().catch(()=>{})}),e.onBeforeUnmount(()=>{r.value&&(r.value.destroy(),r.value=null)}),e.watch(()=>o.src,()=>{r.value&&(r.value.destroy(),r.value=null),m().catch(()=>{})}),t({getCroppedBlob:d=>new Promise(i=>{if(!r.value)return i(null);const u=r.value.getCroppedCanvas?.(d);if(!u)return i(null);u.toBlob(s=>i(s))})}),(d,i)=>(e.openBlock(),e.createElementBlock("cropper-canvas",{background:"",ref_key:"canvasEl",ref:l,class:e.normalizeClass(o.class)},[e.createElementVNode("cropper-image",{src:n.src,alt:"Picture",style:{width:"100%"},rotatable:"",scalable:"",skewable:"",translatable:""},null,8,uo),i[0]||(i[0]=e.createElementVNode("cropper-shade",{hidden:""},null,-1)),i[1]||(i[1]=e.createElementVNode("cropper-handle",{action:"select",plain:""},null,-1)),i[2]||(i[2]=e.createElementVNode("cropper-selection",{"initial-coverage":"0.5",movable:"",resizable:""},[e.createElementVNode("cropper-grid",{role:"grid",covered:""}),e.createElementVNode("cropper-crosshair",{centered:""}),e.createElementVNode("cropper-handle",{action:"move","theme-color":"rgba(255, 255, 255, 0.35)"}),e.createElementVNode("cropper-handle",{action:"n-resize"}),e.createElementVNode("cropper-handle",{action:"e-resize"}),e.createElementVNode("cropper-handle",{action:"s-resize"}),e.createElementVNode("cropper-handle",{action:"w-resize"}),e.createElementVNode("cropper-handle",{action:"ne-resize"}),e.createElementVNode("cropper-handle",{action:"nw-resize"}),e.createElementVNode("cropper-handle",{action:"se-resize"}),e.createElementVNode("cropper-handle",{action:"sw-resize"})],-1))],2))}}),fo={class:"vuefinder__image-preview"},vo={class:"vuefinder__image-preview__header"},_o=["title"],po={class:"vuefinder__image-preview__actions"},ho={class:"vuefinder__image-preview__image-container h-[50vh]"},go=["src"],ko=e.defineComponent({name:"ImagePreview",__name:"Image",emits:["success"],setup(n,{emit:t}){const o=t,l=e.inject("ServiceContainer"),{t:r}=l.i18n,m=e.ref(null),c=e.ref(!1),d=e.ref(""),i=e.ref(!1),u=()=>{c.value=!c.value},s=()=>{m.value?.getCroppedBlob({width:795,height:341}).then(a=>{if(!a)return;d.value="",i.value=!1;const f=new FormData;f.set("file",a),l.requester.send({url:"",method:"post",params:{q:"upload",storage:l.modal.data.storage,path:l.modal.data.item.path},body:f}).then(()=>{d.value=r("Updated."),u(),o("success")}).catch(v=>{const b=v?.message??"Error";d.value=r(b),i.value=!0})})};return e.onMounted(()=>{o("success")}),(a,f)=>(e.openBlock(),e.createElementBlock("div",fo,[e.createElementVNode("div",vo,[e.createElementVNode("h3",{class:"vuefinder__image-preview__title",id:"modal-title",title:e.unref(l).modal.data.item.path},e.toDisplayString(e.unref(l).modal.data.item.basename),9,_o),e.createElementVNode("div",po,[c.value?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:s,class:"vuefinder__image-preview__crop-button"},e.toDisplayString(e.unref(r)("Crop")),1)):e.createCommentVNode("",!0),e.unref(l).features.includes(e.unref(H).EDIT)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"vuefinder__image-preview__edit-button",onClick:f[0]||(f[0]=v=>u())},e.toDisplayString(c.value?e.unref(r)("Cancel"):e.unref(r)("Edit")),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("div",ho,[c.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("img",{key:0,class:"vuefinder__image-preview__image w-full h-full object-contain",src:e.unref(l).requester.getPreviewUrl(e.unref(l).modal.data.storage,e.unref(l).modal.data.item),alt:""},null,8,go)),c.value?(e.openBlock(),e.createBlock(mo,{key:1,ref_key:"cropperRef",ref:m,src:e.unref(l).requester.getPreviewUrl(e.unref(l).modal.data.storage,e.unref(l).modal.data.item),class:"vuefinder__image-preview__image w-full h-full"},null,8,["src"])):e.createCommentVNode("",!0)]),d.value.length?(e.openBlock(),e.createBlock(e.unref(d),{key:0,onHidden:f[1]||(f[1]=v=>d.value=""),error:i.value},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(d.value),1)]),_:1},8,["error"])):e.createCommentVNode("",!0)]))}}),wo={class:"vuefinder__default-preview"},Eo={class:"vuefinder__default-preview__header"},yo=["title"],bo=e.defineComponent({__name:"Default",emits:["success"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),l=t;return e.onMounted(()=>{l("success")}),(r,m)=>(e.openBlock(),e.createElementBlock("div",wo,[e.createElementVNode("div",Eo,[e.createElementVNode("h3",{class:"vuefinder__default-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,yo)]),m[0]||(m[0]=e.createElementVNode("div",null,null,-1))]))}}),Vo={class:"vuefinder__video-preview"},No=["title"],So={class:"vuefinder__video-preview__video",preload:"metadata",controls:""},Bo=["src"],xo=e.defineComponent({__name:"Video",emits:["success"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),l=t,r=()=>o.requester.getPreviewUrl(o.modal.data.storage,o.modal.data.item);return e.onMounted(()=>{l("success")}),(m,c)=>(e.openBlock(),e.createElementBlock("div",Vo,[e.createElementVNode("h3",{class:"vuefinder__video-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,No),e.createElementVNode("div",null,[e.createElementVNode("video",So,[e.createElementVNode("source",{src:r(),type:"video/mp4"},null,8,Bo),c[0]||(c[0]=e.createTextVNode(" Your browser does not support the video tag. ",-1))])])]))}}),Co={class:"vuefinder__audio-preview"},$o=["title"],Do={class:"vuefinder__audio-preview__audio",controls:""},To=["src"],Mo=e.defineComponent({__name:"Audio",emits:["success"],setup(n,{emit:t}){const o=t,l=e.inject("ServiceContainer"),r=()=>l.requester.getPreviewUrl(l.modal.data.storage,l.modal.data.item);return e.onMounted(()=>{o("success")}),(m,c)=>(e.openBlock(),e.createElementBlock("div",Co,[e.createElementVNode("h3",{class:"vuefinder__audio-preview__title",id:"modal-title",title:e.unref(l).modal.data.item.path},e.toDisplayString(e.unref(l).modal.data.item.basename),9,$o),e.createElementVNode("div",null,[e.createElementVNode("audio",Do,[e.createElementVNode("source",{src:r(),type:"audio/mpeg"},null,8,To),c[0]||(c[0]=e.createTextVNode(" Your browser does not support the audio element. ",-1))])])]))}}),Ao={class:"vuefinder__pdf-preview"},Fo=["title"],Io=["data"],Lo=["src"],Ro=e.defineComponent({__name:"Pdf",emits:["success"],setup(n,{emit:t}){const o=e.inject("ServiceContainer"),l=t,r=()=>o.requester.getPreviewUrl(o.modal.data.storage,o.modal.data.item);return e.onMounted(()=>{l("success")}),(m,c)=>(e.openBlock(),e.createElementBlock("div",Ao,[e.createElementVNode("h3",{class:"vuefinder__pdf-preview__title",id:"modal-title",title:e.unref(o).modal.data.item.path},e.toDisplayString(e.unref(o).modal.data.item.basename),9,Fo),e.createElementVNode("div",null,[e.createElementVNode("object",{class:"vuefinder__pdf-preview__object",data:r(),type:"application/pdf",width:"100%",height:"100%"},[e.createElementVNode("iframe",{class:"vuefinder__pdf-preview__iframe",src:r(),width:"100%",height:"100%"}," Your browser does not support PDFs ",8,Lo)],8,Io)])]))}});function zo(n,t=null){return new Date(n*1e3).toLocaleString(t??navigator.language??"en-US")}const qo={class:"vuefinder__preview-modal__content"},Ho={key:0},Po={class:"vuefinder__preview-modal__loading"},jo={key:0,class:"vuefinder__preview-modal__loading-indicator"},Uo={class:"vuefinder__preview-modal__details"},Oo={class:"font-bold"},Ko={class:"font-bold pl-2"},Go={key:0,class:"vuefinder__preview-modal__note"},Yo=["download","href"],De=e.defineComponent({__name:"ModalPreview",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=e.ref(!1),r=c=>(t.modal.data.item.mime_type??"").startsWith(c),m=t.features.includes(H.PREVIEW);return m||(l.value=!0),(c,d)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:d[6]||(d[6]=i=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Close")),1),e.unref(t).features.includes(e.unref(H).DOWNLOAD)?(e.openBlock(),e.createElementBlock("a",{key:0,target:"_blank",class:"vf-btn vf-btn-primary",download:e.unref(t).requester.getDownloadUrl(e.unref(t).modal.data.storage,e.unref(t).modal.data.item),href:e.unref(t).requester.getDownloadUrl(e.unref(t).modal.data.storage,e.unref(t).modal.data.item)},e.toDisplayString(e.unref(o)("Download")),9,Yo)):e.createCommentVNode("",!0)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createElementVNode("div",qo,[e.unref(m)?(e.openBlock(),e.createElementBlock("div",Ho,[r("text")?(e.openBlock(),e.createBlock(co,{key:0,onSuccess:d[0]||(d[0]=i=>l.value=!0)})):r("image")?(e.openBlock(),e.createBlock(ko,{key:1,onSuccess:d[1]||(d[1]=i=>l.value=!0)})):r("video")?(e.openBlock(),e.createBlock(xo,{key:2,onSuccess:d[2]||(d[2]=i=>l.value=!0)})):r("audio")?(e.openBlock(),e.createBlock(Mo,{key:3,onSuccess:d[3]||(d[3]=i=>l.value=!0)})):r("application/pdf")?(e.openBlock(),e.createBlock(Ro,{key:4,onSuccess:d[4]||(d[4]=i=>l.value=!0)})):(e.openBlock(),e.createBlock(bo,{key:5,onSuccess:d[5]||(d[5]=i=>l.value=!0)}))])):e.createCommentVNode("",!0),e.createElementVNode("div",Po,[l.value===!1?(e.openBlock(),e.createElementBlock("div",jo,[d[7]||(d[7]=e.createElementVNode("svg",{class:"vuefinder__preview-modal__spinner",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e.createElementVNode("circle",{class:"vuefinder__preview-modal__spinner-circle",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e.createElementVNode("path",{class:"vuefinder__preview-modal__spinner-path",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e.createElementVNode("span",null,e.toDisplayString(e.unref(o)("Loading")),1)])):e.createCommentVNode("",!0)])])]),e.createElementVNode("div",Uo,[e.createElementVNode("div",null,[e.createElementVNode("span",Oo,e.toDisplayString(e.unref(o)("File Size"))+": ",1),e.createTextVNode(e.toDisplayString(e.unref(t).filesize(e.unref(t).modal.data.item.file_size)),1)]),e.createElementVNode("div",null,[e.createElementVNode("span",Ko,e.toDisplayString(e.unref(o)("Last Modified"))+": ",1),e.createTextVNode(" "+e.toDisplayString(e.unref(zo)(e.unref(t).modal.data.item.last_modified)),1)])]),e.unref(t).features.includes(e.unref(H).DOWNLOAD)?(e.openBlock(),e.createElementBlock("div",Go,[e.createElementVNode("span",null,e.toDisplayString(e.unref(o)(`Download doesn't work? You can try right-click "Download" button, select "Save link as...".`)),1)])):e.createCommentVNode("",!0)]),_:1}))}}),Wo={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true",class:"h-6 w-6 stroke-blue-600 dark:stroke-blue-100",viewBox:"0 0 24 24"};function Qo(n,t){return e.openBlock(),e.createElementBlock("svg",Wo,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3"},null,-1)])])}const Xo={render:Qo},Jo={class:"vuefinder__move-modal__content"},Zo={class:"vuefinder__move-modal__description"},er={class:"vuefinder__move-modal__files vf-scrollbar"},tr={key:0,class:"vuefinder__move-modal__icon vuefinder__move-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},nr={key:1,class:"vuefinder__move-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},or={class:"vuefinder__move-modal__file-name"},rr={class:"vuefinder__move-modal__target-title"},lr={class:"vuefinder__move-modal__target-directory"},ar={class:"vuefinder__move-modal__target-path"},sr={class:"vuefinder__move-modal__selected-items"},Te=e.defineComponent({__name:"ModalTransfer",props:{q:{},title:{},body:{},successBtn:{},successText:{}},setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=A.useStore(l.path),m=n,c=e.ref(t.modal.data.items.from),d=t.modal.data.items.to,i=e.ref("");console.log(d.value.path);const u=()=>{c.value.length&&t.emitter.emit("vf-fetch",{params:{q:m.q,m:"post",storage:r.value.storage,path:r.value.path},body:{items:c.value.map(({path:s,type:a})=>({path:s,type:a})),item:d.value.path},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:m.successText})},onError:s=>{i.value=o(s.message)}})};return(s,a)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:u,class:"vf-btn vf-btn-primary"},e.toDisplayString(m.successBtn),1),e.createElementVNode("button",{type:"button",onClick:a[1]||(a[1]=f=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1),e.createElementVNode("div",sr,e.toDisplayString(e.unref(o)("%s item(s) selected.",c.value.size)),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(Xo),title:m.title},null,8,["icon","title"]),e.createElementVNode("div",Jo,[e.createElementVNode("p",Zo,e.toDisplayString(m.body),1),e.createElementVNode("div",er,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,f=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__move-modal__file",key:f.path},[e.createElementVNode("div",null,[f.type==="dir"?(e.openBlock(),e.createElementBlock("svg",tr,[...a[2]||(a[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",nr,[...a[3]||(a[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])]))]),e.createElementVNode("div",or,e.toDisplayString(f.path),1)]))),128))]),e.createElementVNode("h4",rr,e.toDisplayString(e.unref(o)("Target Directory")),1),e.createElementVNode("p",lr,[a[4]||(a[4]=e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"vuefinder__move-modal__icon vuefinder__move-modal__icon--dir",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),e.createElementVNode("span",ar,e.toDisplayString(e.unref(d).value.path),1)]),i.value.length?(e.openBlock(),e.createBlock(e.unref(i),{key:0,onHidden:a[0]||(a[0]=f=>i.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(i.value),1)]),_:1})):e.createCommentVNode("",!0)])])]),_:1}))}}),Me=e.defineComponent({__name:"ModalMove",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n;return(l,r)=>(e.openBlock(),e.createBlock(Te,{q:"move",title:e.unref(o)("Move files"),body:e.unref(o)("Are you sure you want to move these files"),"success-btn":e.unref(o)("Yes, Move!"),"success-text":e.unref(o)("Files moved.")},null,8,["title","body","success-btn","success-text"]))}}),ir=e.defineComponent({__name:"ModalCopy",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n;return(l,r)=>(e.openBlock(),e.createBlock(Te,{q:"copy",title:e.unref(o)("Copy files"),body:e.unref(o)("Are you sure you want to copy these files"),"success-btn":e.unref(o)("Yes, Copy!"),"success-text":e.unref(o)("Files copied.")},null,8,["title","body","success-btn","success-text"]))}}),J={ESCAPE:"Escape",F2:"F2",F5:"F5",DELETE:"Delete",ENTER:"Enter",BACKSLASH:"Backslash",KEY_A:"KeyA",KEY_E:"KeyE",KEY_F:"KeyF",SPACE:"Space",KEY_C:"KeyC",KEY_X:"KeyX",KEY_V:"KeyV"};function cr(n){const t=n.search,o=n.fs,l=n.config,r=A.useStore(t.state),m=A.useStore(o.selectedItems),c=d=>{if(d.code===J.ESCAPE&&(n.modal.close(),n.root.focus()),!n.modal.visible&&!r.value?.searchMode){if(d.code===J.F2&&n.features.includes(H.RENAME)&&m.value.length===1&&n.modal.open(we,{items:m.value}),d.code===J.F5&&n.emitter.emit("vf-fetch",{params:{q:"index",storage:o.path.get().storage,path:o.path.get().path}}),d.code===J.DELETE&&m.value.length===0&&n.modal.open(ke,{items:m.value}),d.ctrlKey&&d.code===J.BACKSLASH&&n.modal.open(Be),d.ctrlKey&&d.code===J.KEY_F&&n.features.includes(H.SEARCH)&&(t.enterSearchMode(),d.preventDefault()),d.ctrlKey&&d.code===J.KEY_E&&(l.toggle("showTreeView"),d.preventDefault()),d.ctrlKey&&d.code===J.ENTER&&(l.toggle("fullScreen"),n.root.focus()),d.ctrlKey&&d.code===J.KEY_A&&(o.selectAll(),d.preventDefault()),d.code===J.SPACE&&m.value.length===1&&m.value[0]?.type!=="dir"&&n.modal.open(De,{storage:o.path.get().storage,item:m.value[0]}),d.metaKey&&d.code===J.KEY_C){if(m.value.length===0){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("No items selected")});return}o.setClipboard("copy",new Set(m.value.map(i=>i.path))),n.emitter.emit("vf-toast-push",{label:m.value.length===1?n.i18n.t("Item copied to clipboard"):n.i18n.t("%s items copied to clipboard",m.value.length)}),d.preventDefault()}if(d.metaKey&&d.code===J.KEY_X){if(m.value.length===0){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("No items selected")});return}o.setClipboard("cut",new Set(m.value.map(i=>i.path))),n.emitter.emit("vf-toast-push",{label:m.value.length===1?n.i18n.t("Item cut to clipboard"):n.i18n.t("%s items cut to clipboard",m.value.length)}),d.preventDefault()}if(d.metaKey&&d.code===J.KEY_V){if(o.getClipboard().items.size===0){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("No items in clipboard")});return}if(o.getClipboard().path===o.path.get().path){n.emitter.emit("vf-toast-push",{type:"error",label:n.i18n.t("Cannot paste items to the same directory")});return}if(o.getClipboard().type==="cut"){n.modal.open(Me,{items:{from:o.getClipboard().items,to:o.path}}),o.clearClipboard();return}if(o.getClipboard().type==="copy"){n.modal.open(ir,{items:{from:o.getClipboard().items,to:o.path}});return}d.preventDefault()}}};e.onMounted(()=>{n.root.addEventListener("keydown",c)}),e.onBeforeUnmount(()=>{n.root.removeEventListener("keydown",c)})}const dr={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function ur(n,t){return e.openBlock(),e.createElementBlock("svg",dr,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44z"},null,-1)])])}const Ae={render:ur},mr={class:"vuefinder__new-folder-modal__content"},fr={class:"vuefinder__new-folder-modal__form"},vr={class:"vuefinder__new-folder-modal__description"},_r=["placeholder"],Fe=e.defineComponent({__name:"ModalNewFolder",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=A.useStore(l.path),m=e.ref(""),c=e.ref(""),d=()=>{m.value!==""&&t.emitter.emit("vf-fetch",{params:{q:"newfolder",m:"post",storage:r.value.storage,path:r.value.path},body:{name:m.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("%s is created.",m.value)})},onError:i=>{c.value=o(i.message)}})};return(i,u)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:d,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Create")),1),e.createElementVNode("button",{type:"button",onClick:u[2]||(u[2]=s=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(Ae),title:e.unref(o)("New Folder")},null,8,["icon","title"]),e.createElementVNode("div",mr,[e.createElementVNode("div",fr,[e.createElementVNode("p",vr,e.toDisplayString(e.unref(o)("Create a new folder")),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":u[0]||(u[0]=s=>m.value=s),onKeyup:e.withKeys(d,["enter"]),class:"vuefinder__new-folder-modal__input",placeholder:e.unref(o)("Folder Name"),type:"text"},null,40,_r),[[e.vModelText,m.value]]),c.value.length?(e.openBlock(),e.createBlock(e.unref(c),{key:0,onHidden:u[1]||(u[1]=s=>c.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),pr={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function hr(n,t){return e.openBlock(),e.createElementBlock("svg",pr,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9"},null,-1)])])}const Ie={render:hr},gr={class:"vuefinder__new-file-modal__content"},kr={class:"vuefinder__new-file-modal__form"},wr={class:"vuefinder__new-file-modal__description"},Er=["placeholder"],yr=e.defineComponent({__name:"ModalNewFile",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=A.useStore(l.path),m=e.ref(""),c=e.ref(""),d=()=>{m.value!==""&&t.emitter.emit("vf-fetch",{params:{q:"newfile",m:"post",storage:r.value.storage,path:r.value.path},body:{name:m.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("%s is created.",m.value)})},onError:i=>{c.value=o(i.message)}})};return(i,u)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:d,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Create")),1),e.createElementVNode("button",{type:"button",onClick:u[2]||(u[2]=s=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(Ie),title:e.unref(o)("New File")},null,8,["icon","title"]),e.createElementVNode("div",gr,[e.createElementVNode("div",kr,[e.createElementVNode("p",wr,e.toDisplayString(e.unref(o)("Create a new file")),1),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":u[0]||(u[0]=s=>m.value=s),onKeyup:e.withKeys(d,["enter"]),class:"vuefinder__new-file-modal__input",placeholder:e.unref(o)("File Name"),type:"text"},null,40,Er),[[e.vModelText,m.value]]),c.value.length?(e.openBlock(),e.createBlock(e.unref(c),{key:0,onHidden:u[1]||(u[1]=s=>c.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),G={PENDING:0,CANCELED:1,UPLOADING:2,ERROR:3,DONE:10};function br(){const n=e.inject("ServiceContainer"),{t}=n.i18n,o=n.fs,l=n.config,r=e.ref({QUEUE_ENTRY_STATUS:G}),m=e.ref(null),c=e.ref(null),d=e.ref(null),i=e.ref(null),u=e.ref(null),s=e.ref(null),a=e.ref([]),f=e.ref(""),v=e.ref(!1),b=e.ref(!1);let g;const k=F=>a.value.findIndex(O=>O.id===F),h=(F,O)=>g.addFile({name:O||F.name,type:F.type,data:F,source:"Local"}),w=F=>F.status===G.DONE?"text-green-600":F.status===G.ERROR||F.status===G.CANCELED?"text-red-600":"",N=F=>F.status===G.DONE?"✓":F.status===G.ERROR||F.status===G.CANCELED?"!":"...",M=()=>i.value?.click(),z=()=>n.modal.close(),j=()=>{if(v.value||!a.value.filter(F=>F.status!==G.DONE).length){v.value||(f.value=t("Please select file to upload first."));return}f.value="",g.retryAll(),g.upload()},C=()=>{g.cancelAll(),a.value.forEach(F=>{F.status!==G.DONE&&(F.status=G.CANCELED,F.statusName=t("Canceled"))}),v.value=!1},B=F=>{v.value||(g.removeFile(F.id),a.value.splice(k(F.id),1))},U=F=>{if(!v.value)if(g.cancelAll(),F){const O=a.value.filter(S=>S.status!==G.DONE);a.value=[],O.forEach(S=>h(S.originalFile,S.name))}else a.value=[]};return e.onMounted(()=>{g=new tt({debug:n.debug,restrictions:{maxFileSize:mt(l.maxFileSize??"10mb")},locale:n.i18n.t("uppy"),onBeforeFileAdded:(S,p)=>{if(p[S.id]!=null){const I=k(S.id);a.value[I]?.status===G.PENDING&&(f.value=g.i18n("noDuplicates",{fileName:S.name})),a.value=a.value.filter(L=>L.id!==S.id)}return a.value.push({id:S.id,name:S.name,size:n.filesize(S.size),status:G.PENDING,statusName:t("Pending upload"),percent:null,originalFile:S.data}),!0}}),g.use(nt,{endpoint:"WILL_BE_REPLACED_BEFORE_UPLOAD",limit:5,timeout:0}),g.on("restriction-failed",(S,p)=>{const E=a.value[k(S.id)];E&&B(E),f.value=p.message}),g.on("upload",()=>{const S=n.requester.transformRequestParams({url:"",method:"post",params:{q:"upload",storage:o.path.storage,path:o.path.path}});g.setMeta({...S.body});const p=g.getPlugin("XHRUpload");p&&(p.opts.method=S.method,p.opts.endpoint=S.url+"?"+new URLSearchParams(S.params),p.opts.headers=S.headers),delete S.headers["Content-Type"],v.value=!0,a.value.forEach(E=>{E.status!==G.DONE&&(E.percent=null,E.status=G.UPLOADING,E.statusName=t("Pending upload"))})}),g.on("upload-progress",(S,p)=>{const E=p.bytesTotal??1,I=Math.floor(p.bytesUploaded/E*100),L=k(S.id);L!==-1&&a.value[L]&&(a.value[L].percent=`${I}%`)}),g.on("upload-success",S=>{const p=a.value[k(S.id)];p&&(p.status=G.DONE,p.statusName=t("Done"))}),g.on("upload-error",(S,p)=>{const E=a.value[k(S.id)];E&&(E.percent=null,E.status=G.ERROR,E.statusName=p?.isNetworkError?t("Network Error, Unable establish connection to the server or interrupted."):p?.message||t("Unknown Error"))}),g.on("error",S=>{f.value=S.message,v.value=!1,n.emitter.emit("vf-fetch",{params:{q:"index"},noCloseModal:!0})}),g.on("complete",()=>{v.value=!1,n.emitter.emit("vf-fetch",{params:{q:"index"},noCloseModal:!0})}),i.value?.addEventListener("click",()=>c.value?.click()),u.value?.addEventListener("click",()=>d.value?.click()),s.value?.addEventListener("dragover",S=>{S.preventDefault(),b.value=!0}),s.value?.addEventListener("dragleave",S=>{S.preventDefault(),b.value=!1});const F=(S,p)=>{p.isFile&&p.file(E=>S(p,E)),p.isDirectory&&p.createReader().readEntries(E=>E.forEach(I=>F(S,I)))};s.value?.addEventListener("drop",S=>{S.preventDefault(),b.value=!1;const p=/^[/\\](.+)/,E=S.dataTransfer?.items;E&&Array.from(E).forEach(I=>{I.kind==="file"&&F((L,R)=>{const q=p.exec(L.fullPath);h(R,q?q[1]:R.name)},I.webkitGetAsEntry())})});const O=S=>{const p=S.target,E=p.files;if(E){for(const I of E)h(I);p.value=""}};c.value?.addEventListener("change",O),d.value?.addEventListener("change",O)}),{container:m,internalFileInput:c,internalFolderInput:d,pickFiles:i,pickFolders:u,dropArea:s,queue:a,message:f,uploading:v,hasFilesInDropArea:b,definitions:r,openFileSelector:M,upload:j,cancel:C,remove:B,clear:U,close:z,getClassNameForEntry:w,getIconForEntry:N}}function he(n,t=14){const o=`((?=([\\w\\W]{0,${t}}))([\\w\\W]{${t+1},})([\\w\\W]{8,}))`;return n.replace(new RegExp(o),"$2..$4")}const Vr={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function Nr(n,t){return e.openBlock(),e.createElementBlock("svg",Vr,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"},null,-1)])])}const Le={render:Nr},Sr={class:"vuefinder__upload-modal__content"},Br={key:0,class:"pointer-events-none"},xr={key:1,class:"pointer-events-none"},Cr=["disabled"],$r=["disabled"],Dr={class:"vuefinder__upload-modal__file-list vf-scrollbar"},Tr=["textContent"],Mr={class:"vuefinder__upload-modal__file-info"},Ar={class:"vuefinder__upload-modal__file-name hidden md:block"},Fr={class:"vuefinder__upload-modal__file-name md:hidden"},Ir={key:0,class:"ml-auto"},Lr=["title","disabled","onClick"],Rr={key:0,class:"py-2"},zr=["disabled"],qr=e.defineComponent({__name:"ModalUpload",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,{container:l,internalFileInput:r,internalFolderInput:m,pickFiles:c,pickFolders:d,dropArea:i,queue:u,message:s,uploading:a,hasFilesInDropArea:f,definitions:v,openFileSelector:b,upload:g,cancel:k,remove:h,clear:w,close:N,getClassNameForEntry:M,getIconForEntry:z}=br();return(j,C)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-primary",disabled:e.unref(a),onClick:C[4]||(C[4]=e.withModifiers((...B)=>e.unref(g)&&e.unref(g)(...B),["prevent"]))},e.toDisplayString(e.unref(o)("Upload")),9,zr),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",class:"vf-btn vf-btn-secondary",onClick:C[5]||(C[5]=e.withModifiers((...B)=>e.unref(k)&&e.unref(k)(...B),["prevent"]))},e.toDisplayString(e.unref(o)("Cancel")),1)):(e.openBlock(),e.createElementBlock("button",{key:1,type:"button",class:"vf-btn vf-btn-secondary",onClick:C[6]||(C[6]=e.withModifiers((...B)=>e.unref(N)&&e.unref(N)(...B),["prevent"]))},e.toDisplayString(e.unref(o)("Close")),1))]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(Le),title:e.unref(o)("Upload Files")},null,8,["icon","title"]),e.createElementVNode("div",Sr,[e.createElementVNode("div",{class:"vuefinder__upload-modal__drop-area",ref_key:"dropArea",ref:i,onClick:C[0]||(C[0]=(...B)=>e.unref(b)&&e.unref(b)(...B))},[e.unref(f)?(e.openBlock(),e.createElementBlock("div",Br,e.toDisplayString(e.unref(o)("Release to drop these files.")),1)):(e.openBlock(),e.createElementBlock("div",xr,e.toDisplayString(e.unref(o)("Drag and drop the files/folders to here or click here.")),1))],512),e.createElementVNode("div",{ref_key:"container",ref:l,class:"vuefinder__upload-modal__buttons"},[e.createElementVNode("button",{ref_key:"pickFiles",ref:c,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Select Files")),513),e.createElementVNode("button",{ref_key:"pickFolders",ref:d,type:"button",class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Select Folders")),513),e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-secondary",disabled:e.unref(a),onClick:C[1]||(C[1]=B=>e.unref(w)(!1))},e.toDisplayString(e.unref(o)("Clear all")),9,Cr),e.createElementVNode("button",{type:"button",class:"vf-btn vf-btn-secondary",disabled:e.unref(a),onClick:C[2]||(C[2]=B=>e.unref(w)(!0))},e.toDisplayString(e.unref(o)("Clear only successful")),9,$r)],512),e.createElementVNode("div",Dr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),B=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__upload-modal__file-entry",key:B.id},[e.createElementVNode("span",{class:e.normalizeClass(["vuefinder__upload-modal__file-icon",e.unref(M)(B)])},[e.createElementVNode("span",{class:"vuefinder__upload-modal__file-icon-text",textContent:e.toDisplayString(e.unref(z)(B))},null,8,Tr)],2),e.createElementVNode("div",Mr,[e.createElementVNode("div",Ar,e.toDisplayString(e.unref(he)(B.name,40))+" ("+e.toDisplayString(B.size)+") ",1),e.createElementVNode("div",Fr,e.toDisplayString(e.unref(he)(B.name,16))+" ("+e.toDisplayString(B.size)+") ",1),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__upload-modal__file-status",e.unref(M)(B)])},[e.createTextVNode(e.toDisplayString(B.statusName)+" ",1),B.status===e.unref(v).QUEUE_ENTRY_STATUS.UPLOADING?(e.openBlock(),e.createElementBlock("b",Ir,e.toDisplayString(B.percent),1)):e.createCommentVNode("",!0)],2)]),e.createElementVNode("button",{type:"button",class:e.normalizeClass(["vuefinder__upload-modal__file-remove",e.unref(a)?"disabled":""]),title:e.unref(o)("Delete"),disabled:e.unref(a),onClick:U=>e.unref(h)(B)},[...C[7]||(C[7]=[e.createElementVNode("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"vuefinder__upload-modal__file-remove-icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])],10,Lr)]))),128)),e.unref(u).length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Rr,e.toDisplayString(e.unref(o)("No files selected!")),1))]),e.unref(s).length?(e.openBlock(),e.createBlock($e,{key:0,onHidden:C[3]||(C[3]=B=>s.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(s)),1)]),_:1})):e.createCommentVNode("",!0)])]),e.createElementVNode("input",{ref_key:"internalFileInput",ref:r,type:"file",multiple:"",class:"hidden"},null,512),e.createElementVNode("input",{ref_key:"internalFolderInput",ref:m,type:"file",multiple:"",webkitdirectory:"",class:"hidden"},null,512)]),_:1}))}}),Hr={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Pr(n,t){return e.openBlock(),e.createElementBlock("svg",Hr,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m6 4.125 2.25 2.25m0 0 2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125"},null,-1)])])}const Re={render:Pr},jr={class:"vuefinder__unarchive-modal__content"},Ur={class:"vuefinder__unarchive-modal__items"},Or={key:0,class:"vuefinder__unarchive-modal__icon vuefinder__unarchive-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},Kr={key:1,class:"vuefinder__unarchive-modal__icon vuefinder__unarchive-modal__icon--file",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},Gr={class:"vuefinder__unarchive-modal__item-name"},Yr={class:"vuefinder__unarchive-modal__info"},ze=e.defineComponent({__name:"ModalUnarchive",setup(n){const t=e.inject("ServiceContainer"),o=t.fs,l=A.useStore(o.path),{t:r}=t.i18n,m=e.ref(t.modal.data.items[0]),c=e.ref(""),d=e.ref([]),i=()=>{t.emitter.emit("vf-fetch",{params:{q:"unarchive",m:"post",storage:l.value.storage,path:l.value.path},body:{item:m.value.path},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:r("The file unarchived.")})},onError:u=>{c.value=r(u.message)}})};return(u,s)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:i,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(r)("Unarchive")),1),e.createElementVNode("button",{type:"button",onClick:s[1]||(s[1]=a=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(r)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(Re),title:e.unref(r)("Unarchive")},null,8,["icon","title"]),e.createElementVNode("div",jr,[e.createElementVNode("div",Ur,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,a=>(e.openBlock(),e.createElementBlock("p",{class:"vuefinder__unarchive-modal__item",key:a.path},[a.type==="dir"?(e.openBlock(),e.createElementBlock("svg",Or,[...s[2]||(s[2]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",Kr,[...s[3]||(s[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",Gr,e.toDisplayString(a.basename),1)]))),128)),e.createElementVNode("p",Yr,e.toDisplayString(e.unref(r)("The archive will be unarchived at"))+" ("+e.toDisplayString(e.unref(o).path.path)+")",1),c.value.length?(e.openBlock(),e.createBlock(e.unref(c),{key:0,onHidden:s[0]||(s[0]=a=>c.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),Wr={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function Qr(n,t){return e.openBlock(),e.createElementBlock("svg",Wr,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125"},null,-1)])])}const qe={render:Qr},Xr={class:"vuefinder__archive-modal__content"},Jr={class:"vuefinder__archive-modal__form"},Zr={class:"vuefinder__archive-modal__files vf-scrollbar"},el={class:"vuefinder__archive-modal__file"},tl={key:0,class:"vuefinder__archive-modal__icon vuefinder__archive-modal__icon--dir",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},nl={key:1,class:"vuefinder__archive-modal__icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},ol={class:"vuefinder__archive-modal__file-name"},rl=["placeholder"],He=e.defineComponent({__name:"ModalArchive",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=A.useStore(l.path),m=e.ref(""),c=e.ref(""),d=e.ref(t.modal.data.items),i=()=>{d.value.length&&t.emitter.emit("vf-fetch",{params:{q:"archive",m:"post",storage:r.value.storage,path:r.value.path},body:{items:d.value.map(({path:u,type:s})=>({path:u,type:s})),name:m.value},onSuccess:()=>{t.emitter.emit("vf-toast-push",{label:o("The file(s) archived.")})},onError:u=>{c.value=o(u.message)}})};return(u,s)=>(e.openBlock(),e.createBlock(Z,null,{buttons:e.withCtx(()=>[e.createElementVNode("button",{type:"button",onClick:i,class:"vf-btn vf-btn-primary"},e.toDisplayString(e.unref(o)("Archive")),1),e.createElementVNode("button",{type:"button",onClick:s[2]||(s[2]=a=>e.unref(t).modal.close()),class:"vf-btn vf-btn-secondary"},e.toDisplayString(e.unref(o)("Cancel")),1)]),default:e.withCtx(()=>[e.createElementVNode("div",null,[e.createVNode(te,{icon:e.unref(qe),title:e.unref(o)("Archive the files")},null,8,["icon","title"]),e.createElementVNode("div",Xr,[e.createElementVNode("div",Jr,[e.createElementVNode("div",Zr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,a=>(e.openBlock(),e.createElementBlock("p",el,[a.type==="dir"?(e.openBlock(),e.createElementBlock("svg",tl,[...s[3]||(s[3]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},null,-1)])])):(e.openBlock(),e.createElementBlock("svg",nl,[...s[4]||(s[4]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])])),e.createElementVNode("span",ol,e.toDisplayString(a.basename),1)]))),256))]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a),onKeyup:e.withKeys(i,["enter"]),class:"vuefinder__archive-modal__input",placeholder:e.unref(o)("Archive name. (.zip file will be created)"),type:"text"},null,40,rl),[[e.vModelText,m.value]]),c.value.length?(e.openBlock(),e.createBlock(e.unref(c),{key:0,onHidden:s[1]||(s[1]=a=>c.value=""),error:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(c.value),1)]),_:1})):e.createCommentVNode("",!0)])])])]),_:1}))}}),ll={xmlns:"http://www.w3.org/2000/svg",fill:"none",class:"animate-spin p-0.5 h-5 w-5 text-white ml-auto",viewBox:"0 0 24 24"};function al(n,t){return e.openBlock(),e.createElementBlock("svg",ll,[...t[0]||(t[0]=[e.createElementVNode("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25 stroke-blue-900 dark:stroke-blue-100"},null,-1),e.createElementVNode("path",{fill:"currentColor",d:"M4 12a8 8 0 0 1 8-8V0C5.373 0 0 5.373 0 12zm2 5.291A7.96 7.96 0 0 1 4 12H0c0 3.042 1.135 5.824 3 7.938z",class:"opacity-75"},null,-1)])])}const Ee={render:al},sl={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function il(n,t){return e.openBlock(),e.createElementBlock("svg",sl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"},null,-1)])])}const cl={render:il},dl={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto vf-toolbar-icon",viewBox:"0 0 24 24"};function ul(n,t){return e.openBlock(),e.createElementBlock("svg",dl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"},null,-1)])])}const ml={render:ul},fl={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function vl(n,t){return e.openBlock(),e.createElementBlock("svg",fl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25zm0 9.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18zM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25zm0 9.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18z"},null,-1)])])}const _l={render:vl},pl={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",class:"h-6 w-6 md:h-8 md:w-8 m-auto",viewBox:"0 0 24 24"};function hl(n,t){return e.openBlock(),e.createElementBlock("svg",pl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75"},null,-1)])])}const gl={render:hl},kl={class:"vuefinder__toolbar"},wl={key:0,class:"vuefinder__toolbar__actions"},El=["title"],yl=["title"],bl=["title"],Vl=["title"],Nl=["title"],Sl=["title"],Bl=["title"],xl={key:1,class:"vuefinder__toolbar__search-results"},Cl={class:"pl-2"},$l={class:"dark:bg-gray-700 bg-gray-200 text-xs px-2 py-1 rounded"},Dl={class:"vuefinder__toolbar__controls"},Tl=["title"],Ml=["title"],Al=e.defineComponent({__name:"Toolbar",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=t.config,m=t.search,c=A.useStore(r.state),d=A.useStore(m.state),i=A.useStore(l.selectedItems);e.watch(()=>c.value.fullScreen,()=>{if(c.value.fullScreen){const s=document.querySelector("body");s&&(s.style.overflow="hidden")}else{const s=document.querySelector("body");s&&(s.style.overflow="")}t.emitter.emit("vf-fullscreen-toggle")});const u=()=>{r.set("view",c.value.view==="list"?"grid":"list")};return(s,a)=>(e.openBlock(),e.createElementBlock("div",kl,[e.unref(d).query.length?(e.openBlock(),e.createElementBlock("div",xl,[e.createElementVNode("div",Cl,[e.createTextVNode(e.toDisplayString(e.unref(o)("Search results for"))+" ",1),e.createElementVNode("span",$l,e.toDisplayString(e.unref(d).query),1)]),e.unref(r).get("loadingIndicator")==="circular"&&e.unref(l).isLoading()?(e.openBlock(),e.createBlock(e.unref(Ee),{key:0})):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("div",wl,[e.unref(t).features.includes(e.unref(H).NEW_FOLDER)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mx-1.5",title:e.unref(o)("New Folder"),onClick:a[0]||(a[0]=f=>e.unref(t).modal.open(Fe,{items:e.unref(i)}))},[e.createVNode(e.unref(Ae))],8,El)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(H).NEW_FILE)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"mx-1.5",title:e.unref(o)("New File"),onClick:a[1]||(a[1]=f=>e.unref(t).modal.open(yr,{items:e.unref(i)}))},[e.createVNode(e.unref(Ie))],8,yl)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(H).RENAME)?(e.openBlock(),e.createElementBlock("div",{key:2,class:"mx-1.5",title:e.unref(o)("Rename"),onClick:a[2]||(a[2]=f=>e.unref(i).length!==1||e.unref(t).modal.open(we,{items:e.unref(i)}))},[e.createVNode(e.unref(Ce),{class:e.normalizeClass(e.unref(i).length===1?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,bl)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(H).DELETE)?(e.openBlock(),e.createElementBlock("div",{key:3,class:"mx-1.5",title:e.unref(o)("Delete"),onClick:a[3]||(a[3]=f=>!e.unref(i).length||e.unref(t).modal.open(ke,{items:e.unref(i)}))},[e.createVNode(e.unref(xe),{class:e.normalizeClass(e.unref(i).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Vl)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(H).UPLOAD)?(e.openBlock(),e.createElementBlock("div",{key:4,class:"mx-1.5",title:e.unref(o)("Upload"),onClick:a[4]||(a[4]=f=>e.unref(t).modal.open(qr,{items:e.unref(i)}))},[e.createVNode(e.unref(Le))],8,Nl)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(H).UNARCHIVE)&&e.unref(i).length===1&&e.unref(i)[0].mime_type==="application/zip"?(e.openBlock(),e.createElementBlock("div",{key:5,class:"mx-1.5",title:e.unref(o)("Unarchive"),onClick:a[5]||(a[5]=f=>!e.unref(i).length||e.unref(t).modal.open(ze,{items:e.unref(i)}))},[e.createVNode(e.unref(Re),{class:e.normalizeClass(e.unref(i).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Sl)):e.createCommentVNode("",!0),e.unref(t).features.includes(e.unref(H).ARCHIVE)?(e.openBlock(),e.createElementBlock("div",{key:6,class:"mx-1.5",title:e.unref(o)("Archive"),onClick:a[6]||(a[6]=f=>!e.unref(i).length||e.unref(t).modal.open(He,{items:e.unref(i)}))},[e.createVNode(e.unref(qe),{class:e.normalizeClass(e.unref(i).length?"vf-toolbar-icon":"vf-toolbar-icon-disabled")},null,8,["class"])],8,Bl)):e.createCommentVNode("",!0)])),e.createElementVNode("div",Dl,[e.unref(t).features.includes(e.unref(H).FULL_SCREEN)?(e.openBlock(),e.createElementBlock("div",{key:0,onClick:a[7]||(a[7]=f=>e.unref(r).toggle("fullScreen")),class:"mx-1.5",title:e.unref(o)("Toggle Full Screen")},[e.unref(c).fullScreen?(e.openBlock(),e.createBlock(e.unref(ml),{key:0})):(e.openBlock(),e.createBlock(e.unref(cl),{key:1}))],8,Tl)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"mx-1.5",title:e.unref(o)("Change View"),onClick:a[8]||(a[8]=f=>e.unref(d).query.length||u())},[e.unref(c).view==="grid"?(e.openBlock(),e.createBlock(e.unref(_l),{key:0,class:e.normalizeClass(["vf-toolbar-icon",e.unref(d).query.length?"vf-toolbar-icon-disabled":""])},null,8,["class"])):e.createCommentVNode("",!0),e.unref(c).view==="list"?(e.openBlock(),e.createBlock(e.unref(gl),{key:1,class:e.normalizeClass(["vf-toolbar-icon",e.unref(d).query.length?"vf-toolbar-icon-disabled":""])},null,8,["class"])):e.createCommentVNode("",!0)],8,Ml)])]))}}),Fl=(n,t=0,o=!1)=>{let l;return(...r)=>{o&&!l&&n(...r),clearTimeout(l),l=setTimeout(()=>{n(...r)},t)}},be=(n,t,o)=>{const l=e.ref(n);return e.customRef((r,m)=>({get(){return r(),l.value},set:Fl(c=>{l.value=c,m()},t,!1)}))},Il={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-300 dark:text-neutral-200 dark:hover:bg-gray-700 cursor-pointer",viewBox:"-40 -40 580 580"};function Ll(n,t){return e.openBlock(),e.createElementBlock("svg",Il,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M463.5 224h8.5c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2S461.9 48.1 455 55l-41.6 41.6c-87.6-86.5-228.7-86.2-315.8 1-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2S334.3 224 344 224z"},null,-1)])])}const Rl={render:Ll},zl={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-0.5 rounded",viewBox:"0 0 20 20"};function ql(n,t){return e.openBlock(),e.createElementBlock("svg",zl,[...t[0]||(t[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M5.293 9.707a1 1 0 0 1 0-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1-1.414 1.414L11 7.414V15a1 1 0 1 1-2 0V7.414L6.707 9.707a1 1 0 0 1-1.414 0",class:"pointer-events-none","clip-rule":"evenodd"},null,-1)])])}const Hl={render:ql},Pl={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-300 dark:text-neutral-200 dark:hover:bg-gray-700 cursor-pointer",viewBox:"0 0 24 24"};function jl(n,t){return e.openBlock(),e.createElementBlock("svg",Pl,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Ul={render:jl},Ol={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 rounded text-slate-700 hover:bg-neutral-100 dark:text-neutral-300 dark:hover:bg-gray-800 cursor-pointer",viewBox:"0 0 20 20"};function Kl(n,t){return e.openBlock(),e.createElementBlock("svg",Ol,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M10.707 2.293a1 1 0 0 0-1.414 0l-7 7a1 1 0 0 0 1.414 1.414L4 10.414V17a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-6.586l.293.293a1 1 0 0 0 1.414-1.414z",class:"pointer-events-none"},null,-1)])])}const Gl={render:Kl},Yl={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-6 w-6 p-1 m-auto stroke-gray-400 fill-gray-100 dark:stroke-gray-400 dark:fill-gray-400/20",viewBox:"0 0 20 20"};function Wl(n,t){return e.openBlock(),e.createElementBlock("svg",Yl,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607"},null,-1)])])}const Ql={render:Wl},Xl={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"w-6 h-6 cursor-pointer",viewBox:"0 0 24 24"};function Jl(n,t){return e.openBlock(),e.createElementBlock("svg",Xl,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Zl={render:Jl},ea={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"text-neutral-500 fill-sky-500 stroke-sky-500 dark:fill-slate-500 dark:stroke-slate-500",viewBox:"0 0 24 24"};function ta(n,t){return e.openBlock(),e.createElementBlock("svg",ea,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-6l-2-2H5a2 2 0 0 0-2 2"},null,-1)])])}const ue={render:ta},na={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-6 w-6 p-1 rounded text-slate-700 dark:text-neutral-300 cursor-pointer",viewBox:"0 0 24 24"};function oa(n,t){return e.openBlock(),e.createElementBlock("svg",na,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M9 6h11M12 12h8M15 18h5M5 6v.01M8 12v.01M11 18v.01"},null,-1)])])}const ra={render:oa},la={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 rounded text-slate-700 hover:bg-neutral-100 dark:fill-neutral-300 dark:hover:bg-gray-800 cursor-pointer",viewBox:"0 0 448 512"};function aa(n,t){return e.openBlock(),e.createElementBlock("svg",la,[...t[0]||(t[0]=[e.createElementVNode("path",{d:"M8 256a56 56 0 1 1 112 0 56 56 0 1 1-112 0m160 0a56 56 0 1 1 112 0 56 56 0 1 1-112 0m216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112"},null,-1)])])}const sa={render:aa};function ia(n){const[t,o]=ca(n);if(!o||o==="/")return t+"://";const l=o.replace(/\/+$/,""),r=l.lastIndexOf("/");return r===0?t+"://":t+":/"+l.slice(0,r)}function ca(n){const t=n.indexOf(":/");return t===-1?[void 0,n]:[n.slice(0,t),n.slice(t+2)||"/"]}function ce(n,t=[]){const o="vfDragEnterCounter",l=n.fs,r=A.useStore(l.selectedItems);function m(s,a){s.preventDefault(),l.getDraggedItem()===a.path||!a||a.type!=="dir"||r.value.some(v=>v.path===a.path||ia(v.path)===a.path)?s.dataTransfer&&(s.dataTransfer.dropEffect="none",s.dataTransfer.effectAllowed="none"):(s.dataTransfer&&(s.dataTransfer.dropEffect="copy",s.dataTransfer.effectAllowed="all"),s.currentTarget.classList.add(...t))}function c(s){s.preventDefault();const a=s.currentTarget,f=Number(a.dataset[o]||0);a.dataset[o]=String(f+1)}function d(s){s.preventDefault();const a=s.currentTarget,v=Number(a.dataset[o]||0)-1;v<=0?(delete a.dataset[o],a.classList.remove(...t)):a.dataset[o]=String(v)}function i(s,a){if(!a)return;s.preventDefault();const f=s.currentTarget;delete f.dataset[o],f.classList.remove(...t);const v=s.dataTransfer?.getData("items")||"[]",g=JSON.parse(v).map(k=>l.sortedFiles.get().find(h=>h.path===k));l.clearDraggedItem(),n.modal.open(Me,{items:{from:g,to:a}})}function u(s){return{dragover:a=>m(a,s),dragenter:c,dragleave:d,drop:a=>i(a,s)}}return{events:u}}const da={class:"vuefinder__breadcrumb__container"},ua=["title"],ma=["title"],fa=["title"],va=["title"],_a={class:"vuefinder__breadcrumb__list"},pa={key:0,class:"vuefinder__breadcrumb__hidden-list"},ha={class:"relative"},ga=["title","onClick"],ka={class:"vuefinder__breadcrumb__search-mode"},wa=["placeholder"],Ea=["onClick"],ya={class:"vuefinder__breadcrumb__hidden-item-content"},ba={class:"vuefinder__breadcrumb__hidden-item-text"},Va=e.defineComponent({__name:"Breadcrumb",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.search,r=t.fs,m=t.config,c=A.useStore(m.state),d=A.useStore(l.state),i=A.useStore(r.path),u=A.useStore(r.loading),s=e.computed(()=>d.value?.searchMode??!1),a=e.ref(null),f=be(0,100),v=e.ref(5),b=e.ref(!1),g=e.computed(()=>i.value?.breadcrumb??[]);function k(x,$){return x.length>$?[x.slice(-$),x.slice(0,-$)]:[x,[]]}const h=e.computed(()=>k(g.value,v.value)[0]),w=e.computed(()=>k(g.value,v.value)[1]);e.watch(f,()=>{if(!a.value)return;const x=a.value.children;let $=0,_=0;const y=5,P=1;v.value=y,e.nextTick(()=>{for(let K=x.length-1;K>=0;K--){const ne=x[K];if($+ne.offsetWidth>f.value-40)break;$+=parseInt(ne.offsetWidth.toString(),10),_++}_<P&&(_=P),_>y&&(_=y),v.value=_})});const N=()=>{a.value&&(f.value=a.value.offsetWidth)},M=e.ref(null);e.onMounted(()=>{M.value=new ResizeObserver(N),a.value&&M.value.observe(a.value)}),e.onUnmounted(()=>{M.value&&M.value.disconnect()});const z=ce(t,["bg-blue-200","dark:bg-slate-600"]);function j(x=null){x??=g.value.length-2;const $={basename:i.value?.storage??"local",extension:"",path:(i.value?.storage??"local")+"://",storage:i.value?.storage??"local",type:"dir",file_size:null,last_modified:null,mime_type:null,visibility:""};return g.value[x]??$}const C=()=>{L(),t.emitter.emit("vf-fetch",{params:{q:"index",storage:i.value?.storage,path:i.value?.path}})},B=()=>{l.exitSearchMode(),h.value.length>0&&!s.value&&t.emitter.emit("vf-fetch",{params:{q:"index",storage:i.value?.storage??"local",path:g.value[g.value.length-2]?.path??(i.value?.storage??"local")+"://"}})},U=x=>{t.emitter.emit("vf-fetch",{params:{q:"index",storage:i.value?.storage,path:x.path}}),b.value=!1},F=()=>{b.value&&(b.value=!1)},O={mounted(x,$){x.clickOutsideEvent=function(_){x===_.target||x.contains(_.target)||$.value()},document.body.addEventListener("click",x.clickOutsideEvent)},beforeUnmount(x){document.body.removeEventListener("click",x.clickOutsideEvent)}},S=()=>{m.toggle("showTreeView")},p=e.ref(null),E=be("",400);e.watch(E,x=>{t.emitter.emit("vf-toast-clear"),l.setQuery(x)}),e.watch(s,x=>{x&&e.nextTick(()=>{p.value&&p.value.focus()})}),t.emitter.on("vf-search-exit",()=>{l.exitSearchMode()});const I=()=>{E.value===""&&l.exitSearchMode()},L=()=>{E.value="",l.exitSearchMode()},R=e.ref({x:0,y:0}),q=x=>{if(x.currentTarget instanceof HTMLElement){const{x:$,y:_,height:y}=x.currentTarget.getBoundingClientRect();R.value={x:$,y:_+y}}b.value=!b.value};return(x,$)=>(e.openBlock(),e.createElementBlock("div",da,[e.createElementVNode("span",{title:e.unref(o)("Toggle Tree View")},[e.createVNode(e.unref(ra),{onClick:S,class:e.normalizeClass(["vuefinder__breadcrumb__toggle-tree",e.unref(c).showTreeView?"vuefinder__breadcrumb__toggle-tree--active":""])},null,8,["class"])],8,ua),e.createElementVNode("span",{title:e.unref(o)("Go up a directory")},[e.createVNode(e.unref(Hl),e.mergeProps(e.toHandlers(g.value.length&&!s.value?e.unref(z).events(j()):{}),{onClick:B,class:g.value.length&&!s.value?"vuefinder__breadcrumb__go-up--active":"vuefinder__breadcrumb__go-up--inactive"}),null,16,["class"])],8,ma),e.unref(r).isLoading()?(e.openBlock(),e.createElementBlock("span",{key:1,title:e.unref(o)("Cancel")},[e.createVNode(e.unref(Ul),{onClick:$[0]||($[0]=_=>e.unref(t).emitter.emit("vf-fetch-abort"))})],8,va)):(e.openBlock(),e.createElementBlock("span",{key:0,title:e.unref(o)("Refresh")},[e.createVNode(e.unref(Rl),{onClick:C})],8,fa)),e.withDirectives(e.createElementVNode("div",{class:"group vuefinder__breadcrumb__search-container",onClick:$[3]||($[3]=(..._)=>e.unref(l).enterSearchMode&&e.unref(l).enterSearchMode(..._))},[e.createElementVNode("div",null,[e.createVNode(e.unref(Gl),e.mergeProps(e.toHandlers(e.unref(z).events(j(-1))),{onClick:$[1]||($[1]=e.withModifiers(_=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:e.unref(i).value?.storage??"local"}}),["stop"]))}),null,16)]),e.createElementVNode("div",_a,[w.value.length?e.withDirectives((e.openBlock(),e.createElementBlock("div",pa,[$[5]||($[5]=e.createElementVNode("div",{class:"vuefinder__breadcrumb__separator"},"/",-1)),e.createElementVNode("div",ha,[e.createElementVNode("span",{onDragenter:$[2]||($[2]=_=>b.value=!0),onClick:q,class:"vuefinder__breadcrumb__hidden-toggle"},[e.createVNode(e.unref(sa),{class:"vuefinder__breadcrumb__hidden-toggle-icon"})],32)])])),[[O,F]]):e.createCommentVNode("",!0)]),e.createElementVNode("div",{ref_key:"breadcrumbContainer",ref:a,class:"vuefinder__breadcrumb__visible-list pointer-events-none"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,(_,y)=>(e.openBlock(),e.createElementBlock("div",{key:y},[$[6]||($[6]=e.createElementVNode("span",{class:"vuefinder__breadcrumb__separator"},"/",-1)),e.createElementVNode("span",e.mergeProps(e.toHandlers(e.unref(z).events(_),!0),{class:"vuefinder__breadcrumb__item pointer-events-auto",title:_.basename,onClick:e.withModifiers(P=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:e.unref(i)?.storage,path:_.path}}),["stop"])}),e.toDisplayString(_.name),17,ga)]))),128))],512),e.unref(m).get("loadingIndicator")==="circular"&&e.unref(u)?(e.openBlock(),e.createBlock(e.unref(Ee),{key:0})):e.createCommentVNode("",!0)],512),[[e.vShow,!s.value]]),e.withDirectives(e.createElementVNode("div",ka,[e.createElementVNode("div",null,[e.createVNode(e.unref(Ql))]),e.withDirectives(e.createElementVNode("input",{ref_key:"searchInput",ref:p,onKeydown:e.withKeys(L,["esc"]),onBlur:I,"onUpdate:modelValue":$[4]||($[4]=_=>e.isRef(E)?E.value=_:null),placeholder:e.unref(o)("Search anything.."),class:"vuefinder__breadcrumb__search-input",type:"text"},null,40,wa),[[e.vModelText,e.unref(E)]]),e.createVNode(e.unref(Zl),{onClick:L})],512),[[e.vShow,s.value]]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.withDirectives(e.createElementVNode("div",{style:e.normalizeStyle({position:"absolute",top:R.value.y+"px",left:R.value.x+"px"}),class:"vuefinder vuefinder__breadcrumb__hidden-dropdown"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,(_,y)=>(e.openBlock(),e.createElementBlock("div",e.mergeProps({key:y},e.toHandlers(e.unref(z).events(_),!0),{onClick:P=>U(_),class:"vuefinder__breadcrumb__hidden-item"}),[e.createElementVNode("div",ya,[e.createElementVNode("span",null,[e.createVNode(e.unref(ue),{class:"vuefinder__breadcrumb__hidden-item-icon"})]),$[7]||($[7]=e.createTextVNode()),e.createElementVNode("span",ba,e.toDisplayString(_.name),1)])],16,Ea))),128))],4),[[e.vShow,b.value]])]))]))}});function Na(n,t){const{scrollContainer:o,itemWidth:l=100,rowHeight:r,overscan:m=2,containerPadding:c=48}=t,d=n&&typeof n.get=="function"?A.useStore(n):n,i=()=>typeof r=="number"?r:r.value,u=e.ref(0),s=e.ref(6),a=e.ref(600);let f=null;const v=e.computed(()=>Math.ceil(d.value.length/s.value)),b=e.computed(()=>v.value*i()),g=e.computed(()=>{const C=i(),B=Math.max(0,Math.floor(u.value/C)-m),U=Math.min(v.value,Math.ceil((u.value+a.value)/C)+m);return{start:B,end:U}}),k=e.computed(()=>{const{start:C,end:B}=g.value;return Array.from({length:B-C},(U,F)=>C+F)}),h=()=>a.value,w=()=>{if(o.value){const C=o.value.clientWidth-c;s.value=Math.max(Math.floor(C/l),2)}},N=C=>{const B=C.target;u.value=B.scrollTop};e.watch(()=>d.value.length,()=>{w()});const M=(C,B)=>{const U=B*s.value;return C.slice(U,U+s.value)},z=(C,B,U,F,O)=>{const S=[];for(let p=B;p<=U;p++)for(let E=F;E<=O;E++){const I=p*s.value+E;I<C.length&&C[I]&&S.push(C[I])}return S},j=C=>({row:Math.floor(C/s.value),col:C%s.value});return e.onMounted(async()=>{await e.nextTick(),o.value&&(a.value=o.value.clientHeight||600),w(),window.addEventListener("resize",()=>{o.value&&(a.value=o.value.clientHeight||600),w()}),o.value&&"ResizeObserver"in window&&(f=new ResizeObserver(C=>{const B=C[0];B&&(a.value=Math.round(B.contentRect.height)),w()}),f.observe(o.value))}),e.onUnmounted(()=>{window.removeEventListener("resize",w),f&&(f.disconnect(),f=null)}),{scrollTop:u,itemsPerRow:s,totalRows:v,totalHeight:b,visibleRange:g,visibleRows:k,updateItemsPerRow:w,handleScroll:N,getRowItems:M,getItemsInRange:z,getItemPosition:j,getContainerHeight:h}}function Sa(n){const{getItemPosition:t,getItemsInRange:o,getKey:l,selectionObject:r,rowHeight:m,itemWidth:c}=n,d=Math.floor(Math.random()*2**32).toString(),u=e.inject("ServiceContainer").fs,s=A.useStore(u.selectedKeys),a=A.useStore(u.sortedFiles);A.useStore(u.selectedCount);const f=e.ref(new Set),v=e.ref(!1),b=e.ref(!1),g=e.ref(null),k=p=>p.map(E=>E.getAttribute("data-key")).filter(E=>!!E),h=p=>{p.selection.getSelection().forEach(E=>{p.selection.deselect(E,!0)})},w=p=>{s.value&&s.value.forEach(E=>{const I=document.querySelector(`[data-key="${E}"]`);I&&p.selection.select(I,!0)})},N=p=>{if(p.size===0)return null;const I=Array.from(p).map($=>{const _=a.value?.findIndex(y=>l(y)===$)??-1;return t(_>=0?_:0)}),L=Math.min(...I.map($=>$.row)),R=Math.max(...I.map($=>$.row)),q=Math.min(...I.map($=>$.col)),x=Math.max(...I.map($=>$.col));return{minRow:L,maxRow:R,minCol:q,maxCol:x}},M=p=>{v.value=!1,!p.event?.metaKey&&!p.event?.ctrlKey&&(b.value=!0),p.selection.resolveSelectables(),h(p),w(p)},z=({event:p,selection:E})=>{const I=p;I&&"type"in I&&I.type==="touchend"&&I.preventDefault();const L=p;if(!L?.ctrlKey&&!L?.metaKey&&(u.clearSelection(),E.clearSelection(!0,!0)),f.value.clear(),L&&r.value){const R=r.value.getSelectables()[0]?.closest(".scroller-"+d);if(R){const q=R.getBoundingClientRect(),x=L.clientY-q.top+R.scrollTop,$=L.clientX-q.left,_=Math.floor(x/m.value),y=Math.floor($/c);g.value={row:_,col:y}}}},j=p=>{const E=p.selection,I=k(p.store.changed.added),L=k(p.store.changed.removed);b.value=!1,v.value=!0,I.forEach(R=>{s.value&&!s.value.has(R)&&f.value.add(R),u.select(R)}),L.forEach(R=>{document.querySelector(`[data-key="${R}"]`)&&a.value?.find(x=>l(x)===R)&&f.value.delete(R),u.deselect(R)}),E.resolveSelectables(),w(p)},C=()=>{f.value.clear()},B=p=>{if(p.event&&g.value&&f.value.size>0){const I=Array.from(f.value).map(L=>{const R=a.value?.findIndex(q=>l(q)===L)??-1;return R>=0?t(R):null}).filter(L=>L!==null);if(I.length>0){const L=[...I,g.value],R={minRow:Math.min(...L.map(q=>q.row)),maxRow:Math.max(...L.map(q=>q.row)),minCol:Math.min(...L.map(q=>q.col)),maxCol:Math.max(...L.map(q=>q.col))};o(a.value||[],R.minRow,R.maxRow,R.minCol,R.maxCol).forEach(q=>{const x=l(q);document.querySelector(`[data-key="${x}"]`)||u.select(x)})}}},U=p=>{B(p),h(p),w(p),u.setSelectedCount(s.value?.size||0),v.value=!1,g.value=null},F=()=>{r.value=new ot({selectables:[".file-item-"+d],boundaries:[".scroller-"+d],selectionContainerClass:"selection-area-container",behaviour:{overlap:"invert",intersect:"touch",startThreshold:0,triggers:[0],scrolling:{speedDivider:10,manualSpeed:750,startScrollMargins:{x:0,y:10}}},features:{touch:!0,range:!0,deselectOnBlur:!0,singleTap:{allow:!1,intersect:"native"}}}),r.value.on("beforestart",M),r.value.on("start",z),r.value.on("move",j),r.value.on("stop",U)},O=()=>{r.value&&(r.value.destroy(),r.value=null)},S=p=>{b.value&&(r.value?.clearSelection(),C(),b.value=!1);const E=p;!f.value.size&&!b.value&&!E?.ctrlKey&&!E?.metaKey&&(u.clearSelection(),r.value?.clearSelection())};return e.onMounted(()=>{const p=E=>{!E.buttons&&v.value&&(v.value=!1)};document.addEventListener("dragleave",p),e.onUnmounted(()=>{document.removeEventListener("dragleave",p)})}),{isDragging:v,selectionStarted:b,explorerId:d,extractIds:k,cleanupSelection:h,refreshSelection:w,getSelectionRange:N,selectSelectionRange:B,initializeSelectionArea:F,destroySelectionArea:O,handleContentClick:S}}const Ba={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 20 20"};function xa(n,t){return e.openBlock(),e.createElementBlock("svg",Ba,[...t[0]||(t[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 0 1 1.414 0L10 10.586l3.293-3.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 0-1.414","clip-rule":"evenodd"},null,-1)])])}const Ca={render:xa},$a={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 20 20"};function Da(n,t){return e.openBlock(),e.createElementBlock("svg",$a,[...t[0]||(t[0]=[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 0 1-1.414 0L10 9.414l-3.293 3.293a1 1 0 0 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1 0 1.414","clip-rule":"evenodd"},null,-1)])])}const Ta={render:Da},de=e.defineComponent({__name:"SortIcon",props:{direction:{}},setup(n){return(t,o)=>(e.openBlock(),e.createElementBlock("div",null,[n.direction==="asc"?(e.openBlock(),e.createBlock(e.unref(Ca),{key:0})):e.createCommentVNode("",!0),n.direction==="desc"?(e.openBlock(),e.createBlock(e.unref(Ta),{key:1})):e.createCommentVNode("",!0)]))}}),Ma={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"absolute h-6 w-6 md:h-12 md:w-12 m-auto stroke-neutral-500 fill-white dark:fill-gray-700 dark:stroke-gray-600 z-10",viewBox:"0 0 24 24"};function Aa(n,t){return e.openBlock(),e.createElementBlock("svg",Ma,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 0 0 2-2V9.414a1 1 0 0 0-.293-.707l-5.414-5.414A1 1 0 0 0 12.586 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"},null,-1)])])}const Fa={render:Aa},Ia={class:"vuefinder__drag-item__container"},La={class:"vuefinder__drag-item__count"},Ra=e.defineComponent({__name:"DragItem",props:{count:{}},setup(n){const t=n;return(o,l)=>(e.openBlock(),e.createElementBlock("div",Ia,[e.createVNode(e.unref(Fa)),e.createElementVNode("div",La,e.toDisplayString(t.count),1)]))}}),za={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"text-neutral-500",viewBox:"0 0 24 24"};function qa(n,t){return e.openBlock(),e.createElementBlock("svg",za,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 21h10a2 2 0 0 0 2-2V9.414a1 1 0 0 0-.293-.707l-5.414-5.414A1 1 0 0 0 12.586 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2"},null,-1)])])}const Ha={render:qa},Pa={key:3,class:"vuefinder__item-icon__extension"},Ve=e.defineComponent({__name:"ItemIcon",props:{item:{},ext:{type:Boolean},small:{type:Boolean}},setup(n){const t=n,o=e.inject("ServiceContainer"),l=o.customIcon?.(o,t.item);return(r,m)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__item-icon",n.small?"vuefinder__item-icon--small":"vuefinder__item-icon--large"])},[e.unref(l)?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l).is),e.normalizeProps(e.mergeProps({key:0},e.unref(l).props||{})),null,16)):n.item.type==="dir"?(e.openBlock(),e.createBlock(e.unref(ue),{key:1})):(e.openBlock(),e.createBlock(e.unref(Ha),{key:2})),!e.unref(l)&&n.ext&&n.item.type!=="dir"&&n.item.extension?(e.openBlock(),e.createElementBlock("div",Pa,e.toDisplayString(n.item.extension.substring(0,3)),1)):e.createCommentVNode("",!0)],2))}}),ja={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-5 w-5",viewBox:"0 0 24 24"};function Ua(n,t){return e.openBlock(),e.createElementBlock("svg",ja,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"m15 4.5-4 4L7 10l-1.5 1.5 7 7L14 17l1.5-4 4-4M9 15l-4.5 4.5M14.5 4 20 9.5"},null,-1)])])}const Pe={render:Ua},Oa=["data-key","data-row","data-col","draggable"],Ka={key:0},Ga={class:"vuefinder__explorer__item-grid-content"},Ya=["data-src","alt"],Wa={class:"vuefinder__explorer__item-title"},Qa={key:1,class:"vuefinder__explorer__item-list-content"},Xa={class:"vuefinder__explorer__item-list-name"},Ja={class:"vuefinder__explorer__item-list-icon"},Za={class:"vuefinder__explorer__item-name"},es={key:0,class:"vuefinder__explorer__item-path"},ts={key:1,class:"vuefinder__explorer__item-size"},ns={key:0},os={key:2,class:"vuefinder__explorer__item-date"},rs=e.defineComponent({__name:"FileItem",props:{item:{},view:{},compact:{type:Boolean},showThumbnails:{type:Boolean},isSelected:{type:Boolean},isDragging:{type:Boolean},rowIndex:{},colIndex:{},showPath:{type:Boolean},explorerId:{}},emits:["click","dblclick","contextmenu","dragstart","dragend"],setup(n,{emit:t}){const o=n,l=t,r=e.inject("ServiceContainer"),m=r.fs,c=r.config,d=e.computed(()=>["file-item-"+o.explorerId,o.view==="grid"?"vf-explorer-item-grid":"vf-explorer-item-list",o.isSelected?"vf-explorer-selected":""]),i=e.computed(()=>({opacity:o.isDragging||m.isCut(o.item.path)?.5:""}));let u=null;const s=e.ref(null);let a=!1;const f=()=>{u&&clearTimeout(u),v.value=!0},v=e.ref(!0),b=g=>{if(v.value=!1,u&&(g.preventDefault(),clearTimeout(u)),!a)a=!0,l("click",g),s.value=setTimeout(()=>a=!1,300);else return a=!1,l("dblclick",g),u&&clearTimeout(u),!1;if(g.currentTarget&&g.currentTarget instanceof HTMLElement){const k=g.currentTarget.getBoundingClientRect();g.preventDefault(),u=setTimeout(()=>{let N=k.y+k.height;N+146>window.innerHeight-10&&(N=k.y-146),N<10&&(N=10);const M=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2,buttons:0,clientX:k.x,clientY:N});g.target?.dispatchEvent(M)},300)}};return(g,k)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(d.value),style:e.normalizeStyle(i.value),"data-key":n.item.path,"data-row":n.rowIndex,"data-col":n.colIndex,draggable:v.value,onTouchstart:k[1]||(k[1]=h=>b(h)),onTouchend:k[2]||(k[2]=h=>f()),onClick:k[3]||(k[3]=h=>l("click",h)),onDblclick:k[4]||(k[4]=h=>l("dblclick",h)),onContextmenu:k[5]||(k[5]=e.withModifiers(h=>l("contextmenu",h),["prevent","stop"])),onDragstart:k[6]||(k[6]=h=>l("dragstart",h)),onDragend:k[7]||(k[7]=h=>l("dragend",h))},[n.view==="grid"?(e.openBlock(),e.createElementBlock("div",Ka,[e.createElementVNode("div",Ga,[(n.item.mime_type??"").startsWith("image")&&n.showThumbnails?(e.openBlock(),e.createElementBlock("img",{key:0,onTouchstart:k[0]||(k[0]=h=>h.preventDefault()),src:"data:image/png;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",class:"vuefinder__explorer__item-thumbnail lazy","data-src":e.unref(r).requester.getPreviewUrl(n.item.storage,n.item),alt:n.item.basename},null,40,Ya)):(e.openBlock(),e.createBlock(Ve,{key:1,item:n.item,ext:!0},null,8,["item"]))]),e.createElementVNode("span",Wa,e.toDisplayString(e.unref(he)(n.item.basename)),1)])):(e.openBlock(),e.createElementBlock("div",Qa,[e.createElementVNode("div",Xa,[e.createElementVNode("div",Ja,[e.createVNode(Ve,{item:n.item,small:n.compact},null,8,["item","small"])]),e.createElementVNode("span",Za,e.toDisplayString(n.item.basename),1)]),n.showPath?(e.openBlock(),e.createElementBlock("div",es,e.toDisplayString(n.item.path),1)):e.createCommentVNode("",!0),n.showPath?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",ts,[n.item.file_size?(e.openBlock(),e.createElementBlock("div",ns,e.toDisplayString(e.unref(r).filesize(n.item.file_size)),1)):e.createCommentVNode("",!0)])),!n.showPath&&n.item.last_modified?(e.openBlock(),e.createElementBlock("div",os,e.toDisplayString(new Date(n.item.last_modified*1e3).toLocaleString()),1)):e.createCommentVNode("",!0)])),e.unref(c).get("pinnedFolders").find(h=>h.path===n.item.path)?(e.openBlock(),e.createBlock(e.unref(Pe),{key:2,class:"vuefinder__item--pinned"})):e.createCommentVNode("",!0)],46,Oa))}}),ls=["data-row"],_e=e.defineComponent({__name:"FileRow",props:{rowIndex:{},rowHeight:{},view:{},itemsPerRow:{},items:{},compact:{type:Boolean},showThumbnails:{type:Boolean},showPath:{type:Boolean},isDraggingItem:{type:Function},isSelected:{type:Function},dragNDropEvents:{type:Function},explorerId:{}},emits:["click","dblclick","contextmenu","dragstart","dragend"],setup(n,{emit:t}){const o=n,l=t,r=e.computed(()=>[o.view==="grid"?"vf-explorer-item-grid-row":"vf-explorer-item-list-row","pointer-events-none"]),m=e.computed(()=>({position:"absolute",top:0,left:0,width:"100%",height:`${o.rowHeight}px`,transform:`translateY(${o.rowIndex*o.rowHeight}px)`})),c=e.computed(()=>o.view==="grid"?{gridTemplateColumns:`repeat(${o.itemsPerRow||1}, 1fr)`}:{gridTemplateColumns:"1fr"});return(d,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(r.value),"data-row":n.rowIndex,style:e.normalizeStyle(m.value)},[e.createElementVNode("div",{class:e.normalizeClass(["grid justify-self-start",{"w-full":n.view==="list"}]),style:e.normalizeStyle(c.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.items,(u,s)=>(e.openBlock(),e.createBlock(rs,e.mergeProps({key:u.path,item:u,view:n.view,compact:n.compact,"show-thumbnails":n.showThumbnails,"show-path":n.showPath,"is-selected":n.isSelected(u.path),"is-dragging":n.isDraggingItem(u.path),"row-index":n.rowIndex,"col-index":s},e.toHandlers(n.dragNDropEvents(u)),{onClick:i[0]||(i[0]=a=>l("click",a)),onDblclick:i[1]||(i[1]=a=>l("dblclick",a)),onContextmenu:i[2]||(i[2]=a=>l("contextmenu",a)),onDragstart:i[3]||(i[3]=a=>l("dragstart",a)),onDragend:i[4]||(i[4]=a=>l("dragend",a)),explorerId:n.explorerId}),null,16,["item","view","compact","show-thumbnails","show-path","is-selected","is-dragging","row-index","col-index","explorerId"]))),128))],6)],14,ls))}}),as=["onClick"],ss=e.defineComponent({__name:"Toast",setup(n){const t=e.inject("ServiceContainer"),{getStore:o}=t.storage,l=e.ref(o("full-screen",!1)),r=e.ref([]),m=i=>i==="error"?"text-red-400 border-red-400 dark:text-red-300 dark:border-red-300":"text-lime-600 border-lime-600 dark:text-lime-300 dark:border-lime-1300",c=i=>{r.value.splice(i,1)},d=i=>{let u=r.value.findIndex(s=>s.id===i);u!==-1&&c(u)};return t.emitter.on("vf-toast-clear",()=>{r.value=[]}),t.emitter.on("vf-toast-push",i=>{let u=new Date().getTime().toString(36).concat(performance.now().toString(),Math.random().toString()).replace(/\./g,"");i.id=u,r.value.push(i),setTimeout(()=>{d(u)},5e3)}),(i,u)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["vuefinder__toast",l.value.value?"vuefinder__toast--fixed":"vuefinder__toast--absolute"])},[e.createVNode(e.TransitionGroup,{name:"vuefinder__toast-item","enter-active-class":"vuefinder__toast-item--enter-active","leave-active-class":"vuefinder__toast-item--leave-active","leave-to-class":"vuefinder__toast-item--leave-to"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,(s,a)=>(e.openBlock(),e.createElementBlock("div",{key:a,onClick:f=>c(a),class:e.normalizeClass(["vuefinder__toast__message",m(s.type)])},e.toDisplayString(s.label),11,as))),128))]),_:1})],2))}}),is={class:"vuefinder__explorer__container"},cs={ref:"customScrollBar",class:"vuefinder__explorer__scrollbar"},ds={key:0,class:"vuefinder__explorer__header"},us={key:0,class:"vuefinder__linear-loader"},ms={key:1,class:"vuefinder__circular-loader"},fs=e.defineComponent({__name:"Explorer",setup(n){const t=e.inject("ServiceContainer"),o=ce(t,["bg-blue-200","dark:bg-slate-600"]),l=e.useTemplateRef("dragImage"),r=e.shallowRef(null),m=e.useTemplateRef("scrollContainer"),c=e.useTemplateRef("scrollContent"),d=t.search,i=t.fs,u=t.config,s=A.useStore(u.state),a=A.useStore(d.state),f=A.useStore(i.sortedFiles),v=A.useStore(i.selectedKeys),b=A.useStore(i.loading),g=V=>v.value?.has(V)??!1;let k=null;const h=e.ref(null),w=e.useTemplateRef("customScrollBar"),N=e.useTemplateRef("customScrollBarContainer"),M=e.computed(()=>{const V=s.value.view,D=s.value.compactListView;return V==="grid"&&!(a.value.searchMode&&a.value.query.length)?88:D?24:50}),{t:z}=t.i18n,{itemsPerRow:j,totalHeight:C,visibleRows:B,handleScroll:U,getRowItems:F,getItemsInRange:O,getItemPosition:S,updateItemsPerRow:p}=Na(e.computed(()=>f.value??[]),{scrollContainer:m,itemWidth:104,rowHeight:M,overscan:2,containerPadding:0}),{explorerId:E,isDragging:I,initializeSelectionArea:L,destroySelectionArea:R,handleContentClick:q}=Sa({getItemPosition:S,getItemsInRange:O,getKey:V=>V.path,selectionObject:r,rowHeight:M,itemWidth:104}),x=e.ref(null),$=V=>{if(!V||!x.value)return!1;const D=v.value?.has(x.value)??!1;return I.value&&(D?v.value?.has(V)??!1:V===x.value)};e.watch(()=>u.get("view"),V=>{V==="list"?j.value=1:p()},{immediate:!0}),e.watch(j,V=>{u.get("view")==="list"&&V!==1&&(j.value=1)});const _=V=>f.value?.[V];e.onMounted(()=>{if(L(),r.value&&r.value.on("beforestart",({event:V})=>{const D=V?.target===c.value;if(!V?.metaKey&&!V?.ctrlKey&&!V?.altKey&&!D)return!1}),m.value&&(k=new rt({elements_selector:".lazy",container:m.value})),e.watch(()=>a.value.query,V=>{const D=i.path.get().storage,T=i.path.get().path;!D||!T||(V?t.emitter.emit("vf-fetch",{params:{q:"search",storage:D,path:T,filter:V},onSuccess:Q=>{Q.files.length||t.emitter.emit("vf-toast-push",{label:z("No search result found.")})}}):t.emitter.emit("vf-fetch",{params:{q:"index",storage:D,path:T}}))}),N.value){const V=ge.OverlayScrollbars(N.value,{scrollbars:{theme:"vf-scrollbars-theme"}},{initialized:D=>{h.value=D},scroll:D=>{const{scrollOffsetElement:T}=D.elements();m.value&&m.value.scrollTo({top:T.scrollTop,left:0})}});h.value=V}m.value&&m.value.addEventListener("scroll",()=>{const V=h.value;if(!V)return;const{scrollOffsetElement:D}=V.elements();D.scrollTo({top:m.value.scrollTop,left:0})})}),e.onUpdated(()=>{if(k&&k.update(),h.value&&w.value&&m.value){const D=m.value.scrollHeight>m.value.clientHeight,T=w.value;T.style.display=D?"block":"none",T.style.height=`${C.value}px`}}),e.onUnmounted(()=>{R(),k&&(k.destroy(),k=null),h.value&&(h.value.destroy(),h.value=null)});const y=V=>{const D=V.target?.closest(".file-item-"+E),T=V;if(!T?.ctrlKey&&!T?.metaKey&&(i.clearSelection(),r.value?.clearSelection(!0,!0)),D){const Q=String(D.getAttribute("data-key"));r.value?.resolveSelectables(),i.toggleSelect(Q)}i.setSelectedCount(v.value?.size||0)},P=V=>{const D=t.contextMenuItems.find(T=>T.show(t,{searchQuery:"",items:[V],target:V}));D&&D.action(t,[V])},K=V=>{const D=V.target?.closest(".file-item-"+E),T=D?String(D.getAttribute("data-key")):null;if(!T)return;const Q=f.value?.find(me=>me.path===T);Q&&P(Q)},ne=()=>{const V=v.value;return f.value?.filter(D=>V?.has(D.path))||[]},le=V=>{V.preventDefault();const D=V.target?.closest(".file-item-"+E);if(D){const T=String(D.getAttribute("data-key")),Q=f.value?.find(me=>me.path===T);v.value?.has(T)||(i.clearSelection(),i.select(T)),t.emitter.emit("vf-contextmenu-show",{event:V,items:ne(),target:Q})}},ee=V=>{V.preventDefault(),t.emitter.emit("vf-contextmenu-show",{event:V,items:ne()})},ae=V=>{if(V.altKey||V.ctrlKey||V.metaKey)return V.preventDefault(),!1;I.value=!0;const D=V.target?.closest(".file-item-"+E);if(x.value=D?String(D.dataset.key):null,V.dataTransfer&&x.value){V.dataTransfer.setDragImage(l.value,0,15),V.dataTransfer.effectAllowed="all",V.dataTransfer.dropEffect="copy";const T=v.value?.has(x.value)?Array.from(v.value):[x.value];V.dataTransfer.setData("items",JSON.stringify(T)),i.setDraggedItem(x.value)}},oe=()=>{x.value=null};return(V,D)=>(e.openBlock(),e.createElementBlock("div",is,[e.createElementVNode("div",{ref:"customScrollBarContainer",class:e.normalizeClass(["vuefinder__explorer__scrollbar-container",[{"grid-view":e.unref(s).view==="grid"},{"search-active":e.unref(a).hasQuery}]])},[e.createElementVNode("div",cs,null,512)],2),e.unref(s).view==="list"||e.unref(a).query.length?(e.openBlock(),e.createElementBlock("div",ds,[e.createElementVNode("div",{onClick:D[0]||(D[0]=T=>e.unref(i).toggleSort("basename")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--name vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(z)("Name"))+" ",1),e.withDirectives(e.createVNode(de,{direction:e.unref(i).sort.order},null,8,["direction"]),[[e.vShow,e.unref(i).sort.active&&e.unref(i).sort.column==="basename"]])]),e.unref(a).query.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,onClick:D[1]||(D[1]=T=>e.unref(i).toggleSort("file_size")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--size vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(z)("Size"))+" ",1),e.withDirectives(e.createVNode(de,{direction:e.unref(i).sort.order},null,8,["direction"]),[[e.vShow,e.unref(i).sort.active&&e.unref(i).sort.column==="file_size"]])])),e.unref(a).query.length?(e.openBlock(),e.createElementBlock("div",{key:1,onClick:D[2]||(D[2]=T=>e.unref(i).toggleSort("path")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--path vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(z)("Filepath"))+" ",1),e.withDirectives(e.createVNode(de,{direction:e.unref(i).sort.order},null,8,["direction"]),[[e.vShow,e.unref(i).sort.active&&e.unref(i).sort.column==="path"]])])):e.createCommentVNode("",!0),e.unref(a).query.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:2,onClick:D[3]||(D[3]=T=>e.unref(i).toggleSort("last_modified")),class:"vuefinder__explorer__sort-button vuefinder__explorer__sort-button--date vf-sort-button"},[e.createTextVNode(e.toDisplayString(e.unref(z)("Date"))+" ",1),e.withDirectives(e.createVNode(de,{direction:e.unref(i).sort.order},null,8,["direction"]),[[e.vShow,e.unref(i).sort.active&&e.unref(i).sort.column==="last_modified"]])]))])):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContainer",ref:m,class:e.normalizeClass(["vuefinder__explorer__selector-area","scroller-"+e.unref(E)]),onScroll:D[5]||(D[5]=(...T)=>e.unref(U)&&e.unref(U)(...T))},[e.unref(u).get("loadingIndicator")==="linear"&&e.unref(b)?(e.openBlock(),e.createElementBlock("div",us)):e.createCommentVNode("",!0),e.unref(u).get("loadingIndicator")==="circular"&&e.unref(b)?(e.openBlock(),e.createElementBlock("div",ms)):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContent",ref:c,class:"scrollContent min-h-full",style:e.normalizeStyle({height:`${e.unref(C)}px`,position:"relative",width:"100%"}),onContextmenu:e.withModifiers(ee,["self","prevent"]),onClick:D[4]||(D[4]=e.withModifiers((...T)=>e.unref(q)&&e.unref(q)(...T),["self"]))},[e.createElementVNode("div",{ref_key:"dragImage",ref:l,class:"vuefinder__explorer__drag-item"},[e.createVNode(Ra,{count:x.value&&e.unref(v)?.has(x.value)?e.unref(v)?.size:1},null,8,["count"])],512),e.unref(a).query.length?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(B),T=>(e.openBlock(),e.createBlock(_e,{key:T,"row-index":T,"row-height":M.value,view:"list",items:_(T)?[_(T)]:[],compact:e.unref(s).compactListView,"show-path":!0,"is-dragging-item":$,"is-selected":g,"drag-n-drop-events":Q=>e.unref(o).events(Q),explorerId:e.unref(E),onClick:y,onDblclick:K,onContextmenu:le,onDragstart:ae,onDragend:oe},null,8,["row-index","row-height","items","compact","drag-n-drop-events","explorerId"]))),128)):e.unref(s).view==="grid"?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(B),T=>(e.openBlock(),e.createBlock(_e,{key:T,"row-index":T,"row-height":M.value,view:"grid","items-per-row":e.unref(j),items:e.unref(F)(e.unref(f),T),"show-thumbnails":e.unref(s).showThumbnails,"is-dragging-item":$,"is-selected":g,"drag-n-drop-events":Q=>e.unref(o).events(Q),explorerId:e.unref(E),onClick:y,onDblclick:K,onContextmenu:le,onDragstart:ae,onDragend:oe},null,8,["row-index","row-height","items-per-row","items","show-thumbnails","drag-n-drop-events","explorerId"]))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(e.unref(B),T=>(e.openBlock(),e.createBlock(_e,{key:T,"row-index":T,"row-height":M.value,view:"list",items:_(T)?[_(T)]:[],compact:e.unref(s).compactListView,"is-dragging-item":$,"is-selected":g,"drag-n-drop-events":Q=>e.unref(o).events(Q),explorerId:e.unref(E),onClick:y,onDblclick:K,onContextmenu:le,onDragstart:ae,onDragend:oe},null,8,["row-index","row-height","items","compact","drag-n-drop-events","explorerId"]))),128))],36)],34),e.createVNode(ss)]))}}),vs=["href","download"],_s=["onClick"],ps=e.defineComponent({__name:"ContextMenu",setup(n){const t=e.inject("ServiceContainer"),o=t.search,l=A.useStore(o.state),r=e.ref(null),m=e.ref([]),c=e.reactive({active:!1,items:[],positions:{left:"0px",top:"0px"}});t.emitter.on("vf-context-selected",s=>{m.value=s});const d=s=>s.link(t,m.value),i=s=>{t.emitter.emit("vf-contextmenu-hide"),s.action(t,m.value)};t.emitter.on("vf-contextmenu-show",({event:s,items:a,target:f=null})=>{if(c.items=t.contextMenuItems.filter(v=>v.show(t,{searchQuery:l.query,items:a,target:f})),l.query)if(f)t.emitter.emit("vf-context-selected",[f]);else return;else!f&&!l.query?t.emitter.emit("vf-context-selected",[]):a.length>1&&a.some(v=>v.path===f.path)?t.emitter.emit("vf-context-selected",a):t.emitter.emit("vf-context-selected",[f]);u(s)}),t.emitter.on("vf-contextmenu-hide",()=>{c.active=!1});const u=s=>{const a=t.root,f=t.root.getBoundingClientRect(),v=a.getBoundingClientRect();let b=s.clientX-f.left,g=s.clientY-f.top;c.active=!0,e.nextTick(()=>{const k=r.value?.getBoundingClientRect();let h=k?.height??0,w=k?.width??0;b=v.right-s.pageX+window.scrollX<w?b-w:b,g=v.bottom-s.pageY+window.scrollY<h?g-h:g,c.positions={left:String(b)+"px",top:String(g)+"px"}})};return(s,a)=>e.withDirectives((e.openBlock(),e.createElementBlock("ul",{ref_key:"contextmenu",ref:r,class:e.normalizeClass([c.active?"vuefinder__context-menu--active":"vuefinder__context-menu--inactive","vuefinder__context-menu"]),style:e.normalizeStyle(c.positions)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.items,f=>(e.openBlock(),e.createElementBlock("li",{class:"vuefinder__context-menu__item",key:f.title},[f.link?(e.openBlock(),e.createElementBlock("a",{key:0,class:"vuefinder__context-menu__link",target:"_blank",href:d(f),download:d(f),onClick:a[0]||(a[0]=v=>e.unref(t).emitter.emit("vf-contextmenu-hide"))},[e.createElementVNode("span",null,e.toDisplayString(f.title(e.unref(t).i18n)),1)],8,vs)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"vuefinder__context-menu__action",onClick:v=>i(f)},[e.createElementVNode("span",null,e.toDisplayString(f.title(e.unref(t).i18n)),1)],8,_s))]))),128))],6)),[[e.vShow,c.active]])}}),hs={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"h-5 w-5",viewBox:"0 0 24 24"};function gs(n,t){return e.openBlock(),e.createElementBlock("svg",hs,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"},null,-1)])])}const je={render:gs},ks={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2",class:"h-5 w-5 stroke-slate-500 cursor-pointer",viewBox:"0 0 24 24"};function ws(n,t){return e.openBlock(),e.createElementBlock("svg",ks,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0"},null,-1)])])}const Es={render:ws},ys={class:"vuefinder__status-bar__wrapper"},bs={class:"vuefinder__status-bar__storage"},Vs=["title"],Ns={class:"vuefinder__status-bar__storage-icon"},Ss=["value"],Bs=["value"],xs={class:"vuefinder__status-bar__info"},Cs={key:0},$s={class:"vuefinder__status-bar__selected-count"},Ds={class:"vuefinder__status-bar__actions"},Ts=["disabled"],Ms=["title"],As=e.defineComponent({__name:"Statusbar",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,l=t.fs,r=t.search,m=A.useStore(r.state),c=A.useStore(l.sortedFiles),d=A.useStore(l.path),i=A.useStore(l.selectedCount),u=A.useStore(l.storages),s=f=>{const v=f.target.value;t.emitter.emit("vf-search-exit"),t.emitter.emit("vf-fetch",{params:{q:"index",storage:v}})},a=e.computed(()=>{const f=t.selectButton.multiple?i.value>0:i.value===1;return t.selectButton.active&&f});return(f,v)=>(e.openBlock(),e.createElementBlock("div",ys,[e.createElementVNode("div",bs,[e.createElementVNode("div",{class:"vuefinder__status-bar__storage-container",title:e.unref(o)("Storage")},[e.createElementVNode("div",Ns,[e.createVNode(e.unref(je))]),e.createElementVNode("select",{name:"vuefinder-media-selector",value:e.unref(d)?.storage,onChange:s,class:"vuefinder__status-bar__storage-select",tabindex:"-1"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),b=>(e.openBlock(),e.createElementBlock("option",{value:b,key:b},e.toDisplayString(b),9,Bs))),128))],40,Ss)],8,Vs),e.createElementVNode("div",xs,[e.unref(m).hasQuery?(e.openBlock(),e.createElementBlock("span",Cs,e.toDisplayString(e.unref(c).value.length)+" items found. ",1)):e.createCommentVNode("",!0),e.createElementVNode("span",$s,e.toDisplayString(e.unref(i)>0?`${e.unref(i)} item(s) selected.`:""),1)])]),e.createElementVNode("div",Ds,[e.unref(t).selectButton.active?(e.openBlock(),e.createElementBlock("button",{key:0,class:e.normalizeClass(["vf-btn vf-btn-primary vf-btn-small",{disabled:!a.value}]),disabled:!a.value,onClick:v[0]||(v[0]=b=>e.unref(t).selectButton.click(e.unref(l).selectedItems,b))},e.toDisplayString(e.unref(o)("Select")),11,Ts)):e.createCommentVNode("",!0),e.createElementVNode("span",{class:"vuefinder__status-bar__about",title:e.unref(o)("About"),onClick:v[1]||(v[1]=b=>e.unref(t).modal.open(Be))},[e.createVNode(e.unref(Es))],8,Ms)])]))}}),Fs={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"1.5",class:"text-neutral-500 fill-sky-500 stroke-gray-100/50 dark:stroke-slate-700/50 dark:fill-slate-500",viewBox:"0 0 24 24"};function Is(n,t){return e.openBlock(),e.createElementBlock("svg",Fs,[...t[0]||(t[0]=[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776q.168-.026.344-.026h15.812q.176 0 .344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"},null,-1)])])}const Ue={render:Is},Ls={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"h-5 w-5",viewBox:"0 0 24 24"};function Rs(n,t){return e.openBlock(),e.createElementBlock("svg",Ls,[...t[0]||(t[0]=[e.createElementVNode("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2m3.6 5.2a1 1 0 0 0-1.4.2L12 10.333 9.8 7.4a1 1 0 1 0-1.6 1.2l2.55 3.4-2.55 3.4a1 1 0 1 0 1.6 1.2l2.2-2.933 2.2 2.933a1 1 0 0 0 1.6-1.2L13.25 12l2.55-3.4a1 1 0 0 0-.2-1.4"},null,-1)])])}const zs={render:Rs},qs={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"};function Hs(n,t){return e.openBlock(),e.createElementBlock("svg",qs,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M15 12H9M12 9v6"},null,-1)])])}const Oe={render:Hs},Ps={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"};function js(n,t){return e.openBlock(),e.createElementBlock("svg",Ps,[...t[0]||(t[0]=[e.createElementVNode("path",{stroke:"none",d:"M0 0h24v24H0z"},null,-1),e.createElementVNode("path",{d:"M9 12h6"},null,-1)])])}const Ke={render:js};function Ge(n,t){const o=n.findIndex(l=>l.path===t.path);o>-1?n[o]=t:n.push(t)}const Us={class:"vuefinder__folder-loader-indicator"},Os={key:1,class:"vuefinder__folder-loader-indicator--icon"},Ye=e.defineComponent({__name:"FolderLoaderIndicator",props:e.mergeModels({storage:{},path:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,o=e.inject("ServiceContainer"),{t:l}=o.i18n,r=e.useModel(n,"modelValue"),m=e.ref(!1);e.watch(()=>r.value,()=>c()?.folders.length||d());function c(){return o.treeViewData.find(i=>i.path===t.path)}const d=()=>{m.value=!0,o.requester.send({url:"",method:"get",params:{q:"subfolders",storage:t.storage,path:t.path}}).then(i=>{Ge(o.treeViewData,{path:t.path,type:"dir",...i})}).catch(i=>{}).finally(()=>{m.value=!1})};return(i,u)=>(e.openBlock(),e.createElementBlock("div",Us,[m.value?(e.openBlock(),e.createBlock(e.unref(Ee),{key:0,class:"vuefinder__folder-loader-indicator--loading"})):(e.openBlock(),e.createElementBlock("div",Os,[r.value&&c()?.folders.length?(e.openBlock(),e.createBlock(e.unref(Ke),{key:0,class:"vuefinder__folder-loader-indicator--minus"})):e.createCommentVNode("",!0),r.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(Oe),{key:1,class:"vuefinder__folder-loader-indicator--plus"}))]))]))}}),Ks=["onClick"],Gs=["title","onDblclick","onClick"],Ys={class:"vuefinder__treesubfolderlist__item-icon"},Ws={class:"vuefinder__treesubfolderlist__subfolder"},Qs=e.defineComponent({__name:"TreeSubfolderList",props:{storage:{},path:{}},setup(n){const t=e.inject("ServiceContainer"),o=t.fs,l=ce(t,["bg-blue-200","dark:bg-slate-600"]),r=e.ref({}),m=A.useStore(o.path),c=n,d=e.ref(null);e.onMounted(()=>{c.path===c.storage+"://"&&d.value&&ge.OverlayScrollbars(d.value,{scrollbars:{theme:"vf-theme-dark dark:vf-theme-light"}})});const i=e.computed(()=>t.treeViewData.find(u=>u.path===c.path)?.folders||[]);return(u,s)=>{const a=e.resolveComponent("TreeSubfolderList",!0);return e.openBlock(),e.createElementBlock("ul",{ref_key:"parentSubfolderList",ref:d,class:"vuefinder__treesubfolderlist__container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,f=>(e.openBlock(),e.createElementBlock("li",{key:f.path,class:"vuefinder__treesubfolderlist__item"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(l).events({...f,type:"dir"}),!0),{class:"vuefinder__treesubfolderlist__item-content"}),[e.createElementVNode("div",{class:"vuefinder__treesubfolderlist__item-toggle",onClick:v=>r.value[f.path]=!r.value[f.path]},[e.createVNode(Ye,{storage:n.storage,path:f.path,modelValue:r.value[f.path],"onUpdate:modelValue":v=>r.value[f.path]=v},null,8,["storage","path","modelValue","onUpdate:modelValue"])],8,Ks),e.createElementVNode("div",{class:"vuefinder__treesubfolderlist__item-link",title:f.path,onDblclick:v=>r.value[f.path]=!r.value[f.path],onClick:v=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:c.storage,path:f.path}})},[e.createElementVNode("div",Ys,[e.unref(m)?.path===f.path?(e.openBlock(),e.createBlock(e.unref(Ue),{key:0})):(e.openBlock(),e.createBlock(e.unref(ue),{key:1}))]),e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__treesubfolderlist__item-text",{"vuefinder__treesubfolderlist__item-text--active":e.unref(m)?.path===f.path}])},e.toDisplayString(f.basename),3)],40,Gs)],16),e.createElementVNode("div",Ws,[e.withDirectives(e.createVNode(a,{storage:c.storage,path:f.path},null,8,["storage","path"]),[[e.vShow,r.value[f.path]]])])]))),128))],512)}}}),Xs=e.defineComponent({__name:"TreeStorageItem",props:{storage:{}},setup(n){const t=e.inject("ServiceContainer"),o=t.fs,l=e.ref(!1),r=n,m=ce(t,["bg-blue-200","dark:bg-slate-600"]),c=A.useStore(o.path),d=e.computed(()=>r.storage===c.value?.storage),i={storage:r.storage,path:r.storage+"://",type:"dir",basename:r.storage,extension:"",file_size:null,last_modified:null,mime_type:null,visibility:"public"};function u(s){s===c.value?.storage?l.value=!l.value:(t.emitter.emit("vf-search-exit"),t.emitter.emit("vf-fetch",{params:{q:"index",storage:s}}))}return(s,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{onClick:a[2]||(a[2]=f=>u(n.storage)),class:"vuefinder__treestorageitem__header"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(m).events(i),!0),{class:["vuefinder__treestorageitem__info",d.value?"vuefinder__treestorageitem__info--active":""]}),[e.createElementVNode("div",{class:e.normalizeClass(["vuefinder__treestorageitem__icon",d.value?"vuefinder__treestorageitem__icon--active":""])},[e.createVNode(e.unref(je))],2),e.createElementVNode("div",null,e.toDisplayString(n.storage),1)],16),e.createElementVNode("div",{class:"vuefinder__treestorageitem__loader",onClick:a[1]||(a[1]=e.withModifiers(f=>l.value=!l.value,["stop"]))},[e.createVNode(Ye,{storage:n.storage,path:n.storage+"://",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=f=>l.value=f)},null,8,["storage","path","modelValue"])])]),e.withDirectives(e.createVNode(Qs,{storage:n.storage,path:n.storage+"://",class:"vuefinder__treestorageitem__subfolder"},null,8,["storage","path"]),[[e.vShow,l.value]])],64))}}),Js={class:"vuefinder__folder-indicator"},Zs={class:"vuefinder__folder-indicator--icon"},ei=e.defineComponent({__name:"FolderIndicator",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const t=e.useModel(n,"modelValue");return(o,l)=>(e.openBlock(),e.createElementBlock("div",Js,[e.createElementVNode("div",Zs,[t.value?(e.openBlock(),e.createBlock(e.unref(Ke),{key:0,class:"vuefinder__folder-indicator--minus"})):e.createCommentVNode("",!0),t.value?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(Oe),{key:1,class:"vuefinder__folder-indicator--plus"}))])]))}}),ti={class:"vuefinder__treeview__header"},ni={class:"vuefinder__treeview__pinned-label"},oi={class:"vuefinder__treeview__pin-text text-nowrap"},ri={key:0,class:"vuefinder__treeview__pinned-list"},li=["onClick"],ai=["title"],si=["onClick"],ii={key:0},ci={class:"vuefinder__treeview__no-pinned"},di=e.defineComponent({__name:"TreeView",setup(n){const t=e.inject("ServiceContainer"),{t:o}=t.i18n,{getStore:l,setStore:r}=t.storage,m=t.fs,c=t.config,d=A.useStore(c.state),i=A.useStore(m.sortedFiles),u=A.useStore(m.path),s=ce(t,["bg-blue-200","dark:bg-slate-600"]),a=e.ref(190),f=e.ref(l("pinned-folders-opened",!0));e.watch(f,k=>r("pinned-folders-opened",k));const v=k=>{c.set("pinnedFolders",c.get("pinnedFolders").filter(h=>h.path!==k.path))},b=k=>{const h=k.clientX,w=k.target.parentElement;if(!w)return;const N=w.getBoundingClientRect().width;w.classList.remove("transition-[width]"),w.classList.add("transition-none");const M=j=>{a.value=N+j.clientX-h,a.value<50&&(a.value=0,c.set("showTreeView",!1)),a.value>50&&c.set("showTreeView",!0)},z=()=>{const j=w.getBoundingClientRect();a.value=j.width,w.classList.add("transition-[width]"),w.classList.remove("transition-none"),window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",z)};window.addEventListener("mousemove",M),window.addEventListener("mouseup",z)},g=e.ref(null);return e.onMounted(()=>{g.value&&ge.OverlayScrollbars(g.value,{overflow:{x:"hidden"},scrollbars:{theme:"vf-theme-dark dark:vf-theme-light"}})}),e.watch(i,k=>{const h=k.filter(w=>w.type==="dir");Ge(t.treeViewData,{path:u.value?.path||"",folders:h.map(w=>({storage:w.storage,path:w.path,basename:w.basename,type:"dir"}))})}),(k,h)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{onClick:h[0]||(h[0]=w=>e.unref(c).toggle("showTreeView")),class:e.normalizeClass(["vuefinder__treeview__overlay",e.unref(d).showTreeView?"vuefinder__treeview__backdrop":"hidden"])},null,2),e.createElementVNode("div",{style:e.normalizeStyle(e.unref(d).showTreeView?"min-width:100px;max-width:75%; width: "+a.value+"px":"width: 0"),class:"vuefinder__treeview__container"},[e.createElementVNode("div",{ref_key:"treeViewScrollElement",ref:g,class:"vuefinder__treeview__scroll"},[e.createElementVNode("div",ti,[e.createElementVNode("div",{onClick:h[2]||(h[2]=w=>f.value=!f.value),class:"vuefinder__treeview__pinned-toggle"},[e.createElementVNode("div",ni,[e.createVNode(e.unref(Pe),{class:"vuefinder__treeview__pin-icon"}),e.createElementVNode("div",oi,e.toDisplayString(e.unref(o)("Pinned Folders")),1)]),e.createVNode(ei,{modelValue:f.value,"onUpdate:modelValue":h[1]||(h[1]=w=>f.value=w)},null,8,["modelValue"])]),f.value?(e.openBlock(),e.createElementBlock("ul",ri,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d).pinnedFolders,w=>(e.openBlock(),e.createElementBlock("li",{key:w.path,class:"vuefinder__treeview__pinned-item"},[e.createElementVNode("div",e.mergeProps(e.toHandlers(e.unref(s).events(w),!0),{class:"vuefinder__treeview__pinned-folder",onClick:N=>e.unref(t).emitter.emit("vf-fetch",{params:{q:"index",storage:w.storage,path:w.path}})}),[e.unref(u)?.path!==w.path?(e.openBlock(),e.createBlock(e.unref(ue),{key:0,class:"vuefinder__treeview__folder-icon"})):e.createCommentVNode("",!0),e.unref(u)?.path===w.path?(e.openBlock(),e.createBlock(e.unref(Ue),{key:1,class:"vuefinder__treeview__open-folder-icon"})):e.createCommentVNode("",!0),e.createElementVNode("div",{title:w.path,class:e.normalizeClass(["vuefinder__treeview__folder-name",{"vuefinder__treeview__folder-name--active":e.unref(u)?.path===w.path}])},e.toDisplayString(w.basename),11,ai)],16,li),e.createElementVNode("div",{class:"vuefinder__treeview__remove-folder",onClick:N=>v(w)},[e.createVNode(e.unref(zs),{class:"vuefinder__treeview__remove-icon"})],8,si)]))),128)),e.unref(d).pinnedFolders.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("li",ii,[e.createElementVNode("div",ci,e.toDisplayString(e.unref(o)("No folders pinned")),1)]))])):e.createCommentVNode("",!0)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m).storages.get(),w=>(e.openBlock(),e.createElementBlock("div",{class:"vuefinder__treeview__storage",key:w},[e.createVNode(Xs,{storage:w},null,8,["storage"])]))),128))],512),e.createElementVNode("div",{onMousedown:b,class:"vuefinder__treeview__resize-handle"},null,32)],4)],64))}}),X={newfolder:"newfolder",selectAll:"selectAll",pinFolder:"pinFolder",unpinFolder:"unpinFolder",delete:"delete",refresh:"refresh",preview:"preview",open:"open",openDir:"openDir",download:"download",download_archive:"download_archive",archive:"archive",unarchive:"unarchive",rename:"rename",move:"move"};function ui(n){return n.items.length>1&&n.items.some(t=>t.path===n.target?.path)?"many":n.target?"one":"none"}function Y(n){const t=Object.assign({needsSearchQuery:!1},n);return(o,l)=>!(t.needsSearchQuery!==!!l.searchQuery||t.target!==void 0&&t.target!==ui(l)||t.targetType!==void 0&&t.targetType!==l.target?.type||t.mimeType!==void 0&&t.mimeType!==l.target?.mime_type||t.feature!==void 0&&!o.features.includes(t.feature))}function pe(...n){return(t,o)=>n.some(l=>l(t,o))}function ie(...n){return(t,o)=>n.every(l=>l(t,o))}const We=[{id:X.openDir,title:({t:n})=>n("Open containing folder"),action:(n,t)=>{n.emitter.emit("vf-search-exit"),n.emitter.emit("vf-fetch",{params:{q:"index",storage:t[0]?.storage,path:t[0]?.path}})},show:Y({target:"one",needsSearchQuery:!0})},{id:X.refresh,title:({t:n})=>n("Refresh"),action:n=>{const t=n.fs;n.emitter.emit("vf-fetch",{params:{q:"index",storage:t.path.get().storage,path:t.path.get().path}})},show:pe(Y({target:"none"}),Y({target:"many"}))},{id:X.selectAll,title:({t:n})=>n("Select All"),action:n=>{n.fs.selectAll()},show:Y({target:"none"})},{id:X.newfolder,title:({t:n})=>n("New Folder"),action:n=>n.modal.open(Fe),show:Y({target:"none",feature:H.NEW_FOLDER})},{id:X.open,title:({t:n})=>n("Open"),action:(n,t)=>{n.emitter.emit("vf-search-exit"),t[0]&&n.emitter.emit("vf-fetch",{params:{q:"index",storage:t[0].storage,path:t[0].path}})},show:Y({target:"one",targetType:"dir"})},{id:X.pinFolder,title:({t:n})=>n("Pin Folder"),action:(n,t)=>{const o=n.config,l=o.get("pinnedFolders"),r=l.concat(t.filter(m=>l.findIndex(c=>c.path===m.path)===-1));o.set("pinnedFolders",r)},show:ie(Y({target:"one",targetType:"dir"}),(n,t)=>n.config.get("pinnedFolders").findIndex(r=>r.path===t.target?.path)===-1)},{id:X.unpinFolder,title:({t:n})=>n("Unpin Folder"),action:(n,t)=>{const o=n.config,l=o.get("pinnedFolders");o.set("pinnedFolders",l.filter(r=>!t.find(m=>m.path===r.path)))},show:ie(Y({target:"one",targetType:"dir"}),(n,t)=>n.config.get("pinnedFolders").findIndex(r=>r.path===t.target?.path)!==-1)},{id:X.preview,title:({t:n})=>n("Preview"),action:(n,t)=>n.modal.open(De,{storage:t[0]?.storage,item:t[0]}),show:ie(Y({target:"one",feature:H.PREVIEW}),(n,t)=>t.target?.type!=="dir")},{id:X.download,link:(n,t)=>n.requester.getDownloadUrl(t[0]?.storage,t[0]),title:({t:n})=>n("Download"),action:()=>{},show:ie(Y({target:"one",feature:H.DOWNLOAD}),(n,t)=>t.target?.type!=="dir")},{id:X.rename,title:({t:n})=>n("Rename"),action:(n,t)=>n.modal.open(we,{items:t}),show:Y({target:"one",feature:H.RENAME})},{id:X.archive,title:({t:n})=>n("Archive"),action:(n,t)=>n.modal.open(He,{items:t}),show:pe(Y({target:"many",feature:H.ARCHIVE}),ie(Y({target:"one",feature:H.ARCHIVE}),(n,t)=>t.target?.mime_type!=="application/zip"))},{id:X.unarchive,title:({t:n})=>n("Unarchive"),action:(n,t)=>n.modal.open(ze,{items:t}),show:Y({target:"one",feature:H.UNARCHIVE,mimeType:"application/zip"})},{id:X.delete,title:({t:n})=>n("Delete"),action:(n,t)=>{n.modal.open(ke,{items:t})},show:pe(Y({feature:H.DELETE,target:"one"}),Y({feature:H.DELETE,target:"many"}))}],mi={class:"vuefinder",ref:"root",tabindex:"0"},fi={class:"vuefinder__main__content"},Qe=e.defineComponent({__name:"VueFinder",props:{id:{default:"vf"},request:{},persist:{type:Boolean,default:!1},path:{default:""},features:{type:[Boolean,Array],default:!0},debug:{type:Boolean,default:!1},theme:{default:"system"},locale:{default:void 0},maxHeight:{default:"600px"},maxFileSize:{default:"10mb"},fullScreen:{type:Boolean,default:!1},showTreeView:{type:Boolean,default:!1},pinnedFolders:{default:()=>[]},showThumbnails:{type:Boolean,default:!0},selectButton:{default:()=>({active:!1,multiple:!1,click:()=>{}})},loadingIndicator:{default:"linear"},contextMenuItems:{default:()=>We},onError:{},onSelect:{},"onUpdate:path":{},icon:{}},emits:["select","update:path"],setup(n,{emit:t}){const o=t,l=n,r=kt(l,e.inject("VueFinderOptions"));e.provide("ServiceContainer",r);const m=r.config,c=r.fs,d=A.useStore(m.state),i=A.useStore(c.selectedItems);cr(r);let u=null;r.emitter.on("vf-fetch-abort",()=>{u&&u.abort(),c.setLoading(!1)}),r.emitter.on("vf-fetch",({params:a,body:f=null,onSuccess:v=null,onError:b=null,noCloseModal:g=!1})=>{["index","search"].includes(a.q)&&(u&&u.abort(),c.setLoading(!0)),a.adapter=a.storage,u=new AbortController;const k=u.signal;r.requester.send({url:"",method:a.m||"get",params:a,body:f,abortSignal:k}).then(h=>{c.setPath(h.dirname),m.get("persist")&&m.set("path",h.dirname),g||r.modal.close(),c.setFiles(h.files),c.clearSelection(),c.setSelectedCount(0),c.setStorages(h.storages),v&&v(h)}).catch(h=>{console.error(h),b?b(h):h&&typeof h=="object"&&"message"in h&&r.emitter.emit("vf-toast-push",{label:h.message,type:"error"})}).finally(()=>{["index","search"].includes(a.q)&&c.setLoading(!1)})});function s(a){let f={};a&&a.includes("://")&&(f={storage:a.split("://")[0],path:a}),r.emitter.emit("vf-fetch",{params:{q:"index",storage:c.path.get().storage,...f},onError:l.onError??(v=>{v&&typeof v=="object"&&"message"in v&&r.emitter.emit("vf-toast-push",{label:v.message,type:"error"})})})}return e.onMounted(()=>{e.watch(()=>l.path,f=>{s(f)});const a=m.get("persist")?m.get("path"):l.path;c.setPath(a),s(a),r.emitter.on("vf-select",f=>{r.selectedItems=f,o("select",f)}),e.watch(()=>c.path.get().path,f=>{o("update:path",f)}),e.watch(i,f=>{o("select",f)})}),(a,f)=>(e.openBlock(),e.createElementBlock("div",mi,[e.createElementVNode("div",{class:e.normalizeClass(e.unref(r).theme.actualValue)},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(d).fullScreen?"vuefinder__main__fixed":"vuefinder__main__relative","vuefinder__main__container"]),style:e.normalizeStyle(e.unref(d).fullScreen?"":"max-height: "+n.maxHeight),onMousedown:f[0]||(f[0]=v=>e.unref(r).emitter.emit("vf-contextmenu-hide")),onTouchstart:f[1]||(f[1]=v=>e.unref(r).emitter.emit("vf-contextmenu-hide"))},[e.createVNode(Al),e.createVNode(Va),e.createElementVNode("div",fi,[e.createVNode(di),e.createVNode(fs)]),e.createVNode(As)],38),e.createVNode(e.Transition,{name:"fade"},{default:e.withCtx(()=>[e.unref(r).modal.visible?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(r).modal.type),{key:0})):e.createCommentVNode("",!0)]),_:1}),e.createVNode(ps)],2)],512))}}),Xe={install(n,t={}){t.i18n=t.i18n??{};let[o]=Object.keys(t.i18n);t.locale=t.locale??o??"en",n.provide("VueFinderOptions",t),n.component("VueFinder",Qe)}};exports.ContextMenuIds=X;exports.VueFinder=Qe;exports.VueFinderPlugin=Xe;exports.contextMenuItems=We;exports.default=Xe;
